<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>gen_seq</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library gen_seq</h1>

<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">List</span>.<br/>
<span class="id" title="keyword">Export</span> <span class="id" title="var">ListNotations</span>.<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">ssreflect</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">gen</span> <span class="id" title="var">genT</span> <span class="id" title="var">ddT</span> <span class="id" title="var">gen_tacs</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">gstep</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">List_lemmasT</span> <span class="id" title="var">swappedT</span> <span class="id" title="var">existsT</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Coq.Program.Basics</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">rlsmap</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> (<span class="id" title="var">f</span> : <span class="id" title="var">U</span> -&gt; <span class="id" title="var">W</span>) (<span class="id" title="var">rls</span> : <span class="id" title="var">rlsT</span> <span class="id" title="var">U</span>) : <span class="id" title="var">rlsT</span> <span class="id" title="var">W</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">rmI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">rls</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">rlsmap</span> <span class="id" title="var">f</span> <span class="id" title="var">rls</span> (<span class="id" title="var">map</span> <span class="id" title="var">f</span> <span class="id" title="var">ps</span>) (<span class="id" title="var">f</span> <span class="id" title="var">c</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">rmI_eq</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> (<span class="id" title="var">f</span> : <span class="id" title="var">U</span> -&gt; <span class="id" title="var">W</span>) (<span class="id" title="var">rls</span> : <span class="id" title="var">rlsT</span> <span class="id" title="var">U</span>) <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">mps</span> <span class="id" title="var">mc</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">rls</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">mps</span> = <span class="id" title="var">map</span> <span class="id" title="var">f</span> <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">mc</span> = <span class="id" title="var">f</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">rlsmap</span> <span class="id" title="var">f</span> <span class="id" title="var">rls</span> <span class="id" title="var">mps</span> <span class="id" title="var">mc</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rmI</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">relmap</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> (<span class="id" title="var">f</span> : <span class="id" title="var">U</span> -&gt; <span class="id" title="var">W</span>) (<span class="id" title="var">rel</span> : <span class="id" title="var">relationT</span> <span class="id" title="var">U</span>) : <span class="id" title="var">relationT</span> <span class="id" title="var">W</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">rlI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">p</span> <span class="id" title="var">c</span>, <span class="id" title="var">rel</span> <span class="id" title="var">p</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">relmap</span> <span class="id" title="var">f</span> <span class="id" title="var">rel</span> (<span class="id" title="var">f</span> <span class="id" title="var">p</span>) (<span class="id" title="var">f</span> <span class="id" title="var">c</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">rlI_eq</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> (<span class="id" title="var">f</span> : <span class="id" title="var">U</span> -&gt; <span class="id" title="var">W</span>) (<span class="id" title="var">rel</span> : <span class="id" title="var">relationT</span> <span class="id" title="var">U</span>) <span class="id" title="var">p</span> <span class="id" title="var">c</span> <span class="id" title="var">mp</span> <span class="id" title="var">mc</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">rel</span> <span class="id" title="var">p</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">mp</span> = <span class="id" title="var">f</span> <span class="id" title="var">p</span> -&gt; <span class="id" title="var">mc</span> = <span class="id" title="var">f</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">relmap</span> <span class="id" title="var">f</span> <span class="id" title="var">rel</span> <span class="id" title="var">mp</span> <span class="id" title="var">mc</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rlI</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
seqext, seqrule, extending sequent and rule with left- and right-contexts
  in antecedent and consequent 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">seqext</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span> <span class="id" title="var">Delt1</span> <span class="id" title="var">Delt2</span> (<span class="id" title="var">seq</span> : <span class="id" title="var">rel</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span>)) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">seq</span> <span class="id" title="keyword">with</span> | <span class="id" title="var">pair</span> <span class="id" title="var">U</span> <span class="id" title="var">V</span> =&gt; <span class="id" title="var">pair</span> (<span class="id" title="var">Gam1</span> ++ <span class="id" title="var">U</span> ++ <span class="id" title="var">Gam2</span>) (<span class="id" title="var">Delt1</span> ++ <span class="id" title="var">V</span> ++ <span class="id" title="var">Delt2</span>) <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">seqext_seqext</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">V</span> (<span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span> <span class="id" title="var">Delt1</span> <span class="id" title="var">Delt2</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span> : <span class="id" title="var">list</span> <span class="id" title="var">V</span>) <span class="id" title="var">seq</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">seqext</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span> <span class="id" title="var">Delt1</span> <span class="id" title="var">Delt2</span> (<span class="id" title="var">seqext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span> <span class="id" title="var">seq</span>) =<br/>
&nbsp;&nbsp;<span class="id" title="var">seqext</span> (<span class="id" title="var">Gam1</span> ++ <span class="id" title="var">Phi1</span>) (<span class="id" title="var">Phi2</span> ++ <span class="id" title="var">Gam2</span>) (<span class="id" title="var">Delt1</span> ++ <span class="id" title="var">Psi1</span>) (<span class="id" title="var">Psi2</span> ++ <span class="id" title="var">Delt2</span>) <span class="id" title="var">seq</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">seqext</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">seq</span>.<br/>
<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">app_assoc</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map_seqext_seqext</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">V</span> (<span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span> <span class="id" title="var">Delt1</span> <span class="id" title="var">Delt2</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span> : <span class="id" title="var">list</span> <span class="id" title="var">V</span>) <span class="id" title="var">seqs</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">map</span> (<span class="id" title="var">seqext</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span> <span class="id" title="var">Delt1</span> <span class="id" title="var">Delt2</span>) (<span class="id" title="var">map</span> (<span class="id" title="var">seqext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>) <span class="id" title="var">seqs</span>) =<br/>
&nbsp;&nbsp;<span class="id" title="var">map</span> (<span class="id" title="var">seqext</span> (<span class="id" title="var">Gam1</span> ++ <span class="id" title="var">Phi1</span>) (<span class="id" title="var">Phi2</span> ++ <span class="id" title="var">Gam2</span>) (<span class="id" title="var">Delt1</span> ++ <span class="id" title="var">Psi1</span>) (<span class="id" title="var">Psi2</span> ++ <span class="id" title="var">Delt2</span>)) <span class="id" title="var">seqs</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">seqs</span>. <span class="id" title="tactic">tauto</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHseqs</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">seqext_seqext</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">seqrule</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">pr</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">rel</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span>))) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rlsT</span> (<span class="id" title="var">rel</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span>)) := <br/>
&nbsp;&nbsp;| <span class="id" title="var">Sctxt</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>, <span class="id" title="var">pr</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">seqrule</span> <span class="id" title="var">pr</span> (<span class="id" title="var">map</span> (<span class="id" title="var">seqext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>) <span class="id" title="var">ps</span>) (<span class="id" title="var">seqext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span> <span class="id" title="var">c</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">seqext_def</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span> <span class="id" title="var">U</span> <span class="id" title="var">V</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id" title="var">seqext</span> <span class="id" title="var">W</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span> (<span class="id" title="var">U</span>,<span class="id" title="var">V</span>) = (<span class="id" title="var">Phi1</span> ++ <span class="id" title="var">U</span> ++ <span class="id" title="var">Phi2</span>, <span class="id" title="var">Psi1</span> ++ <span class="id" title="var">V</span> ++ <span class="id" title="var">Psi2</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Sctxt_e</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">pr</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">rel</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span>))) <span class="id" title="var">ps</span> <span class="id" title="var">U</span> <span class="id" title="var">V</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">pr</span> <span class="id" title="var">ps</span> (<span class="id" title="var">U</span>, <span class="id" title="var">V</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">seqrule</span> <span class="id" title="var">pr</span> (<span class="id" title="var">map</span> (<span class="id" title="var">seqext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>) <span class="id" title="var">ps</span>) (<span class="id" title="var">Phi1</span> ++ <span class="id" title="var">U</span> ++ <span class="id" title="var">Phi2</span>, <span class="id" title="var">Psi1</span> ++ <span class="id" title="var">V</span> ++ <span class="id" title="var">Psi2</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">seqext_def</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Sctxt</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Sctxt_eq</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">pr</span> <span class="id" title="var">ps</span> <span class="id" title="var">mps</span> (<span class="id" title="var">ca</span> <span class="id" title="var">cs</span> <span class="id" title="var">U</span> <span class="id" title="var">V</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span> : <span class="id" title="var">list</span> <span class="id" title="var">W</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">pr</span> <span class="id" title="var">ps</span> (<span class="id" title="var">U</span>, <span class="id" title="var">V</span>) -&gt; <span class="id" title="var">ca</span> = <span class="id" title="var">Phi1</span> ++ <span class="id" title="var">U</span> ++ <span class="id" title="var">Phi2</span> -&gt; <span class="id" title="var">cs</span> = <span class="id" title="var">Psi1</span> ++ <span class="id" title="var">V</span> ++ <span class="id" title="var">Psi2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">mps</span> = <span class="id" title="var">map</span> (<span class="id" title="var">seqext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>) <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">seqrule</span> <span class="id" title="var">pr</span> <span class="id" title="var">mps</span> (<span class="id" title="var">ca</span>, <span class="id" title="var">cs</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Sctxt_e</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">seqrule_id</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">pr</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">rel</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span>))) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">pr</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">seqrule</span> <span class="id" title="var">pr</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">ca</span> <span class="id" title="var">cs</span>].<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">Sctxt_eq</span> <span class="id" title="var">pr</span> <span class="id" title="var">ps</span> <span class="id" title="var">ca</span> <span class="id" title="var">cs</span> [] [] [] []). <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_nil_r</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_nil_r</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">clear</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">ps</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">IHps</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">seqext</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">app_nil_r</span>.<br/>
<span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">seqrule_seqrule</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">pr</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">rel</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span>))) :<br/>
&nbsp;&nbsp;<span class="id" title="var">rsub</span> (<span class="id" title="var">seqrule</span> (<span class="id" title="var">seqrule</span> <span class="id" title="var">pr</span>)) (<span class="id" title="var">seqrule</span> <span class="id" title="var">pr</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">rsub</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">X0</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">seqext_seqext</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">c0</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">ca</span> <span class="id" title="var">cs</span>].<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">Sctxt_eq</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">clear</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">ps0</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHps0</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">seqext_seqext</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">seqrule_seqrule'</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">pr</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">rsubD</span> (@<span class="id" title="var">seqrule_seqrule</span> <span class="id" title="var">W</span> <span class="id" title="var">pr</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derl_seqrule''</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">rules</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">rel</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span>))) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>, (<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">derl</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">derl</span> (<span class="id" title="var">seqrule</span> <span class="id" title="var">rules</span>) (<span class="id" title="var">map</span> (<span class="id" title="var">seqext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>) <span class="id" title="var">ps</span>) (<span class="id" title="var">seqext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span> <span class="id" title="var">c</span>)) * <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">cs</span>, <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">cs</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dersl</span> (<span class="id" title="var">seqrule</span> <span class="id" title="var">rules</span>) (<span class="id" title="var">map</span> (<span class="id" title="var">seqext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>) <span class="id" title="var">ps</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">map</span> (<span class="id" title="var">seqext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>)<span class="id" title="var">cs</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>.<br/>
<span class="id" title="tactic">eapply</span> (<span class="id" title="var">derl_dersl_rect_mut</span> (<span class="id" title="var">rules</span> := <span class="id" title="var">rules</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">derl</span> (<span class="id" title="var">seqrule</span> <span class="id" title="var">rules</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">map</span> (<span class="id" title="var">seqext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>) <span class="id" title="var">ps</span>) (<span class="id" title="var">seqext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span> <span class="id" title="var">c</span>))<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">ps</span> <span class="id" title="var">cs</span> : <span class="id" title="var">list</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">dersl</span> (<span class="id" title="var">seqrule</span> <span class="id" title="var">rules</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">map</span> (<span class="id" title="var">seqext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>) <span class="id" title="var">ps</span>) (<span class="id" title="var">map</span> (<span class="id" title="var">seqext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>) <span class="id" title="var">cs</span>))).<br/>
- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">asmI</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">dtderI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Sctxt</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">assumption</span>.<br/>
- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dtNil</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">map_app</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dtCons</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derl_seqrule'</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">fst</span> (@<span class="id" title="var">derl_seqrule''</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersl_seqrule'</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">snd</span> (@<span class="id" title="var">derl_seqrule''</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derl_seqrule</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">rules</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">rel</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span>))) :<br/>
&nbsp;&nbsp;<span class="id" title="var">rsub</span> (<span class="id" title="var">seqrule</span> (<span class="id" title="var">derl</span> <span class="id" title="var">rules</span>)) (<span class="id" title="var">derl</span> (<span class="id" title="var">seqrule</span> <span class="id" title="var">rules</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">rsub</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">derl_seqrule'</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">seqrule_derl_seqrule</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">rules</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">rel</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span>))) :<br/>
&nbsp;&nbsp;<span class="id" title="var">rsub</span> (<span class="id" title="var">seqrule</span> (<span class="id" title="var">derl</span> (<span class="id" title="var">seqrule</span> <span class="id" title="var">rules</span>))) (<span class="id" title="var">derl</span> (<span class="id" title="var">seqrule</span> <span class="id" title="var">rules</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">rsub_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">derl_seqrule</span>.<br/>
&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">rsub</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">derl_mono</span>. 2: <span class="id" title="var">eassumption</span>.<br/>
&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">seqrule_seqrule</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">seqrule_derl_seqrule'</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">rsubD</span> (@<span class="id" title="var">seqrule_derl_seqrule</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">seqrule_s</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">ps</span> : <span class="id" title="var">list</span> (<span class="id" title="var">rel</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span>))) (<span class="id" title="var">c</span> : <span class="id" title="var">rel</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span>)) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rlsT</span> (<span class="id" title="var">rel</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span>)) := <br/>
&nbsp;&nbsp;| <span class="id" title="var">Sctxt_s</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">seqrule_s</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> (<span class="id" title="var">map</span> (<span class="id" title="var">seqext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>) <span class="id" title="var">ps</span>) (<span class="id" title="var">seqext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span> <span class="id" title="var">c</span>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">seqrule'</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">pr</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">rel</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span>))) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rlsT</span> (<span class="id" title="var">rel</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span>)) := <br/>
&nbsp;&nbsp;| <span class="id" title="var">Sctxt'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">pse</span> <span class="id" title="var">ce</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">seqrule_s</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">pse</span> <span class="id" title="var">ce</span> -&gt; <span class="id" title="var">seqrule'</span> <span class="id" title="var">pr</span> <span class="id" title="var">pse</span> <span class="id" title="var">ce</span>.<br/>

<br/>
<span class="id" title="keyword">Check</span> (<span class="id" title="var">Sctxt'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">Sctxt_s</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Sctxt_alt</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">pr</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">rel</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span>))) <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pr</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">seqrule'</span> <span class="id" title="var">pr</span> (<span class="id" title="var">map</span> (<span class="id" title="var">seqext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>) <span class="id" title="var">ps</span>) (<span class="id" title="var">seqext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span> <span class="id" title="var">c</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">Sctxt'</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Sctxt_s</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Sctxt_e'</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">pr</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">rel</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span>))) <span class="id" title="var">ps</span> <span class="id" title="var">U</span> <span class="id" title="var">V</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">pr</span> <span class="id" title="var">ps</span> (<span class="id" title="var">U</span>, <span class="id" title="var">V</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">seqrule</span> <span class="id" title="var">pr</span> (<span class="id" title="var">map</span> (<span class="id" title="var">seqext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>) <span class="id" title="var">ps</span>) ((<span class="id" title="var">Phi1</span> ++ <span class="id" title="var">U</span>) ++ <span class="id" title="var">Phi2</span>, <span class="id" title="var">Psi1</span> ++ <span class="id" title="var">V</span> ++ <span class="id" title="var">Psi2</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">app_assoc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Sctxt_e</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">seqext_defp</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span> <span class="id" title="var">seq</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id" title="var">seqext</span> <span class="id" title="var">W</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span> <span class="id" title="var">seq</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">U</span>, <span class="id" title="var">V</span>) := <span class="id" title="var">seq</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">Phi1</span> ++ <span class="id" title="var">U</span> ++ <span class="id" title="var">Phi2</span>, <span class="id" title="var">Psi1</span> ++ <span class="id" title="var">V</span> ++ <span class="id" title="var">Psi2</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">seqrule_same</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">pr</span> <span class="id" title="var">ps</span> (<span class="id" title="var">c</span> <span class="id" title="var">c'</span> : <span class="id" title="var">rel</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span>)),<br/>
&nbsp;&nbsp;<span class="id" title="var">seqrule</span> <span class="id" title="var">pr</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">c</span> = <span class="id" title="var">c'</span> -&gt; <span class="id" title="var">seqrule</span> <span class="id" title="var">pr</span> <span class="id" title="var">ps</span> <span class="id" title="var">c'</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">seqrule_mono</span> <span class="id" title="var">X</span> (<span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">rel</span> (<span class="id" title="var">list</span> <span class="id" title="var">X</span>))) :<br/>
&nbsp;&nbsp;<span class="id" title="var">rsub</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> -&gt; <span class="id" title="var">rsub</span> (<span class="id" title="var">seqrule</span> <span class="id" title="var">rulesa</span>) (<span class="id" title="var">seqrule</span> <span class="id" title="var">rulesb</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">rsub</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Sctxt</span>. <span class="id" title="tactic">firstorder</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">seqrule_mono'</span> <span class="id" title="var">X</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">rs</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">rsubD</span> (@<span class="id" title="var">seqrule_mono</span> <span class="id" title="var">X</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">rs</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Sctxt_nil</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">pr</span> <span class="id" title="var">c</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span> <span class="id" title="var">Delt1</span> <span class="id" title="var">Delt2</span>, (<span class="id" title="var">pr</span> [] <span class="id" title="var">c</span> : <span class="id" title="keyword">Type</span>) -&gt;<br/>
&nbsp;&nbsp;@<span class="id" title="var">seqrule</span> <span class="id" title="var">W</span> <span class="id" title="var">pr</span> [] (<span class="id" title="var">seqext</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span> <span class="id" title="var">Delt1</span> <span class="id" title="var">Delt2</span> <span class="id" title="var">c</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">Sctxt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_seqextL</span> : <span class="id" title="keyword">forall</span> {<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>} <span class="id" title="var">Gam</span> <span class="id" title="var">Delt</span> <span class="id" title="var">A</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">InT</span> <span class="id" title="var">A</span> <span class="id" title="var">Gam</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">existsT2</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span>, @<span class="id" title="var">seqext</span> <span class="id" title="var">W</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Delt</span> [] ([<span class="id" title="var">A</span>], []) = (<span class="id" title="var">Gam</span>, <span class="id" title="var">Delt</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Gam</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">Delt</span> <span class="id" title="var">A</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hin</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">seqext</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_nil_r</span>. <span class="id" title="var">erewrite</span> <span class="id" title="var">app_nil_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHGam</span>  <span class="id" title="var">Delt</span> <span class="id" title="var">_</span> <span class="id" title="var">X</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">H1</span> [<span class="id" title="var">H2</span> <span class="id" title="var">H3</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">seqext</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_nil_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_comm_cons</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_seqextR</span> : <span class="id" title="keyword">forall</span> {<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>} <span class="id" title="var">Gam</span> <span class="id" title="var">Delt</span> <span class="id" title="var">B</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">InT</span> <span class="id" title="var">B</span> <span class="id" title="var">Delt</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">existsT2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>, @<span class="id" title="var">seqext</span> <span class="id" title="var">W</span> <span class="id" title="var">Gam</span> [] <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span> ([], [<span class="id" title="var">B</span>]) = (<span class="id" title="var">Gam</span>, <span class="id" title="var">Delt</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Delt</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hin</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">seqext</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_nil_r</span>. <span class="id" title="var">erewrite</span> <span class="id" title="var">app_nil_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHDelt</span> <span class="id" title="var">_</span> <span class="id" title="var">X</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">H1</span> [<span class="id" title="var">H2</span> <span class="id" title="var">H3</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">seqext</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_nil_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_comm_cons</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_seqext</span> : <span class="id" title="keyword">forall</span> {<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>} <span class="id" title="var">Gam</span> <span class="id" title="var">Delt</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">InT</span> <span class="id" title="var">A</span> <span class="id" title="var">Gam</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">InT</span> <span class="id" title="var">B</span> <span class="id" title="var">Delt</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">existsT2</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span>, @<span class="id" title="var">seqext</span> <span class="id" title="var">W</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">Psi1</span> <span class="id" title="var">Psi2</span> ([<span class="id" title="var">A</span>], [<span class="id" title="var">B</span>]) = (<span class="id" title="var">Gam</span>, <span class="id" title="var">Delt</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intros</span> <span class="id" title="var">Hin1</span> <span class="id" title="var">Hin2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (@<span class="id" title="var">InT_seqextL</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Delt</span> <span class="id" title="var">_</span> <span class="id" title="var">Hin1</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">H1</span> [<span class="id" title="var">H2</span> <span class="id" title="var">H3</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (@<span class="id" title="var">InT_seqextR</span> <span class="id" title="var">_</span> <span class="id" title="var">Gam</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hin2</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">J1</span> [<span class="id" title="var">J2</span> <span class="id" title="var">J3</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">seqext</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_nil_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_nil_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">J3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">J3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">eexists</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fmlsext</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span> (<span class="id" title="var">fmls</span> : (<span class="id" title="var">list</span> <span class="id" title="var">W</span>)) := (<span class="id" title="var">Gam1</span> ++ <span class="id" title="var">fmls</span> ++ <span class="id" title="var">Gam2</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fmlsext_fmlsext</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">V</span> (<span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> : <span class="id" title="var">list</span> <span class="id" title="var">V</span>) <span class="id" title="var">seq</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">fmlsext</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span> (<span class="id" title="var">fmlsext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">seq</span>) = <span class="id" title="var">fmlsext</span> (<span class="id" title="var">Gam1</span> ++ <span class="id" title="var">Phi1</span>) (<span class="id" title="var">Phi2</span> ++ <span class="id" title="var">Gam2</span>) <span class="id" title="var">seq</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">fmlsext</span>. <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">app_assoc</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map_fmlsext_fmlsext</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">V</span> (<span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> : <span class="id" title="var">list</span> <span class="id" title="var">V</span>) <span class="id" title="var">seqs</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">map</span> (<span class="id" title="var">fmlsext</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span>) (<span class="id" title="var">map</span> (<span class="id" title="var">fmlsext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span>) <span class="id" title="var">seqs</span>) =<br/>
&nbsp;&nbsp;<span class="id" title="var">map</span> (<span class="id" title="var">fmlsext</span> (<span class="id" title="var">Gam1</span> ++ <span class="id" title="var">Phi1</span>) (<span class="id" title="var">Phi2</span> ++ <span class="id" title="var">Gam2</span>)) <span class="id" title="var">seqs</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">seqs</span>. <span class="id" title="tactic">tauto</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHseqs</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">fmlsext_fmlsext</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fmlsext_def</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">U</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id" title="var">fmlsext</span> <span class="id" title="var">W</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> <span class="id" title="var">U</span> = (<span class="id" title="var">Phi1</span> ++ <span class="id" title="var">U</span> ++ <span class="id" title="var">Phi2</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">apfst</span> <span class="id" title="var">U</span> <span class="id" title="var">V</span> <span class="id" title="var">W</span> (<span class="id" title="var">f</span> : <span class="id" title="var">U</span> -&gt; <span class="id" title="var">V</span>) (<span class="id" title="var">p</span> : <span class="id" title="var">U</span> * <span class="id" title="var">W</span>) := <span class="id" title="keyword">let</span> (<span class="id" title="var">x</span>, <span class="id" title="var">y</span>) := <span class="id" title="var">p</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>, <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">apsnd</span> <span class="id" title="var">U</span> <span class="id" title="var">V</span> <span class="id" title="var">W</span> (<span class="id" title="var">f</span> : <span class="id" title="var">U</span> -&gt; <span class="id" title="var">V</span>) (<span class="id" title="var">p</span> : <span class="id" title="var">W</span> * <span class="id" title="var">U</span>) := <span class="id" title="keyword">let</span> (<span class="id" title="var">x</span>, <span class="id" title="var">y</span>) := <span class="id" title="var">p</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">x</span>, <span class="id" title="var">f</span> <span class="id" title="var">y</span>).<br/>

<br/>
</div>

<div class="doc">
fst_ext_rls - adding left- and right-context 
  to the antecedent of a sequent rule 
</div>
<div class="code">
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">fst_ext_rls</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> <span class="id" title="var">rls</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">list</span> <span class="id" title="var">U</span> * <span class="id" title="var">W</span>) :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">fextI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rlsmap</span> (<span class="id" title="var">apfst</span> (<span class="id" title="var">fmlsext</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span>)) <span class="id" title="var">rls</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">fst_ext_rls</span> <span class="id" title="var">rls</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">snd_ext_rls</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> <span class="id" title="var">rls</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">U</span> * <span class="id" title="var">list</span> <span class="id" title="var">W</span>) :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">sextI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rlsmap</span> (<span class="id" title="var">apsnd</span> (<span class="id" title="var">fmlsext</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span>)) <span class="id" title="var">rls</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">snd_ext_rls</span> <span class="id" title="var">rls</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fextI'</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> <span class="id" title="var">rls</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">rpc</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">fextI</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> <span class="id" title="var">rls</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">rmI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">rpc</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fextI_eq'</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> <span class="id" title="var">rls</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span> <span class="id" title="var">ps</span> (<span class="id" title="var">c</span> : <span class="id" title="var">list</span> <span class="id" title="var">U</span> * <span class="id" title="var">W</span>) <span class="id" title="var">mps</span> <span class="id" title="var">mc</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">rls</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">mps</span> = <span class="id" title="var">map</span> (<span class="id" title="var">apfst</span> (<span class="id" title="var">fmlsext</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span>)) <span class="id" title="var">ps</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">mc</span> = <span class="id" title="var">apfst</span> (<span class="id" title="var">fmlsext</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span>) <span class="id" title="var">c</span> -&gt; <span class="id" title="var">fst_ext_rls</span> <span class="id" title="var">rls</span> <span class="id" title="var">mps</span> <span class="id" title="var">mc</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">fextI'</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fextI_eqc'</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> <span class="id" title="var">rls</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span> <span class="id" title="var">ps</span> (<span class="id" title="var">c</span> : <span class="id" title="var">list</span> <span class="id" title="var">U</span> * <span class="id" title="var">W</span>) <span class="id" title="var">mc</span> <span class="id" title="var">rpc</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">fextI_eq'</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> <span class="id" title="var">rls</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span> <span class="id" title="var">ps</span> (<span class="id" title="var">c</span> : <span class="id" title="var">list</span> <span class="id" title="var">U</span> * <span class="id" title="var">W</span>) <span class="id" title="var">_</span> <span class="id" title="var">mc</span> <span class="id" title="var">rpc</span> <span class="id" title="var">eq_refl</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fst_snd_ext</span> <span class="id" title="var">W</span> (<span class="id" title="var">rls</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span> * <span class="id" title="var">list</span> <span class="id" title="var">W</span>)) :<br/>
&nbsp;&nbsp;<span class="id" title="var">req</span> (<span class="id" title="var">seqrule</span> <span class="id" title="var">rls</span>) (<span class="id" title="var">fst_ext_rls</span> (<span class="id" title="var">snd_ext_rls</span> <span class="id" title="var">rls</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
- <span class="id" title="tactic">intro</span> <span class="id" title="var">sr</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">sr</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">fextI</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">rmI_eq</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">sextI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rmI</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">r</span>.<br/>
2: <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span>. 2: <span class="id" title="tactic">simpl</span>. 2: <span class="id" title="tactic">unfold</span> <span class="id" title="var">fmlsext</span>. 2: <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">clear</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">ps</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> - <span class="id" title="var">IHps</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">fmlsext</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">intro</span> <span class="id" title="var">fs</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">fs</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">c0</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">fmlsext</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">Sctxt_eq</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">clear</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">ps0</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHps0</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">snd_fst_ext</span> <span class="id" title="var">W</span> (<span class="id" title="var">rls</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span> * <span class="id" title="var">list</span> <span class="id" title="var">W</span>)) :<br/>
&nbsp;&nbsp;<span class="id" title="var">req</span> (<span class="id" title="var">seqrule</span> <span class="id" title="var">rls</span>) (<span class="id" title="var">snd_ext_rls</span> (<span class="id" title="var">fst_ext_rls</span> <span class="id" title="var">rls</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
- <span class="id" title="tactic">intro</span> <span class="id" title="var">sr</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">sr</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">sextI</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">rmI_eq</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">fextI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rmI</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">r</span>.<br/>
2: <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span>. 2: <span class="id" title="tactic">simpl</span>. 2: <span class="id" title="tactic">unfold</span> <span class="id" title="var">fmlsext</span>. 2: <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">clear</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">ps</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> - <span class="id" title="var">IHps</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">fmlsext</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">intro</span> <span class="id" title="var">fs</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">fs</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">c0</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">fmlsext</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">Sctxt_eq</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">clear</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">ps0</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHps0</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">rm_mono</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> (<span class="id" title="var">f</span> : <span class="id" title="var">U</span> -&gt; <span class="id" title="var">W</span>) <span class="id" title="var">rlsa</span> <span class="id" title="var">rlsb</span> : <br/>
&nbsp;&nbsp;<span class="id" title="var">rsub</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">rlsb</span> -&gt; <span class="id" title="var">rsub</span> (<span class="id" title="var">rlsmap</span> <span class="id" title="var">f</span> <span class="id" title="var">rlsa</span>) (<span class="id" title="var">rlsmap</span> <span class="id" title="var">f</span> <span class="id" title="var">rlsb</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">rab</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">ra</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">pose</span> (<span class="id" title="var">rab</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">r</span>).<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">rmI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">r0</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fer_mono</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> (<span class="id" title="var">rlsa</span> <span class="id" title="var">rlsb</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">list</span> <span class="id" title="var">U</span> * <span class="id" title="var">W</span>)) :<br/>
&nbsp;&nbsp;<span class="id" title="var">rsub</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">rlsb</span> -&gt; <span class="id" title="var">rsub</span> (<span class="id" title="var">fst_ext_rls</span> <span class="id" title="var">rlsa</span>) (<span class="id" title="var">fst_ext_rls</span> <span class="id" title="var">rlsb</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">rab</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">fea</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">fea</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">pose</span> (<span class="id" title="var">rab</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">r</span>).<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">fextI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rmI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">r0</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ser_mono</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> (<span class="id" title="var">rlsa</span> <span class="id" title="var">rlsb</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">U</span> * <span class="id" title="var">list</span> <span class="id" title="var">W</span>)) :<br/>
&nbsp;&nbsp;<span class="id" title="var">rsub</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">rlsb</span> -&gt; <span class="id" title="var">rsub</span> (<span class="id" title="var">snd_ext_rls</span> <span class="id" title="var">rlsa</span>) (<span class="id" title="var">snd_ext_rls</span> <span class="id" title="var">rlsb</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">rab</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">sea</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">sea</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">pose</span> (<span class="id" title="var">rab</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">r</span>).<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">sextI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rmI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">r0</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fst_ext_rls_fst_ext_rls</span> (<span class="id" title="var">U</span> <span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">pr</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">list</span> <span class="id" title="var">U</span> * <span class="id" title="var">W</span>)) :<br/>
&nbsp;&nbsp;<span class="id" title="var">rsub</span> (<span class="id" title="var">fst_ext_rls</span> (<span class="id" title="var">fst_ext_rls</span> <span class="id" title="var">pr</span>)) (<span class="id" title="var">fst_ext_rls</span> <span class="id" title="var">pr</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">rsub</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">fmlsext_fmlsext</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">fextI'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">arg1_cong_imp</span>. 2: <span class="id" title="tactic">exact</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">p</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">ps</span> ; <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHps</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">fmlsext_fmlsext</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fst_ext_rls_fst_ext_rls'</span> (<span class="id" title="var">U</span> <span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">pr</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">rsubD</span> (@<span class="id" title="var">fst_ext_rls_fst_ext_rls</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> <span class="id" title="var">pr</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derl_fst_ext_rls''</span> (<span class="id" title="var">U</span> <span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">rules</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">list</span> <span class="id" title="var">U</span> * <span class="id" title="var">W</span>)) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span>, (<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">derl</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">derl</span> (<span class="id" title="var">fst_ext_rls</span> <span class="id" title="var">rules</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">map</span> (<span class="id" title="var">apfst</span> (<span class="id" title="var">fmlsext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span>)) <span class="id" title="var">ps</span>) (<span class="id" title="var">apfst</span> (<span class="id" title="var">fmlsext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span>) <span class="id" title="var">c</span>)) * <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">cs</span>, <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">cs</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dersl</span> (<span class="id" title="var">fst_ext_rls</span> <span class="id" title="var">rules</span>) (<span class="id" title="var">map</span> (<span class="id" title="var">apfst</span> (<span class="id" title="var">fmlsext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span>)) <span class="id" title="var">ps</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">map</span> (<span class="id" title="var">apfst</span> (<span class="id" title="var">fmlsext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span>)) <span class="id" title="var">cs</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span>.<br/>
<span class="id" title="tactic">eapply</span> (<span class="id" title="var">derl_dersl_rect_mut</span> (<span class="id" title="var">rules</span> := <span class="id" title="var">rules</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">derl</span> (<span class="id" title="var">fst_ext_rls</span> <span class="id" title="var">rules</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">map</span> (<span class="id" title="var">apfst</span> (<span class="id" title="var">fmlsext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span>)) <span class="id" title="var">ps</span>) (<span class="id" title="var">apfst</span> (<span class="id" title="var">fmlsext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span>) <span class="id" title="var">c</span>))<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">ps</span> <span class="id" title="var">cs</span> : <span class="id" title="var">list</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">dersl</span> (<span class="id" title="var">fst_ext_rls</span> <span class="id" title="var">rules</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">map</span> (<span class="id" title="var">apfst</span> (<span class="id" title="var">fmlsext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span>)) <span class="id" title="var">ps</span>) (<span class="id" title="var">map</span> (<span class="id" title="var">apfst</span> (<span class="id" title="var">fmlsext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span>)) <span class="id" title="var">cs</span>))).<br/>
- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">asmI</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">dtderI</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">fextI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rmI</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">assumption</span>.<br/>
- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dtNil</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">map_app</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dtCons</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derl_fst_ext_rls'</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">fst</span> (@<span class="id" title="var">derl_fst_ext_rls''</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersl_fst_ext_rls'</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">snd</span> (@<span class="id" title="var">derl_fst_ext_rls''</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derl_fst_ext_rls</span> (<span class="id" title="var">U</span> <span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">rules</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">list</span> <span class="id" title="var">U</span> * <span class="id" title="var">W</span>)) :<br/>
&nbsp;&nbsp;<span class="id" title="var">rsub</span> (<span class="id" title="var">fst_ext_rls</span> (<span class="id" title="var">derl</span> <span class="id" title="var">rules</span>)) (<span class="id" title="var">derl</span> (<span class="id" title="var">fst_ext_rls</span> <span class="id" title="var">rules</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">rsub</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">derl_fst_ext_rls'</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fst_ext_rls_derl_fst_ext_rls</span> (<span class="id" title="var">U</span> <span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">rules</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">list</span> <span class="id" title="var">U</span> * <span class="id" title="var">W</span>)) :<br/>
&nbsp;&nbsp;<span class="id" title="var">rsub</span> (<span class="id" title="var">fst_ext_rls</span> (<span class="id" title="var">derl</span> (<span class="id" title="var">fst_ext_rls</span> <span class="id" title="var">rules</span>))) (<span class="id" title="var">derl</span> (<span class="id" title="var">fst_ext_rls</span> <span class="id" title="var">rules</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">rsub_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">derl_fst_ext_rls</span>.<br/>
&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">rsub</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">derl_mono</span>. 2: <span class="id" title="var">eassumption</span>.<br/>
&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">fst_ext_rls_fst_ext_rls</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fst_ext_rls_derl_fst_ext_rls'</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">rsubD</span> (@<span class="id" title="var">fst_ext_rls_derl_fst_ext_rls</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">wkL_valid</span> <span class="id" title="var">V</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> (<span class="id" title="var">cl</span> : <span class="id" title="var">list</span> <span class="id" title="var">V</span>) <span class="id" title="var">cr</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">_</span>) (<span class="id" title="var">fmlsext</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span> <span class="id" title="var">cl</span>, <span class="id" title="var">cr</span> : <span class="id" title="var">W</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">wkL_valid'</span> <span class="id" title="var">V</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">seq</span> := @<span class="id" title="var">wkL_valid</span> <span class="id" title="var">V</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> (<span class="id" title="var">fst</span> <span class="id" title="var">seq</span>) (<span class="id" title="var">snd</span> <span class="id" title="var">seq</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">can_wkL</span> <span class="id" title="var">V</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">seq</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">emptyT</span> <span class="id" title="var">seq</span> -&gt; @<span class="id" title="var">wkL_valid'</span> <span class="id" title="var">V</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">seq</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">can_wkL_req</span> <span class="id" title="var">V</span> <span class="id" title="var">W</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">rlsb</span> <span class="id" title="var">seq</span> : <span class="id" title="var">req</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">rlsb</span> -&gt;<br/>
&nbsp;&nbsp;@<span class="id" title="var">can_wkL</span> <span class="id" title="var">V</span> <span class="id" title="var">W</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">seq</span> -&gt; <span class="id" title="var">can_wkL</span> <span class="id" title="var">rlsb</span> <span class="id" title="var">seq</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">can_wkL</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">wkL_valid'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">wkL_valid</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">rab</span> <span class="id" title="var">da</span> <span class="id" title="var">derb</span> *.<br/>
<span class="id" title="tactic">specialize</span> (<span class="id" title="var">da</span> (<span class="id" title="var">derrec_rmono</span> (<span class="id" title="var">snd</span> <span class="id" title="var">rab</span>) <span class="id" title="var">derb</span>)).<br/>
<span class="id" title="tactic">exact</span> (<span class="id" title="var">derrec_rmono</span> (<span class="id" title="var">fst</span> <span class="id" title="var">rab</span>) (<span class="id" title="var">da</span> <span class="id" title="var">Gam1</span> <span class="id" title="var">Gam2</span>)). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weakeningL</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">V</span> <span class="id" title="var">W</span> <span class="id" title="var">seq</span> <span class="id" title="var">rules</span>, @<span class="id" title="var">can_wkL</span> <span class="id" title="var">V</span> <span class="id" title="var">W</span> (<span class="id" title="var">fst_ext_rls</span> <span class="id" title="var">rules</span>) <span class="id" title="var">seq</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">can_wkL</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">derrec_all_rect</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="var">contradiction</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> <span class="id" title="var">ljpc</span> <span class="id" title="var">dsps</span> <span class="id" title="var">fwk</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">ljpc</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">r</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">c0</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">wkL_valid'</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">wkL_valid</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">r</span>.<br/>
<span class="id" title="tactic">intros</span> *. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">fmlsext_fmlsext</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">derI</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">fextI</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">rmI_eq</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X0</span>.<br/>
<span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">dersrecI_forall</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">c0</span> <span class="id" title="var">incm</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">InT_mapE</span> <span class="id" title="tactic">in</span> <span class="id" title="var">incm</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">fwk</span>.<br/>
2: <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_map</span>. 2: <span class="id" title="tactic">exact</span> <span class="id" title="var">incm1</span>.<br/>
<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">incm0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">incm0</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">fwk</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">wkL_valid'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">fwk</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">wkL_valid</span> <span class="id" title="tactic">in</span> <span class="id" title="var">fwk</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">fwk</span>.<br/>
<span class="id" title="tactic">rewrite</span> - <span class="id" title="var">fmlsext_fmlsext</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">fwk</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Print</span> <span class="id" title="keyword">Implicit</span> <span class="id" title="var">weakeningL</span>.<br/>

<br/>
</div>

<div class="doc">
exchange 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">can_exchL</span> <span class="id" title="var">W</span> <span class="id" title="var">Y</span> <span class="id" title="var">rules</span> <span class="id" title="var">seq</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">Gam</span> <span class="id" title="var">Gams</span> : <span class="id" title="var">list</span> <span class="id" title="var">W</span>) (<span class="id" title="var">Delt</span> : <span class="id" title="var">Y</span>), <span class="id" title="var">seq</span> = <span class="id" title="var">pair</span> <span class="id" title="var">Gam</span> <span class="id" title="var">Delt</span> -&gt; <span class="id" title="var">swapped</span> <span class="id" title="var">Gam</span> <span class="id" title="var">Gams</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">_</span>) (<span class="id" title="var">pair</span> <span class="id" title="var">Gams</span> <span class="id" title="var">Delt</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">can_exchR</span> <span class="id" title="var">W</span> <span class="id" title="var">Y</span> <span class="id" title="var">rules</span> <span class="id" title="var">seq</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">Gam</span> : <span class="id" title="var">Y</span>) (<span class="id" title="var">Delt</span> <span class="id" title="var">Delts</span> : <span class="id" title="var">list</span> <span class="id" title="var">W</span>), <span class="id" title="var">seq</span> = <span class="id" title="var">pair</span> <span class="id" title="var">Gam</span> <span class="id" title="var">Delt</span> -&gt; <span class="id" title="var">swapped</span> <span class="id" title="var">Delt</span> <span class="id" title="var">Delts</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">_</span>) (<span class="id" title="var">pair</span> <span class="id" title="var">Gam</span> <span class="id" title="var">Delts</span>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">sing_empty</span> <span class="id" title="var">X</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">se_empty</span> : <span class="id" title="var">sing_empty</span> []<br/>
&nbsp;&nbsp;| <span class="id" title="var">se_single</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, <span class="id" title="var">sing_empty</span> [<span class="id" title="var">a</span>].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sing_empty_app</span> <span class="id" title="var">X</span> (<span class="id" title="var">xs</span> <span class="id" title="var">ys</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">sing_empty</span> (<span class="id" title="var">xs</span> ++ <span class="id" title="var">ys</span>) -&gt; <span class="id" title="var">sum</span> (<span class="id" title="var">xs</span> = []) (<span class="id" title="var">ys</span> = []).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">xs</span>. <span class="id" title="tactic">tauto</span>.<br/>
<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H0</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">xs</span>. <span class="id" title="tactic">tauto</span>.<br/>
<span class="id" title="tactic">injection</span> <span class="id" title="var">H0</span> <span class="id" title="keyword">as</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">xs</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">tauto</span>.<br/>
<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H0</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sing_empty_app_cons</span> <span class="id" title="var">X</span> <span class="id" title="var">z</span> (<span class="id" title="var">xs</span> <span class="id" title="var">ys</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">sing_empty</span> (<span class="id" title="var">xs</span> ++ <span class="id" title="var">z</span> :: <span class="id" title="var">ys</span>) -&gt; (<span class="id" title="var">xs</span> = []) * (<span class="id" title="var">ys</span> = []).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">se</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">se</span>.<br/>
<span class="id" title="var">list_eq_ncT</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>. <span class="id" title="var">list_eq_ncT</span>. <span class="id" title="var">sD</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">tauto</span>.<br/>
<span class="id" title="var">list_eq_ncT</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">fst_rel</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">R</span> : <span class="id" title="var">relationT</span> <span class="id" title="var">A</span>) : <span class="id" title="var">relationT</span> (<span class="id" title="var">A</span> * <span class="id" title="var">B</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">fst_relI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>, <span class="id" title="var">R</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; @<span class="id" title="var">fst_rel</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">R</span> (<span class="id" title="var">x</span>, <span class="id" title="var">z</span> : <span class="id" title="var">B</span>) (<span class="id" title="var">y</span>, <span class="id" title="var">z</span>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">snd_rel</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">R</span> : <span class="id" title="var">relationT</span> <span class="id" title="var">A</span>) : <span class="id" title="var">relationT</span> (<span class="id" title="var">B</span> * <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">snd_relI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>, <span class="id" title="var">R</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; @<span class="id" title="var">snd_rel</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">R</span> (<span class="id" title="var">z</span> : <span class="id" title="var">B</span>, <span class="id" title="var">x</span>) (<span class="id" title="var">z</span>, <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fext_e</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">U</span> <span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">pr</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">list</span> <span class="id" title="var">U</span> * <span class="id" title="var">W</span>)) <span class="id" title="var">ps</span> <span class="id" title="var">cl</span> <span class="id" title="var">cr</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">pr</span> <span class="id" title="var">ps</span> (<span class="id" title="var">cl</span>, <span class="id" title="var">cr</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">fst_ext_rls</span> <span class="id" title="var">pr</span> (<span class="id" title="var">map</span> (<span class="id" title="var">apfst</span> (<span class="id" title="var">fmlsext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span>)) <span class="id" title="var">ps</span>) (<span class="id" title="var">Phi1</span> ++ <span class="id" title="var">cl</span> ++ <span class="id" title="var">Phi2</span>, <span class="id" title="var">cr</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">fmlsext_def</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">fextI</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">rmI_eq</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sext_e</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">U</span> <span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">pr</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">U</span> * <span class="id" title="var">list</span> <span class="id" title="var">W</span>)) <span class="id" title="var">ps</span> <span class="id" title="var">cl</span> <span class="id" title="var">cr</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">pr</span> <span class="id" title="var">ps</span> (<span class="id" title="var">cl</span>, <span class="id" title="var">cr</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">snd_ext_rls</span> <span class="id" title="var">pr</span> (<span class="id" title="var">map</span> (<span class="id" title="var">apsnd</span> (<span class="id" title="var">fmlsext</span> <span class="id" title="var">Phi1</span> <span class="id" title="var">Phi2</span>)) <span class="id" title="var">ps</span>) (<span class="id" title="var">cl</span>, <span class="id" title="var">Phi1</span> ++ <span class="id" title="var">cr</span> ++ <span class="id" title="var">Phi2</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">fmlsext_def</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">sextI</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">rmI_eq</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X0</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">X0</span> <span class="id" title="keyword">as</span> <span class="id" title="var">r</span> ; <span class="id" title="tactic">apply</span> <span class="id" title="var">sea</span> <span class="id" title="tactic">in</span> <span class="id" title="var">r</span> ;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span> ; <span class="id" title="tactic">subst</span> ; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_r</span> ; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_l</span> ;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X0</span> ; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X0</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">fwl_tac</span> <span class="id" title="var">mid</span> := <span class="id" title="tactic">eexists</span> ; <span class="id" title="tactic">split</span> ;<br/>
&nbsp;&nbsp;[&gt; <span class="id" title="var">assoc_mid</span> <span class="id" title="var">mid</span> ; <span class="id" title="tactic">apply</span> <span class="id" title="var">fext_e</span> ; <span class="id" title="var">eassumption</span> |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span> ; <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">inms</span> ; <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_mapE</span> <span class="id" title="tactic">in</span> <span class="id" title="var">inms</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">inms</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">x0</span> <span class="id" title="var">p</span>] ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">sex</span> <span class="id" title="var">int</span>] ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x0</span> ; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">sex</span> ; <span class="id" title="tactic">unfold</span> <span class="id" title="var">fmlsext</span> <span class="id" title="tactic">in</span> <span class="id" title="var">sex</span> ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">sex</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span> ; <span class="id" title="tactic">split</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&gt; <span class="id" title="tactic">eapply</span> <span class="id" title="var">InT_map</span> ; <span class="id" title="var">eassumption</span> |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> ; <span class="id" title="tactic">unfold</span> <span class="id" title="var">fmlsext</span> ; <span class="id" title="tactic">apply</span> <span class="id" title="var">fst_relI</span> ; <span class="id" title="var">swap_tac</span> ]].<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">fwr_tac</span> <span class="id" title="var">mid</span> := <span class="id" title="tactic">eexists</span> ; <span class="id" title="tactic">split</span> ;<br/>
&nbsp;&nbsp;[&gt; <span class="id" title="var">assoc_mid</span> <span class="id" title="var">mid</span> ; <span class="id" title="tactic">apply</span> <span class="id" title="var">sext_e</span> ; <span class="id" title="var">eassumption</span> |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span> ; <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">inms</span> ; <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_mapE</span> <span class="id" title="tactic">in</span> <span class="id" title="var">inms</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">inms</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">x0</span> <span class="id" title="var">p</span>] ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">sex</span> <span class="id" title="var">int</span>] ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x0</span> ; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">sex</span> ; <span class="id" title="tactic">unfold</span> <span class="id" title="var">fmlsext</span> <span class="id" title="tactic">in</span> <span class="id" title="var">sex</span> ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">sex</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span> ; <span class="id" title="tactic">split</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&gt; <span class="id" title="tactic">eapply</span> <span class="id" title="var">InT_map</span> ; <span class="id" title="var">eassumption</span> |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> ; <span class="id" title="tactic">unfold</span> <span class="id" title="var">fmlsext</span> ; <span class="id" title="tactic">apply</span> <span class="id" title="var">snd_relI</span> ; <span class="id" title="var">swap_tac</span> ]].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">exchL_std_rule</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">list</span> <span class="id" title="var">U</span> * <span class="id" title="var">W</span>)),<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">U</span> <span class="id" title="var">S</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> (<span class="id" title="var">U</span>, <span class="id" title="var">S</span>) -&gt; <span class="id" title="var">sing_empty</span> <span class="id" title="var">U</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">fst_ext_rls</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">can_trf_rules</span> (<span class="id" title="var">fst_rel</span> (@<span class="id" title="var">swapped</span> <span class="id" title="var">_</span>)) (<span class="id" title="var">fst_ext_rls</span> <span class="id" title="var">rules</span>) <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">se</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">sqr</span> <span class="id" title="var">c'</span> <span class="id" title="var">fr</span>.<br/>
<span class="id" title="tactic">pose</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ps</span> <span class="id" title="var">xs</span> <span class="id" title="var">ys</span> <span class="id" title="var">S</span> <span class="id" title="var">rps</span> =&gt; <br/>
&nbsp;&nbsp;<span class="id" title="var">sing_empty_app</span> <span class="id" title="var">xs</span> <span class="id" title="var">ys</span> (<span class="id" title="var">se</span> <span class="id" title="var">ps</span> (<span class="id" title="var">xs</span> ++ <span class="id" title="var">ys</span>) <span class="id" title="var">S</span> <span class="id" title="var">rps</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">sea</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">fr</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">fr</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">sqr</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">sqr</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">pl</span> <span class="id" title="var">pr</span>].<br/>
<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">fmlsext</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">X0</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="var">acacD'T2</span> ; <span class="id" title="tactic">subst</span>.<br/>
- <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>. + <span class="id" title="var">fwl_tac</span> <span class="id" title="var">H3</span>. + <span class="id" title="var">fwl_tac</span> <span class="id" title="var">H1</span>.<br/>
- <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>. <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>.<br/>
+ <span class="id" title="var">fwl_tac</span> <span class="id" title="var">H5</span>. + <span class="id" title="var">fwl_tac</span> <span class="id" title="var">C</span>.<br/>
+ <span class="id" title="var">list_eq_nc</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_r</span>. <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_l</span>.<br/>
<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="var">fwl_tac</span> <span class="id" title="var">H1</span>.<br/>
- <span class="id" title="var">fwl_tac</span> <span class="id" title="var">pl</span>.<br/>
- <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>. + <span class="id" title="var">fwl_tac</span> <span class="id" title="var">H5</span>. + <span class="id" title="var">fwl_tac</span> <span class="id" title="var">H3</span>.<br/>
- <span class="id" title="var">fwl_tac</span> <span class="id" title="var">pl</span>.<br/>
- <span class="id" title="var">fwl_tac</span> <span class="id" title="var">pl</span>.<br/>
- <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>. + <span class="id" title="var">fwl_tac</span> <span class="id" title="var">H1</span>. + <span class="id" title="var">fwl_tac</span> <span class="id" title="var">H</span>.<br/>
- <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>. <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>.<br/>
+ <span class="id" title="var">fwl_tac</span> <span class="id" title="var">H3</span>. + <span class="id" title="var">fwl_tac</span> <span class="id" title="var">B</span>.<br/>
+ <span class="id" title="var">list_eq_ncT</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_r</span>. <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span> ; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="var">fwl_tac</span> <span class="id" title="var">H</span>.<br/>
- <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>. <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>. <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>.<br/>
+ <span class="id" title="var">fwl_tac</span> <span class="id" title="var">H5</span>. + <span class="id" title="var">fwl_tac</span> <span class="id" title="var">C</span>.<br/>
+ <span class="id" title="var">list_eq_ncT</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_r</span>. <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span> ; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="var">fwl_tac</span> <span class="id" title="var">B</span>.<br/>
+ <span class="id" title="var">list_eq_nc</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>. <span class="id" title="var">list_eq_nc</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_r</span>. <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span> ; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="var">fwl_tac</span> <span class="id" title="var">H</span>.<br/>
- <span class="id" title="var">fwl_tac</span> <span class="id" title="var">pl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Print</span> <span class="id" title="keyword">Implicit</span> <span class="id" title="var">exchL_std_rule</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">exchR_std_rule</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">U</span> * <span class="id" title="var">list</span> <span class="id" title="var">W</span>)),<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">U</span> <span class="id" title="var">S</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> (<span class="id" title="var">U</span>, <span class="id" title="var">S</span>) -&gt; <span class="id" title="var">sing_empty</span> <span class="id" title="var">S</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">snd_ext_rls</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">can_trf_rules</span> (<span class="id" title="var">snd_rel</span> (@<span class="id" title="var">swapped</span> <span class="id" title="var">_</span>)) (<span class="id" title="var">snd_ext_rls</span> <span class="id" title="var">rules</span>) <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">se</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">sqr</span> <span class="id" title="var">c'</span> <span class="id" title="var">fr</span>.<br/>
<span class="id" title="tactic">pose</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ps</span> <span class="id" title="var">xs</span> <span class="id" title="var">ys</span> <span class="id" title="var">U</span> <span class="id" title="var">rps</span> =&gt; <br/>
&nbsp;&nbsp;<span class="id" title="var">sing_empty_app</span> <span class="id" title="var">xs</span> <span class="id" title="var">ys</span> (<span class="id" title="var">se</span> <span class="id" title="var">ps</span> <span class="id" title="var">U</span> (<span class="id" title="var">xs</span> ++ <span class="id" title="var">ys</span>) <span class="id" title="var">rps</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">sea</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">fr</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">fr</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">sqr</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">sqr</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">pl</span> <span class="id" title="var">pr</span>].<br/>
<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">fmlsext</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">X0</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="var">acacD'T2</span> ; <span class="id" title="tactic">subst</span>.<br/>
- <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>. + <span class="id" title="var">fwr_tac</span> <span class="id" title="var">H3</span>. + <span class="id" title="var">fwr_tac</span> <span class="id" title="var">H1</span>.<br/>
- <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>. <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>.<br/>
+ <span class="id" title="var">fwr_tac</span> <span class="id" title="var">H5</span>. + <span class="id" title="var">fwr_tac</span> <span class="id" title="var">C</span>.<br/>
+ <span class="id" title="var">list_eq_nc</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_r</span>. <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_l</span>.<br/>
<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="var">fwr_tac</span> <span class="id" title="var">H1</span>.<br/>
- <span class="id" title="var">fwr_tac</span> <span class="id" title="var">pr</span>.<br/>
- <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>. + <span class="id" title="var">fwr_tac</span> <span class="id" title="var">H5</span>. + <span class="id" title="var">fwr_tac</span> <span class="id" title="var">H3</span>.<br/>
- <span class="id" title="var">fwr_tac</span> <span class="id" title="var">pr</span>.<br/>
- <span class="id" title="var">fwr_tac</span> <span class="id" title="var">pr</span>.<br/>
- <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>. + <span class="id" title="var">fwr_tac</span> <span class="id" title="var">H1</span>. + <span class="id" title="var">fwr_tac</span> <span class="id" title="var">H</span>.<br/>
- <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>. <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>.<br/>
+ <span class="id" title="var">fwr_tac</span> <span class="id" title="var">H3</span>. + <span class="id" title="var">fwr_tac</span> <span class="id" title="var">B</span>.<br/>
+ <span class="id" title="var">list_eq_ncT</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_r</span>. <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span> ; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="var">fwr_tac</span> <span class="id" title="var">H</span>.<br/>
- <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>. <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>. <span class="id" title="var">concl_in_app</span> <span class="id" title="var">X1</span> <span class="id" title="var">r</span> <span class="id" title="var">sea</span>.<br/>
+ <span class="id" title="var">fwr_tac</span> <span class="id" title="var">H5</span>. + <span class="id" title="var">fwr_tac</span> <span class="id" title="var">C</span>.<br/>
+ <span class="id" title="var">list_eq_ncT</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_r</span>. <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span> ; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="var">fwr_tac</span> <span class="id" title="var">B</span>.<br/>
+ <span class="id" title="var">list_eq_nc</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>. <span class="id" title="var">list_eq_nc</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_r</span>. <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span> ; <span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">app_nil_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="var">fwr_tac</span> <span class="id" title="var">H</span>.<br/>
- <span class="id" title="var">fwr_tac</span> <span class="id" title="var">pr</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Print</span> <span class="id" title="keyword">Implicit</span> <span class="id" title="var">exchR_std_rule</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">rev_pair</span> {<span class="id" title="var">U</span> <span class="id" title="var">W</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">U</span> * <span class="id" title="var">W</span>) := <span class="id" title="keyword">let</span> (<span class="id" title="var">x</span>, <span class="id" title="var">y</span>) := <span class="id" title="var">p</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">y</span>, <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sext_rev_fext</span> <span class="id" title="var">U</span> <span class="id" title="var">W</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">rlsT</span> (<span class="id" title="var">U</span> * <span class="id" title="var">list</span> <span class="id" title="var">W</span>)) <span class="id" title="var">ps</span> <span class="id" title="var">c</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">snd_ext_rls</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">fst_ext_rls</span> (<span class="id" title="var">rlsmap</span> <span class="id" title="var">rev_pair</span> <span class="id" title="var">rules</span>) (<span class="id" title="var">map</span> <span class="id" title="var">rev_pair</span> <span class="id" title="var">ps</span>) (<span class="id" title="var">rev_pair</span> <span class="id" title="var">c</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">ser</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">ser</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c0</span>.<br/>
<span class="id" title="tactic">clear</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">fextI</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">rmI_eq</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rmI</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X</span>.<br/>
2: <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">clear</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">ps0</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHps0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Print</span> <span class="id" title="keyword">Implicit</span> <span class="id" title="var">sext_rev_fext</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">Idrule</span> (<span class="id" title="var">W</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="var">rlsT</span> (<span class="id" title="var">rel</span> (<span class="id" title="var">list</span> <span class="id" title="var">W</span>)) :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">Idrule_I</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span>, <span class="id" title="var">Idrule</span> [] (<span class="id" title="var">pair</span> [<span class="id" title="var">A</span>] [<span class="id" title="var">A</span>]).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sr_Id_alt</span> <span class="id" title="var">X</span> (<span class="id" title="var">A</span> : <span class="id" title="var">X</span>) <span class="id" title="var">ant</span> <span class="id" title="var">suc</span>: <span class="id" title="var">InT</span> <span class="id" title="var">A</span> <span class="id" title="var">ant</span> -&gt; <span class="id" title="var">InT</span> <span class="id" title="var">A</span> <span class="id" title="var">suc</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">seqrule</span> (@<span class="id" title="var">Idrule</span> <span class="id" title="var">X</span>) [] (<span class="id" title="var">ant</span>, <span class="id" title="var">suc</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_split</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">InT_split</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X0</span>. <span class="id" title="var">cD</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">Sctxt_eq</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Idrule_I</span> <span class="id" title="var">A</span>).<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>