<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>ddT</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library ddT</h1>

<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">List</span>.<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>
<span class="id" title="keyword">Export</span> <span class="id" title="var">ListNotations</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Coq.Program.Equality</span>. 
<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">genT</span> <span class="id" title="var">gen</span> <span class="id" title="var">existsT</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">PeanoNat</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">aderrec</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Prop</span>) <br/>
&nbsp;&nbsp;(<span class="id" title="var">prems</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Prop</span>) : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Prop</span> := <br/>
&nbsp;&nbsp;| <span class="id" title="var">adpI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">concl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">prems</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">aderrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">aderI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Forall</span> (<span class="id" title="var">aderrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">aderrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">derrec</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">prems</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span> := <br/>
&nbsp;&nbsp;| <span class="id" title="var">dpI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">concl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">prems</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">derI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> <br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">dersrec</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">prems</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">dlNil</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> []<br/>
&nbsp;&nbsp;| <span class="id" title="var">dlCons</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">seq</span> <span class="id" title="var">seqs</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">seq</span> -&gt; <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">seqs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">seq</span> :: <span class="id" title="var">seqs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.<br/>

<br/>
<span class="id" title="keyword">Scheme</span> <span class="id" title="var">derrec_rect_mut</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">derrec</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Type</span><br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">dersrec_rect_mut</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">dersrec</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Type</span>.<br/>
<span class="id" title="keyword">Scheme</span> <span class="id" title="var">derrec_rec_mut</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">derrec</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Set</span><br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">dersrec_rec_mut</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">dersrec</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Set</span>.<br/>
<span class="id" title="keyword">Scheme</span> <span class="id" title="var">derrec_ind_mut</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">derrec</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span><br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">dersrec_ind_mut</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">dersrec</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derrec_dersrec_rect_mut</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">P</span> <span class="id" title="var">P0</span> <span class="id" title="var">dp</span> <span class="id" title="var">der</span> <span class="id" title="var">dln</span> <span class="id" title="var">dlc</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">pair</span> (@<span class="id" title="var">derrec_rect_mut</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">P</span> <span class="id" title="var">P0</span> <span class="id" title="var">dp</span> <span class="id" title="var">der</span> <span class="id" title="var">dln</span> <span class="id" title="var">dlc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">dersrec_rect_mut</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">P</span> <span class="id" title="var">P0</span> <span class="id" title="var">dp</span> <span class="id" title="var">der</span> <span class="id" title="var">dln</span> <span class="id" title="var">dlc</span>).<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">solve_dersrec</span> := <span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">dlCons</span> || <span class="id" title="tactic">apply</span> <span class="id" title="var">dlNil</span> || <span class="id" title="tactic">assumption</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dim_all</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">Q</span> := <br/>
&nbsp;&nbsp;@<span class="id" title="var">derrec_ind_mut</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Q</span> <span class="id" title="var">y</span>) <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">ys</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Forall</span> <span class="id" title="var">Q</span> <span class="id" title="var">ys</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dim_allT</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> (<span class="id" title="var">prems</span> <span class="id" title="var">Q</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) := <br/>
&nbsp;&nbsp;@<span class="id" title="var">derrec_rect_mut</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Q</span> <span class="id" title="var">y</span>) <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">ys</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">ForallT</span> <span class="id" title="var">Q</span> <span class="id" title="var">ys</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dim_all3</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">Q</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span> := <br/>
&nbsp;&nbsp;@<span class="id" title="var">dim_all</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">Q</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span> (<span class="id" title="var">Forall_nil</span> <span class="id" title="var">Q</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fce3</span> <span class="id" title="var">X</span> <span class="id" title="var">Q</span> <span class="id" title="var">D</span> <span class="id" title="var">Ds</span> <span class="id" title="var">seq</span> <span class="id" title="var">seqs</span> (<span class="id" title="var">d</span> : <span class="id" title="var">D</span> <span class="id" title="var">seq</span>) <span class="id" title="var">qs</span> (<span class="id" title="var">ds</span> : <span class="id" title="var">Ds</span> <span class="id" title="var">seqs</span>) <span class="id" title="var">qss</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">Forall_cons</span> <span class="id" title="var">X</span> <span class="id" title="var">Q</span> <span class="id" title="var">seq</span> <span class="id" title="var">seqs</span> <span class="id" title="var">qs</span> <span class="id" title="var">qss</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dim_all4</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">Q</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span> := <br/>
&nbsp;&nbsp;@<span class="id" title="var">dim_all3</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">Q</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span> <br/>
&nbsp;&nbsp;(@<span class="id" title="var">fce3</span> <span class="id" title="var">X</span> <span class="id" title="var">Q</span> (<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) (<span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dim_all8</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">Q</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span> := <br/>
&nbsp;&nbsp;@<span class="id" title="var">dim_all3</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">Q</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span> <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">seq</span> <span class="id" title="var">seqs</span> <span class="id" title="var">_</span> <span class="id" title="var">qs</span> <span class="id" title="var">_</span> <span class="id" title="var">qss</span> =&gt; @<span class="id" title="var">Forall_cons</span> <span class="id" title="var">X</span> <span class="id" title="var">Q</span> <span class="id" title="var">seq</span> <span class="id" title="var">seqs</span> <span class="id" title="var">qs</span> <span class="id" title="var">qss</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derrec_all_ind</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">prems</span> <span class="id" title="var">Q</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">concl</span> : <span class="id" title="var">X</span>, <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">concl</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> (<span class="id" title="var">ps</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>) (<span class="id" title="var">concl</span> : <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">Forall</span> <span class="id" title="var">Q</span> <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">concl</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> : <span class="id" title="var">X</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">dim_all</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H0</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Forall_nil</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Forall_cons</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derrec_all_indT</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">prems</span> <span class="id" title="var">Q</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">concl</span> : <span class="id" title="var">X</span>, <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">concl</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> (<span class="id" title="var">ps</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>) (<span class="id" title="var">concl</span> : <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">ForallT</span> <span class="id" title="var">Q</span> <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">concl</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> : <span class="id" title="var">X</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">Q</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span> <span class="id" title="var">H0</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">dim_allT</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">H0</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_nil</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_cons</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derrec_all_rect</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">prems</span> <span class="id" title="var">Q</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">concl</span> : <span class="id" title="var">X</span>, <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">concl</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> (<span class="id" title="var">ps</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>) (<span class="id" title="var">concl</span> : <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">ForallT</span> <span class="id" title="var">Q</span> <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">concl</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> : <span class="id" title="var">X</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">dim_allT</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_nil</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_cons</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derrec_derrec'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>:<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">c</span> : <span class="id" title="var">X</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) <span class="id" title="var">c</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span>) *<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">cs</span>, <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> (<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">derrec_dersrec_rect_mut</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">assumption</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">derI</span> ; <span class="id" title="var">eassumption</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">dlNil</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dlCons</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derrec_derrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> := <span class="id" title="var">fst</span> (@<span class="id" title="var">derrec_derrec'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrec_derrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> := <span class="id" title="var">snd</span> (@<span class="id" title="var">derrec_derrec'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">derl</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span> := <br/>
&nbsp;&nbsp;| <span class="id" title="var">asmI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">p</span>, <span class="id" title="var">derl</span> <span class="id" title="var">rules</span> [<span class="id" title="var">p</span>] <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">dtderI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">pss</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">pss</span> <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">derl</span> <span class="id" title="var">rules</span> <span class="id" title="var">pss</span> <span class="id" title="var">concl</span><br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">dersl</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span> := <br/>
&nbsp;&nbsp;| <span class="id" title="var">dtNil</span> : <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> [] []<br/>
&nbsp;&nbsp;| <span class="id" title="var">dtCons</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">derl</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> (<span class="id" title="var">ps</span> ++ <span class="id" title="var">pss</span>) (<span class="id" title="var">c</span> :: <span class="id" title="var">cs</span>)<br/>
&nbsp;&nbsp;.<br/>

<br/>
<span class="id" title="keyword">Scheme</span> <span class="id" title="var">derl_ind_mut</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">derl</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span><br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">dersl_ind_mut</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">dersl</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Scheme</span> <span class="id" title="var">derl_rec_mut</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">derl</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Set</span><br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">dersl_rec_mut</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">dersl</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Set</span>.<br/>
<span class="id" title="keyword">Scheme</span> <span class="id" title="var">derl_rect_mut</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">derl</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Type</span><br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">dersl_rect_mut</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">dersl</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Type</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dtCons_eq</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span> <span class="id" title="var">psa</span>: <span class="id" title="var">derl</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> (<span class="id" title="var">c</span> : <span class="id" title="var">X</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">psa</span> = <span class="id" title="var">ps</span> ++ <span class="id" title="var">pss</span> -&gt; <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">psa</span> (<span class="id" title="var">c</span> :: <span class="id" title="var">cs</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dtCons</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derl_dersl_single</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> (<span class="id" title="var">c</span> : <span class="id" title="var">X</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> [<span class="id" title="var">c</span>]) (<span class="id" title="var">derl</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">split</span>.<br/>
<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X2</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_nil_r</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">eapply</span> (<span class="id" title="var">dtCons_eq</span> <span class="id" title="var">X0</span> (<span class="id" title="var">dtNil</span> <span class="id" title="var">_</span>)). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_nil_r</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derl_dersl_rect_mut</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">P</span> <span class="id" title="var">P0</span> <span class="id" title="var">asm</span> <span class="id" title="var">dtd</span> <span class="id" title="var">dtn</span> <span class="id" title="var">dtc</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">pair</span> (@<span class="id" title="var">derl_rect_mut</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">P</span> <span class="id" title="var">P0</span> <span class="id" title="var">asm</span> <span class="id" title="var">dtd</span> <span class="id" title="var">dtn</span> <span class="id" title="var">dtc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">dersl_rect_mut</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">P</span> <span class="id" title="var">P0</span> <span class="id" title="var">asm</span> <span class="id" title="var">dtd</span> <span class="id" title="var">dtn</span> <span class="id" title="var">dtc</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">asmsI</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span>: @<span class="id" title="var">dersl</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">ps</span> .<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">ps</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dtNil</span>. <span class="id" title="tactic">pose</span> (<span class="id" title="var">asmI</span> <span class="id" title="var">rules</span> <span class="id" title="var">a</span>).<br/>
<span class="id" title="tactic">pose</span> (<span class="id" title="var">dtCons</span> <span class="id" title="var">d</span> <span class="id" title="var">IHps</span>). <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">d0</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">d0</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">in_derl</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>: <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; @<span class="id" title="var">derl</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">dtderI</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">asmsI</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">rsub_derl</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> := <span class="id" title="var">rsubI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (@<span class="id" title="var">in_derl</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">dercl</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span> := <br/>
&nbsp;&nbsp;| <span class="id" title="var">casmI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">p</span>, <span class="id" title="var">dercl</span> <span class="id" title="var">rules</span> [<span class="id" title="var">p</span>] <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">dtcderI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">pss</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dercsl</span> <span class="id" title="var">rules</span> <span class="id" title="var">pss</span> <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">dercl</span> <span class="id" title="var">rules</span> (<span class="id" title="var">concat</span> <span class="id" title="var">pss</span>) <span class="id" title="var">concl</span><br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">dercsl</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">list</span> (<span class="id" title="var">list</span> <span class="id" title="var">X</span>) -&gt; <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span> := <br/>
&nbsp;&nbsp;| <span class="id" title="var">dtcNil</span> : <span class="id" title="var">dercsl</span> <span class="id" title="var">rules</span> [] []<br/>
&nbsp;&nbsp;| <span class="id" title="var">dtcCons</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span>, <span class="id" title="var">dercl</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dercsl</span> <span class="id" title="var">rules</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">dercsl</span> <span class="id" title="var">rules</span> (<span class="id" title="var">ps</span> :: <span class="id" title="var">pss</span>) (<span class="id" title="var">c</span> :: <span class="id" title="var">cs</span>)<br/>
&nbsp;&nbsp;.<br/>

<br/>
<span class="id" title="keyword">Scheme</span> <span class="id" title="var">dercl_ind_mut</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">dercl</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span><br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">dercsl_ind_mut</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">dercsl</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Scheme</span> <span class="id" title="var">dercl_rec_mut</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">dercl</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Set</span><br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">dercsl_rec_mut</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">dercsl</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Set</span>.<br/>
<span class="id" title="keyword">Scheme</span> <span class="id" title="var">dercl_rect_mut</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">dercl</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Type</span><br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">dercsl_rect_mut</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">dercsl</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Type</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dercl_dercsl_rect_mut</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">P</span> <span class="id" title="var">P0</span> <span class="id" title="var">asm</span> <span class="id" title="var">dtd</span> <span class="id" title="var">dtn</span> <span class="id" title="var">dtc</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">pair</span> (@<span class="id" title="var">dercl_rect_mut</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">P</span> <span class="id" title="var">P0</span> <span class="id" title="var">asm</span> <span class="id" title="var">dtd</span> <span class="id" title="var">dtn</span> <span class="id" title="var">dtc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">dercsl_rect_mut</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">P</span> <span class="id" title="var">P0</span> <span class="id" title="var">asm</span> <span class="id" title="var">dtd</span> <span class="id" title="var">dtn</span> <span class="id" title="var">dtc</span>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">ccps</span> <span class="id" title="var">X</span> <span class="id" title="var">f</span> (<span class="id" title="var">qs</span> <span class="id" title="var">cs</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>) : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">ccpsI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">pss</span>, <span class="id" title="var">f</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">qs</span> = <span class="id" title="var">concat</span> <span class="id" title="var">pss</span> -&gt; <span class="id" title="var">ccps</span> <span class="id" title="var">f</span> <span class="id" title="var">qs</span> <span class="id" title="var">cs</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ccpsD</span> <span class="id" title="var">X</span> <span class="id" title="var">f</span> <span class="id" title="var">qs</span> <span class="id" title="var">cs</span>: <span class="id" title="var">ccps</span> <span class="id" title="var">f</span> <span class="id" title="var">qs</span> <span class="id" title="var">cs</span> -&gt;<br/>
&nbsp;&nbsp;{<span class="id" title="var">pss</span> : <span class="id" title="var">list</span> (<span class="id" title="var">list</span> <span class="id" title="var">X</span>) &amp; <span class="id" title="var">qs</span> = <span class="id" title="var">concat</span> <span class="id" title="var">pss</span> &amp; <span class="id" title="var">f</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span>}.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">cc</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">cc</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">pss</span> ; <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">drl_allT</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> <span class="id" title="var">Q</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) <span class="id" title="var">R</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">derl_rect_mut</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ps</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Q</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">pss</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">cs</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">R</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">drsl_allT</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> <span class="id" title="var">Q</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) <span class="id" title="var">R</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">dersl_rect_mut</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ps</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Q</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">pss</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">cs</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">R</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">drl_allT'</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> <span class="id" title="var">Q</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">derl_rect_mut</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ps</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Q</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">ps</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">cs</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">ccps</span> (<span class="id" title="var">Forall2T</span> <span class="id" title="var">Q</span>) <span class="id" title="var">ps</span> <span class="id" title="var">cs</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">drsl_allT'</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> <span class="id" title="var">Q</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">dersl_rect_mut</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ps</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Q</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">ps</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">cs</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">ccps</span> (<span class="id" title="var">Forall2T</span> <span class="id" title="var">Q</span>) <span class="id" title="var">ps</span> <span class="id" title="var">cs</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dcl_allT</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> <span class="id" title="var">Q</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">dercl_rect_mut</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ps</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Q</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">pss</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">cs</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Forall2T</span> <span class="id" title="var">Q</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dcsl_allT</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> <span class="id" title="var">Q</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">dercsl_rect_mut</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ps</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Q</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">pss</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">cs</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Forall2T</span> <span class="id" title="var">Q</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dercl_all_rect</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> <span class="id" title="var">Q</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">p</span> : <span class="id" title="var">X</span>, <span class="id" title="var">Q</span> [<span class="id" title="var">p</span>] <span class="id" title="var">p</span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">pss</span> <span class="id" title="var">qs</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">dercsl</span> <span class="id" title="var">rules</span> <span class="id" title="var">pss</span> <span class="id" title="var">ps</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Forall2T</span> <span class="id" title="var">Q</span> <span class="id" title="var">pss</span> <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">qs</span> = <span class="id" title="var">concat</span> <span class="id" title="var">pss</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">qs</span> <span class="id" title="var">concl</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">dercl</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">dcl_allT</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X0</span>.<br/>
{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">X1</span>. <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">eassumption</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Forall2T_nil</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Forall2T_cons</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derscl_all_dercl</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span>, <span class="id" title="var">dercsl</span> <span class="id" title="var">rules</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">Forall2T</span> (<span class="id" title="var">dercl</span> <span class="id" title="var">rules</span>) <span class="id" title="var">pss</span> <span class="id" title="var">cs</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dcsl_allT</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">casmI</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">dtcderI</span> ; <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Forall2T_nil</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Forall2T_cons</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">all_dercl_derscl</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span>, <span class="id" title="var">Forall2T</span> (<span class="id" title="var">dercl</span> <span class="id" title="var">rules</span>) <span class="id" title="var">pss</span> <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">dercsl</span> <span class="id" title="var">rules</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">pss</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dtcNil</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dtcCons</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">IHpss</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">all_derl_dersl</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span>, <span class="id" title="var">Forall2T</span> (<span class="id" title="var">derl</span> <span class="id" title="var">rules</span>) <span class="id" title="var">pss</span> <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> (<span class="id" title="var">concat</span> <span class="id" title="var">pss</span>) <span class="id" title="var">cs</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">pss</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dtNil</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dtCons</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">IHpss</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">all_derl_dersl'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">qs</span> <span class="id" title="var">cs</span>, <span class="id" title="var">ccps</span> (<span class="id" title="var">Forall2T</span> (<span class="id" title="var">derl</span> <span class="id" title="var">rules</span>)) <span class="id" title="var">qs</span> <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">qs</span> <span class="id" title="var">cs</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">all_derl_dersl</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersl_all_derl</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">qs</span> <span class="id" title="var">cs</span>, <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">qs</span> <span class="id" title="var">cs</span> -&gt;<br/>
&nbsp;&nbsp;{<span class="id" title="var">pss</span> : <span class="id" title="var">list</span> (<span class="id" title="var">list</span> <span class="id" title="var">X</span>) &amp; <span class="id" title="var">qs</span> = <span class="id" title="var">concat</span> <span class="id" title="var">pss</span> &amp; <span class="id" title="var">Forall2T</span> (<span class="id" title="var">derl</span> <span class="id" title="var">rules</span>) <span class="id" title="var">pss</span> <span class="id" title="var">cs</span>}.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">drsl_allT</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">asmI</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">dtderI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">d</span>.<br/>
<span class="id" title="tactic">exists</span> []. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Forall2T_nil</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">ps</span> :: <span class="id" title="var">x</span>). <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Forall2T_cons</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersl_all_derl'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">qs</span> <span class="id" title="var">cs</span>, <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">qs</span> <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">ccps</span> (<span class="id" title="var">Forall2T</span> (<span class="id" title="var">derl</span> <span class="id" title="var">rules</span>)) <span class="id" title="var">qs</span> <span class="id" title="var">cs</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">drsl_allT'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">asmI</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">dtderI</span> ; <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ccpsI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Forall2T_nil</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">ccpsI</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Forall2T_cons</span> ; <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dercl_derl'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">prod</span> (<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">dercl</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">derl</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span>, <span class="id" title="var">dercsl</span> <span class="id" title="var">rules</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> (<span class="id" title="var">concat</span> <span class="id" title="var">pss</span>) <span class="id" title="var">cs</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">eapply</span> (<span class="id" title="var">dercl_dercsl_rect_mut</span> (<span class="id" title="var">rules</span> := <span class="id" title="var">rules</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">ps</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">derl</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> (<span class="id" title="var">concat</span> <span class="id" title="var">pss</span>) <span class="id" title="var">cs</span>)).<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">asmI</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">dtderI</span>. <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dtNil</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dtCons</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dercl_derl</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> := <span class="id" title="var">fst</span> (@<span class="id" title="var">dercl_derl'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dercsl_dersl</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> := <span class="id" title="var">snd</span> (@<span class="id" title="var">dercl_derl'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derl_dercl</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">derl</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">dercl</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>.<br/>
<span class="id" title="tactic">eapply</span> (<span class="id" title="var">drl_allT</span> (<span class="id" title="var">dercl</span> <span class="id" title="var">rules</span>) (<span class="id" title="var">ccps</span> (<span class="id" title="var">dercsl</span> <span class="id" title="var">rules</span>))).<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">casmI</span>.<br/>
{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">dtcderI</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="var">eassumption</span>. }<br/>
{ <span class="id" title="tactic">eapply</span> <span class="id" title="var">ccpsI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dtcNil</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ccpsI</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">dtcCons</span> ; <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. } <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derl_all_rect</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> <span class="id" title="var">Q</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">p</span> : <span class="id" title="var">X</span>, <span class="id" title="var">Q</span> [<span class="id" title="var">p</span>] <span class="id" title="var">p</span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">pss</span> <span class="id" title="var">qs</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">qs</span> <span class="id" title="var">ps</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Forall2T</span> <span class="id" title="var">Q</span> <span class="id" title="var">pss</span> <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">qs</span> = <span class="id" title="var">concat</span> <span class="id" title="var">pss</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">qs</span> <span class="id" title="var">concl</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">derl</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">Q</span> <span class="id" title="var">asm</span> <span class="id" title="var">dtd</span>.<br/>
<span class="id" title="tactic">eapply</span> (<span class="id" title="var">drl_allT</span> <span class="id" title="var">Q</span> (<span class="id" title="var">ccps</span> (<span class="id" title="var">Forall2T</span> <span class="id" title="var">Q</span>))).<br/>
<span class="id" title="tactic">exact</span> <span class="id" title="var">asm</span>.<br/>
{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">dtd</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
{ <span class="id" title="tactic">eapply</span> <span class="id" title="var">ccpsI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Forall2T_nil</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ccpsI</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">Forall2T_cons</span> ; <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. } <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derrec_same</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">c</span> <span class="id" title="var">c'</span> : <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">c</span> = <span class="id" title="var">c'</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c'</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derrec_same_nsL</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">Y</span> <span class="id" title="var">X</span> <span class="id" title="var">D</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span> <span class="id" title="var">unk0</span> <span class="id" title="var">d</span> (<span class="id" title="var">unk1</span> <span class="id" title="var">unk1'</span> : <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">G</span> ++ (<span class="id" title="var">unk1</span> : <span class="id" title="var">X</span>, <span class="id" title="var">unk0</span> : <span class="id" title="var">Y</span>, <span class="id" title="var">d</span> : <span class="id" title="var">D</span>) :: <span class="id" title="var">H</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unk1</span> = <span class="id" title="var">unk1'</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">G</span> ++ (<span class="id" title="var">unk1'</span>, <span class="id" title="var">unk0</span>, <span class="id" title="var">d</span>) :: <span class="id" title="var">H</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derrec_same_nsR</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">Y</span> <span class="id" title="var">X</span> <span class="id" title="var">D</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span> <span class="id" title="var">unk1</span> <span class="id" title="var">d</span> (<span class="id" title="var">unk0</span> <span class="id" title="var">unk0'</span> : <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">G</span> ++ (<span class="id" title="var">unk1</span> : <span class="id" title="var">Y</span>, <span class="id" title="var">unk0</span> : <span class="id" title="var">X</span>, <span class="id" title="var">d</span> : <span class="id" title="var">D</span>) :: <span class="id" title="var">H</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unk0</span> = <span class="id" title="var">unk0'</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">G</span> ++ (<span class="id" title="var">unk1</span>, <span class="id" title="var">unk0'</span>, <span class="id" title="var">d</span>) :: <span class="id" title="var">H</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrec_all</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">cs</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span>) (<span class="id" title="var">ForallT</span> (<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) <span class="id" title="var">cs</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">cs</span> ; <span class="id" title="tactic">unfold</span> <span class="id" title="var">iffT</span> ; <span class="id" title="tactic">apply</span> <span class="id" title="var">pair</span> ; <span class="id" title="tactic">intro</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_nil</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dlNil</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_cons</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">iffT</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHcs</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">IHcs</span>. <span class="id" title="tactic">tauto</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dlCons</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">iffT</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHcs</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">IHcs</span>. <span class="id" title="tactic">tauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrecD_all</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">cs</span> := <span class="id" title="var">iffT_D1</span> (@<span class="id" title="var">dersrec_all</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">cs</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrecI_all</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">cs</span> := <span class="id" title="var">iffT_D2</span> (@<span class="id" title="var">dersrec_all</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">cs</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prems_dersrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">ForallT</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> -&gt; @<span class="id" title="var">dersrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">cs</span> ; <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dlNil</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dlCons</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dpI</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrec_forall</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">cs</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span>) (<span class="id" title="keyword">forall</span> <span class="id" title="var">c</span>, <span class="id" title="var">InT</span> <span class="id" title="var">c</span> <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">dersrec_all</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">ForallT_forall</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrecD_forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">cs</span> := <span class="id" title="var">iffT_D1</span> (@<span class="id" title="var">dersrec_forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">cs</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrecI_forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">cs</span> := <span class="id" title="var">iffT_D2</span> (@<span class="id" title="var">dersrec_forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">cs</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrec_nil</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>, <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> ([] : <span class="id" title="var">list</span> <span class="id" title="var">X</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dlNil</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrec_app</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> <span class="id" title="var">ds</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">cs</span> ++ <span class="id" title="var">ds</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">prod</span> (<span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span>) (<span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ds</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">iffT_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dersrec_forall</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">iffT</span>. <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">apply</span> <span class="id" title="var">dersrecI_forall</span> ; <span class="id" title="tactic">intros</span> ; <span class="id" title="tactic">apply</span> <span class="id" title="var">X0</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">InT_appL</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_appR</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">InT_appE</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>. <span class="id" title="var">sD</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">dersrecD_forall</span>. 2 : <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">dersrecD_forall</span>. 2 : <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrec_appD</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> <span class="id" title="var">ds</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">iffT_D1</span> (@<span class="id" title="var">dersrec_app</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> <span class="id" title="var">ds</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrec_appL</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> <span class="id" title="var">ds</span> <span class="id" title="var">da</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">fst</span> (@<span class="id" title="var">dersrec_appD</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> <span class="id" title="var">ds</span> <span class="id" title="var">da</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrec_appR</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> <span class="id" title="var">ds</span> <span class="id" title="var">da</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">snd</span> (@<span class="id" title="var">dersrec_appD</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> <span class="id" title="var">ds</span> <span class="id" title="var">da</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrec_appJ</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> <span class="id" title="var">ds</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">iffT_D2</span> (@<span class="id" title="var">dersrec_app</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> <span class="id" title="var">ds</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrec_appI</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> <span class="id" title="var">ds</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">prod_uncurry</span> (@<span class="id" title="var">dersrec_appJ</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> <span class="id" title="var">ds</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrec_single</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> [<span class="id" title="var">c</span>]) (<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">c</span> : <span class="id" title="var">X</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">dersrec_all</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">ForallT_single</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrec_singleD</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> := <span class="id" title="var">iffT_D1</span> (@<span class="id" title="var">dersrec_single</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrec_singleI</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> := <span class="id" title="var">iffT_D2</span> (@<span class="id" title="var">dersrec_single</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrec_map_single</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> (<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span>) <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">map</span> <span class="id" title="var">f</span> [<span class="id" title="var">c</span>])) (<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">f</span> <span class="id" title="var">c</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dersrec_single</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrec_map_2</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> (<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span>) <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">map</span> <span class="id" title="var">f</span> [<span class="id" title="var">c</span> ; <span class="id" title="var">d</span>]))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">f</span> <span class="id" title="var">c</span>) * <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">f</span> <span class="id" title="var">d</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">dersrec_all</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">ForallT_map_2</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">derrec_trans_imp</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">concl</span> : <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">revert</span> <span class="id" title="var">X0</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">derrec_all_rect</span>. <span class="id" title="tactic">tauto</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">derI</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X0</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">dersrecI_all</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X2</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derrec_rmono_s</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">W</span> (<span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> : <span class="id" title="var">rlsT</span> <span class="id" title="var">W</span>) <span class="id" title="var">prems</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">rsub</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> -&gt; <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">concl</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>) *<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">cs</span>, <span class="id" title="var">dersrec</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">dersrec</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">derrec_dersrec_rect_mut</span> ; <span class="id" title="tactic">intros</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">dpI</span>. <span class="id" title="tactic">assumption</span>.<br/>
- <span class="id" title="tactic">eapply</span> <span class="id" title="var">derI</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">rsub</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">assumption</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">dlNil</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">dlCons</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derrec_rmono</span> <span class="id" title="var">W</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> <span class="id" title="var">rs</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">fst</span> (@<span class="id" title="var">derrec_rmono_s</span> <span class="id" title="var">W</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">prems</span> <span class="id" title="var">rs</span>) <span class="id" title="var">concl</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrec_rmono</span> <span class="id" title="var">W</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">prems</span> <span class="id" title="var">rs</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">snd</span> (@<span class="id" title="var">derrec_rmono_s</span> <span class="id" title="var">W</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">prems</span> <span class="id" title="var">rs</span>).<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">derl_derrec_trans'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>,<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">rps</span> (<span class="id" title="var">concl</span> : <span class="id" title="var">X</span>), <span class="id" title="var">derl</span> <span class="id" title="var">rules</span> <span class="id" title="var">rps</span> <span class="id" title="var">concl</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">rps</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>) *<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">rps</span> <span class="id" title="var">cs</span>, <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">rps</span> <span class="id" title="var">cs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">rps</span> -&gt; <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">derl_dersl_rect_mut</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">assumption</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">derI</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">tauto</span>.<br/>
- <span class="id" title="tactic">tauto</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">dc</span> <span class="id" title="var">dsdc</span> <span class="id" title="var">dscs</span> <span class="id" title="var">dspc</span> <span class="id" title="var">dspps</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">dersrecD_all</span> <span class="id" title="tactic">in</span> <span class="id" title="var">dspps</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dlCons</span>.<br/>
+ <span class="id" title="tactic">apply</span> <span class="id" title="var">dsdc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_appendD1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">dspps</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">dersrecI_all</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">dspps</span>.<br/>
+ <span class="id" title="tactic">apply</span> <span class="id" title="var">dspc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_appendD2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">dspps</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">dersrecI_all</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">dspps</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derl_derrec_trans</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">fst</span> (@<span class="id" title="var">derl_derrec_trans'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersl_dersrec_trans</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">snd</span> (@<span class="id" title="var">derl_derrec_trans'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>).<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">derrec_derl_deriv'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>,<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> (<span class="id" title="var">concl</span> : <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">derrec</span> (<span class="id" title="var">derl</span> <span class="id" title="var">rules</span>) <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>) *<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">cs</span>, <span class="id" title="var">dersrec</span> (<span class="id" title="var">derl</span> <span class="id" title="var">rules</span>) <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">derrec_dersrec_rect_mut</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">dpI</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">derl_derrec_trans</span> <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">assumption</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">dlNil</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dlCons</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derrec_derl_deriv</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">fst</span> (@<span class="id" title="var">derrec_derl_deriv'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrec_derl_deriv</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">snd</span> (@<span class="id" title="var">derrec_derl_deriv'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derl_derrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">rps</span> (<span class="id" title="var">concl</span> : <span class="id" title="var">X</span>) <span class="id" title="var">drrc</span> <span class="id" title="var">prems_cond</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">derl_derrec_trans</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">rps</span> (<span class="id" title="var">concl</span> : <span class="id" title="var">X</span>) <span class="id" title="var">drrc</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">prems_dersrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">rps</span> <span class="id" title="var">prems_cond</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derl_derrec_nil</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">concl</span> : <span class="id" title="var">X</span>) <span class="id" title="var">drrc</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">derl_derrec_trans</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> [] (<span class="id" title="var">concl</span> : <span class="id" title="var">X</span>) <span class="id" title="var">drrc</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">dlNil</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersl_dersrec_nil</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">cs</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> [] <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">cs</span> ; <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dlNil</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">ps</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">dlCons</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">derl_derrec_nil</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">tauto</span>.<br/>
<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H0</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersl_cons</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">qs</span> <span class="id" title="var">p</span> (<span class="id" title="var">ps</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>), <br/>
&nbsp;&nbsp;<span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">qs</span> (<span class="id" title="var">p</span> :: <span class="id" title="var">ps</span>) -&gt; <span class="id" title="var">sigT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">qsa</span> =&gt; <span class="id" title="var">sigT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">qsb</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">prod</span> (<span class="id" title="var">qs</span> = <span class="id" title="var">qsa</span> ++ <span class="id" title="var">qsb</span>) (<span class="id" title="var">prod</span> (<span class="id" title="var">derl</span> <span class="id" title="var">rules</span> <span class="id" title="var">qsa</span> <span class="id" title="var">p</span>) (<span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">qsb</span> <span class="id" title="var">ps</span>)))).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">existT</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">existT</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pair</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersl_app_eq</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> (<span class="id" title="var">psa</span> <span class="id" title="var">psb</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>) <span class="id" title="var">qs</span>, <br/>
&nbsp;&nbsp;<span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">qs</span> (<span class="id" title="var">psa</span> ++ <span class="id" title="var">psb</span>) -&gt; <span class="id" title="var">sigT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">qsa</span> =&gt; <span class="id" title="var">sigT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">qsb</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">prod</span> (<span class="id" title="var">qs</span> = <span class="id" title="var">qsa</span> ++ <span class="id" title="var">qsb</span>) (<span class="id" title="var">prod</span> (<span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">qsa</span> <span class="id" title="var">psa</span>) (<span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">qsb</span> <span class="id" title="var">psb</span>)))).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">psa</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">existT</span> <span class="id" title="keyword">with</span> []. <span class="id" title="tactic">apply</span> <span class="id" title="var">existT</span> <span class="id" title="keyword">with</span> <span class="id" title="var">qs</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X0</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">pair</span>. <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">pair</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dtNil</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X0</span>.<br/>

<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dersl_cons</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X0</span>.<br/>
<span class="id" title="var">cD</span>. <span class="id" title="tactic">pose</span> (<span class="id" title="var">IHpsa</span> <span class="id" title="var">_</span> <span class="id" title="var">X4</span>). <span class="id" title="var">cD</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">existT</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">existT</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">pair</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pair</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">dtCons</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derl_trans'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> (<span class="id" title="var">rps</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>) (<span class="id" title="var">concl</span> : <span class="id" title="var">X</span>), <span class="id" title="var">derl</span> <span class="id" title="var">rules</span> <span class="id" title="var">rps</span> <span class="id" title="var">concl</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">pss</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>), <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">pss</span> <span class="id" title="var">rps</span> -&gt; <span class="id" title="var">derl</span> <span class="id" title="var">rules</span> <span class="id" title="var">pss</span> <span class="id" title="var">concl</span>) *<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> (<span class="id" title="var">rps</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>) (<span class="id" title="var">cs</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>), <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">rps</span> <span class="id" title="var">cs</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">pss</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>), <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">pss</span> <span class="id" title="var">rps</span> -&gt; <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">derl_dersl_rect_mut</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">X2</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_nil_r</span>. <span class="id" title="tactic">assumption</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">pss</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">rps</span> <span class="id" title="var">dsl</span> <span class="id" title="var">dsds</span> <span class="id" title="var">pss0</span> <span class="id" title="var">ds0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dsds</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ds0</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">dtderI</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">assumption</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">assumption</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">d</span> <span class="id" title="var">dsd</span> <span class="id" title="var">dsl</span> <span class="id" title="var">dsds</span> <span class="id" title="var">pss0</span> <span class="id" title="var">dspps</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">dersl_app_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">dspps</span>. <span class="id" title="var">cD</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dtCons</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">dsd</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dsds</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derl_trans</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">pss</span> <span class="id" title="var">rps</span> <span class="id" title="var">concl</span> <span class="id" title="var">d</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">fst</span> (@<span class="id" title="var">derl_trans'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>) <span class="id" title="var">rps</span> <span class="id" title="var">concl</span> <span class="id" title="var">d</span> <span class="id" title="var">pss</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersl_trans</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">pss</span> <span class="id" title="var">rps</span> <span class="id" title="var">cs</span> <span class="id" title="var">ds</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">snd</span> (@<span class="id" title="var">derl_trans'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>) <span class="id" title="var">rps</span> <span class="id" title="var">cs</span> <span class="id" title="var">ds</span> <span class="id" title="var">pss</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersl_trans_alt</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">cs</span> <span class="id" title="var">rps</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>), <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">rps</span> <span class="id" title="var">cs</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">pss</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>), <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">pss</span> <span class="id" title="var">rps</span> -&gt; <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">pss</span> <span class="id" title="var">cs</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">intro</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">cs</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dersl_cons</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X0</span>. <span class="id" title="var">cD</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">dersl_app_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>. <span class="id" title="var">cD</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">dtCons</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">derl_trans</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">firstorder</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">derl_dersl_deriv'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>,<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">prems</span> (<span class="id" title="var">concl</span> : <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">derl</span> (<span class="id" title="var">derl</span> <span class="id" title="var">rules</span>) <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">derl</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>) *<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dersl</span> (<span class="id" title="var">derl</span> <span class="id" title="var">rules</span>) <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">derl_dersl_rect_mut</span>.<br/>
- <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">asmI</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">derl_trans</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">assumption</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">dtNil</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dtCons</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derl_deriv'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> := <span class="id" title="var">fst</span> (@<span class="id" title="var">derl_dersl_deriv'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersl_deriv'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> := <span class="id" title="var">snd</span> (@<span class="id" title="var">derl_dersl_deriv'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derl_deriv</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> := <span class="id" title="var">rsubI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (@<span class="id" title="var">derl_deriv'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersl_deriv</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> := <span class="id" title="var">rsubI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (@<span class="id" title="var">dersl_deriv'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>).<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">derl_dersl_mono'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span>, <span class="id" title="var">rsub</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> -&gt; <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">prems</span> (<span class="id" title="var">concl</span> : <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">derl</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">derl</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>) *<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dersl</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">dersl</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">X</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">rsab</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">derl_dersl_rect_mut</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">asmI</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">dtderI</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">rsub</span> <span class="id" title="tactic">in</span> <span class="id" title="var">rsab</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">rsab</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">assumption</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">dtNil</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dtCons</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derl_mono'</span> <span class="id" title="var">X</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">rsab</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">fst</span> (@<span class="id" title="var">derl_dersl_mono'</span> <span class="id" title="var">X</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">rsab</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersl_mono'</span> <span class="id" title="var">X</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">rsab</span> := <br/>
&nbsp;&nbsp;<span class="id" title="var">snd</span> (@<span class="id" title="var">derl_dersl_mono'</span> <span class="id" title="var">X</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">rsab</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derl_mono</span> <span class="id" title="var">X</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">rsab</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">rsubI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (@<span class="id" title="var">derl_mono'</span> <span class="id" title="var">X</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">rsab</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersl_mono</span> <span class="id" title="var">X</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">rsab</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">rsubI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (@<span class="id" title="var">dersl_mono'</span> <span class="id" title="var">X</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">rsab</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derrec_nil_derl_s</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>: (<span class="id" title="keyword">forall</span> <span class="id" title="var">concl</span>, <br/>
&nbsp;&nbsp;<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">X</span>) <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">derl</span> <span class="id" title="var">rules</span> [] <span class="id" title="var">concl</span>) *<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">cs</span>, <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">X</span>) <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> [] <span class="id" title="var">cs</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">derrec_dersrec_rect_mut</span> ; <span class="id" title="tactic">intros</span>.<br/>
- <span class="id" title="tactic">inversion</span> <span class="id" title="var">p</span>.<br/>
- <span class="id" title="tactic">eapply</span> <span class="id" title="var">dtderI</span> ; <span class="id" title="var">eassumption</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">dtNil</span>.<br/>
- <span class="id" title="tactic">eapply</span> <span class="id" title="var">dtCons_eq</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derrec_nil_derl</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> := <span class="id" title="var">fst</span> (@<span class="id" title="var">derrec_nil_derl_s</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrec_nil_dersl</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> := <span class="id" title="var">snd</span> (@<span class="id" title="var">derrec_nil_derl_s</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derI_rules_mono</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> <span class="id" title="var">rs</span> <span class="id" title="var">fuv</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">derI</span> <span class="id" title="var">X</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> (@<span class="id" title="var">rsub_imp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">rules</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> <span class="id" title="var">fuv</span>).<br/>

<br/>
</div>

<div class="doc">
induction for two proof trees 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derrec_all_rect2</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> (<span class="id" title="var">rulesx</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">rulesy</span> : <span class="id" title="var">list</span> <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">Y</span> -&gt; <span class="id" title="keyword">Type</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">premsx</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">premsy</span> : <span class="id" title="var">Y</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">Q</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">px</span>, <span class="id" title="var">premsx</span> <span class="id" title="var">px</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">cy</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rulesy</span> <span class="id" title="var">premsy</span> <span class="id" title="var">cy</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">px</span> <span class="id" title="var">cy</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">py</span>, <span class="id" title="var">premsy</span> <span class="id" title="var">py</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">cx</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rulesx</span> <span class="id" title="var">premsx</span> <span class="id" title="var">cx</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">cx</span> <span class="id" title="var">py</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">psx</span> <span class="id" title="var">cx</span> <span class="id" title="var">psy</span> <span class="id" title="var">cy</span>, <span class="id" title="var">rulesx</span> <span class="id" title="var">psx</span> <span class="id" title="var">cx</span> -&gt; <span class="id" title="var">rulesy</span> <span class="id" title="var">psy</span> <span class="id" title="var">cy</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dersrec</span> <span class="id" title="var">rulesx</span> <span class="id" title="var">premsx</span> <span class="id" title="var">psx</span> -&gt; <span class="id" title="var">dersrec</span> <span class="id" title="var">rulesy</span> <span class="id" title="var">premsy</span> <span class="id" title="var">psy</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ForallT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">px</span> =&gt; <span class="id" title="var">Q</span> <span class="id" title="var">px</span> <span class="id" title="var">cy</span>) <span class="id" title="var">psx</span> -&gt; <span class="id" title="var">ForallT</span> (<span class="id" title="var">Q</span> <span class="id" title="var">cx</span>) <span class="id" title="var">psy</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">cx</span> <span class="id" title="var">cy</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">conclx</span> : <span class="id" title="var">X</span>), <span class="id" title="var">derrec</span> <span class="id" title="var">rulesx</span> <span class="id" title="var">premsx</span> <span class="id" title="var">conclx</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">concly</span> : <span class="id" title="var">Y</span>), <span class="id" title="var">derrec</span> <span class="id" title="var">rulesy</span> <span class="id" title="var">premsy</span> <span class="id" title="var">concly</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Q</span> <span class="id" title="var">conclx</span> <span class="id" title="var">concly</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> <span class="id" title="var">conclx</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">Dx</span>.<br/>
<span class="id" title="tactic">eapply</span> (<span class="id" title="var">derrec_all_rect</span> (<span class="id" title="var">Q</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">conclx</span> =&gt; <br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">concly</span> : <span class="id" title="var">Y</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rulesy</span> <span class="id" title="var">premsy</span> <span class="id" title="var">concly</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">conclx</span> <span class="id" title="var">concly</span>)).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X3</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X4</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> <span class="id" title="var">concly</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">Dy</span>.<br/>
<span class="id" title="tactic">eapply</span> (<span class="id" title="var">derrec_all_rect</span> (<span class="id" title="var">Q</span> := <span class="id" title="var">Q</span> <span class="id" title="var">concl</span>)).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X6</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">derI</span> ; <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">X2</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallT_impl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X5</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X5</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X9</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">derI</span> ; <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derrec_all_rect2_nops</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">rulesx</span> <span class="id" title="var">rulesy</span> <span class="id" title="var">Q</span> := <br/>
&nbsp;&nbsp;@<span class="id" title="var">derrec_all_rect2</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">rulesx</span> <span class="id" title="var">rulesy</span> <span class="id" title="var">emptyT</span> <span class="id" title="var">emptyT</span> <span class="id" title="var">Q</span><br/>
&nbsp;&nbsp;(@<span class="id" title="var">emptyT_any'</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span>) (@<span class="id" title="var">emptyT_any'</span> <span class="id" title="var">Y</span> <span class="id" title="var">_</span>).<br/>
</div>

<div class="doc">
admissibility 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> : <span class="id" title="keyword">Type</span> := <br/>
&nbsp;&nbsp;| <span class="id" title="var">admI</span> : (<span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">X</span>) <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">X</span>) <span class="id" title="var">c</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">admD</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> (<span class="id" title="var">a</span> : @<span class="id" title="var">adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span> | <span class="id" title="var">admI</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">d</span> <span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">admDs</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">p</span> <span class="id" title="var">c</span> <span class="id" title="var">a</span> <span class="id" title="var">d</span> := @<span class="id" title="var">admD</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> [<span class="id" title="var">p</span>] <span class="id" title="var">c</span> <span class="id" title="var">a</span> (<span class="id" title="var">dersrec_singleI</span> <span class="id" title="var">d</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derl_sub_adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> : @<span class="id" title="var">derl</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">adm</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">admI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">derl_derrec_trans</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">rsub_derl_adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> := <span class="id" title="var">rsubI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (@<span class="id" title="var">derl_sub_adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">in_adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">r</span> := <span class="id" title="var">derl_sub_adm</span> (@<span class="id" title="var">in_derl</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">r</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">rsub_adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> := <span class="id" title="var">rsubI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (@<span class="id" title="var">in_adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derrec_adm'</span> <span class="id" title="var">X</span> <span class="id" title="var">rls</span>:<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">c</span>, <span class="id" title="var">derrec</span> (<span class="id" title="var">adm</span> <span class="id" title="var">rls</span>) (@<span class="id" title="var">emptyT</span> <span class="id" title="var">X</span>) <span class="id" title="var">c</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rls</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">X</span>) <span class="id" title="var">c</span>) * <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">cs</span>, <span class="id" title="var">dersrec</span> (<span class="id" title="var">adm</span> <span class="id" title="var">rls</span>) (@<span class="id" title="var">emptyT</span> <span class="id" title="var">X</span>) <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">dersrec</span> <span class="id" title="var">rls</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">X</span>) <span class="id" title="var">cs</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">derrec_dersrec_rect_mut</span> ; <span class="id" title="tactic">intros</span>.<br/>
- <span class="id" title="tactic">inversion</span> <span class="id" title="var">p</span>.<br/>
- <span class="id" title="tactic">inversion</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X0</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">dlNil</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">dlCons</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derrec_adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rls</span> := <span class="id" title="var">fst</span> (@<span class="id" title="var">derrec_adm'</span> <span class="id" title="var">X</span> <span class="id" title="var">rls</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrec_adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rls</span> := <span class="id" title="var">snd</span> (@<span class="id" title="var">derrec_adm'</span> <span class="id" title="var">X</span> <span class="id" title="var">rls</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">adm_adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> : @<span class="id" title="var">adm</span> <span class="id" title="var">X</span> (<span class="id" title="var">adm</span> <span class="id" title="var">rules</span>) <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">adm</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">aa</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">aa</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">admI</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">dps</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">derrec_adm</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">dersrec_rmono</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">rsubI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">in_adm</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derl_adm_s</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> : <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> (<span class="id" title="var">c</span> : <span class="id" title="var">X</span>), <span class="id" title="var">derl</span> (<span class="id" title="var">adm</span> <span class="id" title="var">rules</span>) <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">adm</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>) * <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">cs</span>, <span class="id" title="var">dersl</span> (<span class="id" title="var">adm</span> <span class="id" title="var">rules</span>) <span class="id" title="var">ps</span> <span class="id" title="var">cs</span> -&gt; <span class="id" title="var">ForallT</span> (<span class="id" title="var">adm</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span>) <span class="id" title="var">cs</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">derl_dersl_rect_mut</span> ; <span class="id" title="tactic">intros</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">admI</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">assumption</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">admI</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">dpss</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">d0</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">dersrecI_forall</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">c</span> <span class="id" title="var">icp</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X0</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">d1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dpss</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">icp</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_nil</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_cons</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">admI</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>.<br/>
<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dersrec_appL</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X3</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">ixcs</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">admI</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">dsa</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dersrec_appR</span> <span class="id" title="tactic">in</span> <span class="id" title="var">dsa</span>.<br/>
<span class="id" title="tactic">exact</span> <span class="id" title="var">dsa</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">ixcs</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derl_adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> := <span class="id" title="var">fst</span> (@<span class="id" title="var">derl_adm_s</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersl_adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> := <span class="id" title="var">snd</span> (@<span class="id" title="var">derl_adm_s</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">adm_derrec_trans</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">rps</span> <span class="id" title="var">concl</span>: @<span class="id" title="var">adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">rps</span> <span class="id" title="var">concl</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">X</span>) <span class="id" title="var">rps</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">X</span>) <span class="id" title="var">concl</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">drs</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">d</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">drs</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">adm_single_trans</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">p</span> <span class="id" title="var">c</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">adm</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">p</span> -&gt; @<span class="id" title="var">adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> [<span class="id" title="var">p</span>] <span class="id" title="var">c</span> -&gt; <span class="id" title="var">adm</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="tactic">intro</span> <span class="id" title="var">dps</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">d</span> <span class="id" title="var">dps</span>). <span class="id" title="tactic">left</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derrec_eq_swap</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">T</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pf</span> : (<span class="id" title="var">G</span> : <span class="id" title="var">T</span>) = <span class="id" title="var">H</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrec_double</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> [<span class="id" title="var">c1</span>;<span class="id" title="var">c2</span>]) ((<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">c1</span> : <span class="id" title="var">X</span>)) * (<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">c2</span> : <span class="id" title="var">X</span>))).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; (<span class="id" title="tactic">eapply</span> <span class="id" title="var">dersrecD_forall</span>; [<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span> |]).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span> 1. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span> 2. <span class="id" title="tactic">constructor</span> 1. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">dersrecI_forall</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">c</span> <span class="id" title="var">Hc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hc</span> <span class="id" title="keyword">as</span> [ | ? ? <span class="id" title="var">H2</span>]; <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H2</span> <span class="id" title="keyword">as</span> [ | ? ? <span class="id" title="var">H3</span>]; <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H3</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrec_doubleD</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span> := <span class="id" title="var">iffT_D1</span> (@<span class="id" title="var">dersrec_double</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>).<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>