<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>dd_fc</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library dd_fc</h1>

<div class="code">

<br/>
</div>

<div class="doc">
results relating to derivation trees (derrec, dersrec) as data structures,
  like Isabelle dertrees, rather than purely as properties of conclusions,
  including use of derrec_fc ie without the conclusion as part of the type 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">List</span>.<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>
<span class="id" title="keyword">Export</span> <span class="id" title="var">ListNotations</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Coq.Program.Equality</span>. 
<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">genT</span> <span class="id" title="var">gen</span> <span class="id" title="var">ddT</span> <span class="id" title="var">existsT</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">PeanoNat</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Lia</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">allPder</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">rlsT</span> <span class="id" title="var">X</span>) (<span class="id" title="var">prems</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) <span class="id" title="var">P</span> : <br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">concls</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>, <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concls</span> -&gt; <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">allPder_Nil</span> : @<span class="id" title="var">allPder</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">P</span> [] (<span class="id" title="var">dlNil</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">allPder_Cons</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">seq</span> <span class="id" title="var">seqs</span> <span class="id" title="var">d</span>, <span class="id" title="var">P</span> <span class="id" title="var">seq</span> <span class="id" title="var">d</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">ds</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id" title="var">allPder</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">P</span> <span class="id" title="var">seqs</span> <span class="id" title="var">ds</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id" title="var">allPder</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">P</span> (<span class="id" title="var">seq</span> :: <span class="id" title="var">seqs</span>) (<span class="id" title="var">dlCons</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span>)<br/>
&nbsp;&nbsp;.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">allPderD</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">Q</span> <span class="id" title="var">ps</span> (<span class="id" title="var">dpss</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span>) <span class="id" title="var">p</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">allPder</span> <span class="id" title="var">Q</span> <span class="id" title="var">dpss</span> -&gt; <span class="id" title="var">InT</span> (<span class="id" title="var">p</span> : <span class="id" title="var">X</span>) <span class="id" title="var">ps</span> -&gt; {<span class="id" title="var">d</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">p</span> &amp; <span class="id" title="var">Q</span> <span class="id" title="var">p</span> <span class="id" title="var">d</span>}.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">ps</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">dpss</span> <span class="id" title="var">p</span> <span class="id" title="var">adp</span> <span class="id" title="var">inp</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">adp</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">inp</span> ; <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">exists</span> <span class="id" title="var">d</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">clear</span> <span class="id" title="var">X0</span> <span class="id" title="var">inp</span> <span class="id" title="var">adp</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">IHps</span> <span class="id" title="var">ds</span> <span class="id" title="var">p</span> <span class="id" title="var">X1</span> <span class="id" title="var">X2</span>). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">allPder_dlConsD</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">Q</span> <span class="id" title="var">seq</span> <span class="id" title="var">seqs</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span>,<br/>
&nbsp;&nbsp;@<span class="id" title="var">allPder</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">Q</span> (<span class="id" title="var">seq</span> :: <span class="id" title="var">seqs</span>) (<span class="id" title="var">dlCons</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Q</span> <span class="id" title="var">seq</span> <span class="id" title="var">d</span> * <span class="id" title="var">allPder</span> <span class="id" title="var">Q</span> <span class="id" title="var">ds</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">destruction</span> <span class="id" title="var">X0</span>.<br/>
<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">derrec_rect_mut_all</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">rlsT</span> <span class="id" title="var">X</span>) <span class="id" title="var">prems</span> <span class="id" title="var">Q</span> <span class="id" title="var">cl1</span> <span class="id" title="var">cl2</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">derrec_rect_mut</span> <span class="id" title="var">Q</span> (@<span class="id" title="var">allPder</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">Q</span>) <span class="id" title="var">cl1</span> <span class="id" title="var">cl2</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">allPder_Nil</span> <span class="id" title="var">Q</span>) (@<span class="id" title="var">allPder_Cons</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">Q</span>).<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">in_dersrec</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">rlsT</span> <span class="id" title="var">X</span>) <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">d</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>) : <br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">concls</span>, <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concls</span> -&gt; <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">in_dersrec_hd</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">concls</span> <span class="id" title="var">ds</span>, <span class="id" title="var">in_dersrec</span> <span class="id" title="var">d</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">dlCons</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> <span class="id" title="var">concls</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">in_dersrec_tl</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">concl'</span> <span class="id" title="var">d'</span> <span class="id" title="var">concls</span> <span class="id" title="var">ds</span>, <span class="id" title="var">in_dersrec</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">in_dersrec</span> <span class="id" title="var">d</span> (@<span class="id" title="var">dlCons</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl'</span> <span class="id" title="var">concls</span> <span class="id" title="var">d'</span> <span class="id" title="var">ds</span>)<br/>
&nbsp;&nbsp;.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">is_nextup</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">rlsT</span> <span class="id" title="var">X</span>) <span class="id" title="var">prems</span> (<span class="id" title="var">concl</span> : <span class="id" title="var">X</span>) (<span class="id" title="var">concls</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>)  <br/>
&nbsp;&nbsp;(<span class="id" title="var">ds</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concls</span>) : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">is_nextupI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">rps</span>, <span class="id" title="var">is_nextup</span> <span class="id" title="var">ds</span> (<span class="id" title="var">derI</span> <span class="id" title="var">concl</span> <span class="id" title="var">rps</span> <span class="id" title="var">ds</span>) <br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">in_nextup</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">rlsT</span> <span class="id" title="var">X</span>) <span class="id" title="var">prems</span> (<span class="id" title="var">concln</span> <span class="id" title="var">concl</span> : <span class="id" title="var">X</span>) <br/>
&nbsp;&nbsp;(<span class="id" title="var">dn</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concln</span>) (<span class="id" title="var">d</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>) : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">in_nextupI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">concls</span> (<span class="id" title="var">ds</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concls</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">is_nextup</span> <span class="id" title="var">ds</span> <span class="id" title="var">d</span> -&gt; <span class="id" title="var">in_dersrec</span> <span class="id" title="var">dn</span> <span class="id" title="var">ds</span> -&gt; <span class="id" title="var">in_nextup</span> <span class="id" title="var">dn</span> <span class="id" title="var">d</span><br/>
&nbsp;&nbsp;.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">in_drs_concl_in</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> (<span class="id" title="var">cn</span> : <span class="id" title="var">W</span>) (<span class="id" title="var">drs</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">emptyT</span> <span class="id" title="var">ps</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">dtn</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">emptyT</span> <span class="id" title="var">cn</span>) : <span class="id" title="var">in_dersrec</span> <span class="id" title="var">dtn</span> <span class="id" title="var">drs</span> -&gt; <span class="id" title="var">InT</span> <span class="id" title="var">cn</span> <span class="id" title="var">ps</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">ind</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">ind</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_eq</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">InT_cons</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">in_nextup_concl_in</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> (<span class="id" title="var">concl</span> <span class="id" title="var">cn</span> : <span class="id" title="var">W</span>) <span class="id" title="var">rpc</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">drs</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">emptyT</span> <span class="id" title="var">ps</span>) (<span class="id" title="var">dtn</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">emptyT</span> <span class="id" title="var">cn</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">in_nextup</span> <span class="id" title="var">dtn</span> (<span class="id" title="var">derI</span> <span class="id" title="var">concl</span> <span class="id" title="var">rpc</span> <span class="id" title="var">drs</span>) -&gt; <span class="id" title="var">InT</span> <span class="id" title="var">cn</span> <span class="id" title="var">ps</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">ind</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">ind</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">dependent</span> <span class="id" title="tactic">destruction</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">H1</span> <span class="id" title="var">rps0</span> <span class="id" title="var">ind</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="tactic">exact</span> (<span class="id" title="var">in_drs_concl_in</span> <span class="id" title="var">X0</span>). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">all_in_d_allP</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">Q</span> <span class="id" title="var">ps</span> (<span class="id" title="var">dpss</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> (<span class="id" title="var">p</span> : <span class="id" title="var">X</span>) (<span class="id" title="var">d</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">p</span>), <span class="id" title="var">in_dersrec</span> <span class="id" title="var">d</span> <span class="id" title="var">dpss</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">p</span> <span class="id" title="var">d</span>) -&gt; <br/>
&nbsp;&nbsp;<span class="id" title="var">allPder</span> <span class="id" title="var">Q</span> <span class="id" title="var">dpss</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">dpss</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">allPder_Nil</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">allPder_Cons</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">in_dersrec_hd</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">IHdpss</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">in_dersrec_tl</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">allP_all_in_d</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">Q</span> <span class="id" title="var">ps</span> (<span class="id" title="var">dpss</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">allPder</span> <span class="id" title="var">Q</span> <span class="id" title="var">dpss</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">p</span> : <span class="id" title="var">X</span>) (<span class="id" title="var">d</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">p</span>), <span class="id" title="var">in_dersrec</span> <span class="id" title="var">d</span> <span class="id" title="var">dpss</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">p</span> <span class="id" title="var">d</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">ps</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">dpss</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">dpss</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">destruction</span> <span class="id" title="var">X0</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">destruction</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHps</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">allPderD_in</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">Q</span> <span class="id" title="var">ps</span> (<span class="id" title="var">dpss</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span>) <span class="id" title="var">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">allPder</span> <span class="id" title="var">Q</span> <span class="id" title="var">dpss</span> -&gt; <span class="id" title="var">InT</span> (<span class="id" title="var">p</span> : <span class="id" title="var">X</span>) <span class="id" title="var">ps</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">d</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">p</span> &amp; <span class="id" title="var">in_dersrec</span> <span class="id" title="var">d</span> <span class="id" title="var">dpss</span> &amp; <span class="id" title="var">Q</span> <span class="id" title="var">p</span> <span class="id" title="var">d</span>}.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">ps</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">dpss</span> <span class="id" title="var">p</span> <span class="id" title="var">adp</span> <span class="id" title="var">inp</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">destruction</span> <span class="id" title="var">adp</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">inp</span> ; <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">exists</span> <span class="id" title="var">d</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">in_dersrec_hd</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">pose</span> (<span class="id" title="var">IHps</span> <span class="id" title="var">ds</span> <span class="id" title="var">p</span> <span class="id" title="var">adp</span> <span class="id" title="var">X0</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">in_dersrec_tl</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">derrec_height</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">der</span> : @<span class="id" title="var">derrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">der</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dpI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">derI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ds</span> =&gt; <span class="id" title="var">S</span> (<span class="id" title="var">dersrec_height</span> <span class="id" title="var">ds</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">dersrec_height</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concls</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">ders</span> : @<span class="id" title="var">dersrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concls</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">ders</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dlNil</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dlCons</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span> =&gt; <span class="id" title="var">max</span> (<span class="id" title="var">derrec_height</span> <span class="id" title="var">d</span>) (<span class="id" title="var">dersrec_height</span> <span class="id" title="var">ds</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Print</span> <span class="id" title="var">derI</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">derrec_size</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">der</span> : @<span class="id" title="var">derrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">der</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dpI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">derI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ds</span> =&gt; <span class="id" title="var">S</span> (<span class="id" title="var">dersrec_size</span> <span class="id" title="var">ds</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">dersrec_size</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concls</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">ders</span> : @<span class="id" title="var">dersrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concls</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">ders</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dlNil</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dlCons</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span> =&gt; (<span class="id" title="var">derrec_size</span> <span class="id" title="var">d</span>) + (<span class="id" title="var">dersrec_size</span> <span class="id" title="var">ds</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">derrec_concl</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">der</span> : @<span class="id" title="var">derrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">der</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dpI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">c</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">c</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">derI</span> <span class="id" title="var">c</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">c</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">dersrec_concls</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concls</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">ders</span> : @<span class="id" title="var">dersrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concls</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">ders</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dlNil</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dlCons</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span> =&gt; <span class="id" title="var">derrec_concl</span> <span class="id" title="var">d</span> :: <span class="id" title="var">dersrec_concls</span> <span class="id" title="var">ds</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">der_botr_ps</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">der</span> : @<span class="id" title="var">derrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">der</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dpI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| @<span class="id" title="var">derI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ps</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">ps</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">dersrec_hd</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span> <span class="id" title="var">cs</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">ders</span> : @<span class="id" title="var">dersrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">c</span> :: <span class="id" title="var">cs</span>)) {<span class="id" title="keyword">struct</span> <span class="id" title="var">ders</span>} :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">ders</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dlCons</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span> =&gt; <span class="id" title="var">d</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">dersrec_tl</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span> <span class="id" title="var">cs</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">ders</span> : @<span class="id" title="var">dersrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">c</span> :: <span class="id" title="var">cs</span>)) {<span class="id" title="keyword">struct</span> <span class="id" title="var">ders</span>} :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">ders</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dlCons</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span> =&gt; <span class="id" title="var">ds</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrec_singleD'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">ders</span> : @<span class="id" title="var">dersrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> [<span class="id" title="var">c</span>]) := <span class="id" title="var">dersrec_hd</span> <span class="id" title="var">ders</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrec_singleI'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">d</span> : @<span class="id" title="var">derrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span>) := <span class="id" title="var">dlCons</span> <span class="id" title="var">d</span> (@<span class="id" title="var">dlNil</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dersrec_single'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span> := <br/>
&nbsp;&nbsp;(@<span class="id" title="var">dersrec_singleD'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span>, @<span class="id" title="var">dersrec_singleI'</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">botr_ps_der</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span> (<span class="id" title="var">d</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span>) :<br/>
&nbsp;&nbsp;@<span class="id" title="var">dersrec</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">der_botr_ps</span> <span class="id" title="var">d</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span> ; <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dlNil</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">d</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">in_dersrec_single'</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> (<span class="id" title="var">ds</span> : @<span class="id" title="var">dersrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> [<span class="id" title="var">c</span>]) :<br/>
&nbsp;&nbsp;<span class="id" title="var">in_dersrec</span> (<span class="id" title="var">dersrec_singleD'</span> <span class="id" title="var">ds</span>) <span class="id" title="var">ds</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">destruction</span> <span class="id" title="var">ds</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">dersrec_singleD'</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">in_dersrec_hd</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrec_hd_eq</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">cs</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">d</span> : @<span class="id" title="var">derrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>) (<span class="id" title="var">ds</span> : @<span class="id" title="var">dersrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">cs</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">dersrec_hd</span> (<span class="id" title="var">dlCons</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span>) = <span class="id" title="var">d</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrec_tl_eq</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">cs</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">d</span> : @<span class="id" title="var">derrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>) (<span class="id" title="var">ds</span> : @<span class="id" title="var">dersrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">cs</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">dersrec_tl</span> (<span class="id" title="var">dlCons</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span>) = <span class="id" title="var">ds</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">in_drs_drs_hd</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">cs</span> (<span class="id" title="var">ds</span> : @<span class="id" title="var">dersrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> (<span class="id" title="var">c</span> :: <span class="id" title="var">cs</span>)) :<br/>
&nbsp;&nbsp;<span class="id" title="var">in_dersrec</span> (<span class="id" title="var">dersrec_hd</span> <span class="id" title="var">ds</span>) <span class="id" title="var">ds</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">destruction</span> <span class="id" title="var">ds</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">in_dersrec_hd</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrec_height_nil</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span> (<span class="id" title="var">ds</span> : @<span class="id" title="var">dersrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ps</span> = [] -&gt; <span class="id" title="var">dersrec_height</span> <span class="id" title="var">ds</span> = 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">ds</span>.<br/>
- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrec_height_le</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">n</span> <span class="id" title="var">ps</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">ds</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> (<span class="id" title="var">p</span> : <span class="id" title="var">X</span>) (<span class="id" title="var">d</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">p</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">in_dersrec</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span> -&gt; <span class="id" title="var">derrec_height</span> <span class="id" title="var">d</span> &lt;= <span class="id" title="var">n</span>) -&gt; <span class="id" title="var">dersrec_height</span> <span class="id" title="var">ds</span> &lt;= <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">ds</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">le_0_n</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Nat.max_lub</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">in_dersrec_hd</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">IHds</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">in_dersrec_tl</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_dersrec_height</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">n</span> <span class="id" title="var">ps</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">ds</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span>),<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">p</span> : <span class="id" title="var">X</span>) (<span class="id" title="var">d</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">p</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">in_dersrec</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span> -&gt; <span class="id" title="var">n</span> &lt;= <span class="id" title="var">derrec_height</span> <span class="id" title="var">d</span> -&gt; <span class="id" title="var">n</span> &lt;= <span class="id" title="var">dersrec_height</span> <span class="id" title="var">ds</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">X0</span> ; <span class="id" title="tactic">simpl</span> ; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.max_le_iff</span> ; <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">derl_height</span> <span class="id" title="var">X</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Prop</span>) (<span class="id" title="var">prems</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>) (<span class="id" title="var">concl</span> : <span class="id" title="var">X</span>) <br/>
&nbsp;&nbsp;(<span class="id" title="var">der</span> : @<span class="id" title="var">derl</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">der</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">asmI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dtderI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ds</span> =&gt; <span class="id" title="var">S</span> (<span class="id" title="var">dersl_height</span> <span class="id" title="var">ds</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">dersl_height</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Prop</span>) (<span class="id" title="var">prems</span> <span class="id" title="var">concls</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>) <br/>
&nbsp;&nbsp;(<span class="id" title="var">ders</span> : @<span class="id" title="var">dersl</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concls</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">ders</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dtNil</span> <span class="id" title="var">_</span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dtCons</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span> =&gt; <span class="id" title="var">max</span> (<span class="id" title="var">derl_height</span> <span class="id" title="var">d</span>) (<span class="id" title="var">dersl_height</span> <span class="id" title="var">ds</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">der_concl_eq</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">rlsT</span> <span class="id" title="var">X</span>) <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">d</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>), <span class="id" title="var">derrec_concl</span> <span class="id" title="var">d</span> = <span class="id" title="var">concl</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">d</span> ; <span class="id" title="tactic">simpl</span> ; <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ders_concls_eq</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">rlsT</span> <span class="id" title="var">X</span>) <span class="id" title="var">prems</span> <span class="id" title="var">concls</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">ds</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concls</span>), <span class="id" title="var">dersrec_concls</span> <span class="id" title="var">ds</span> = <span class="id" title="var">concls</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">ds</span> ; <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">rewrite</span> -&gt; (<span class="id" title="var">der_concl_eq</span> <span class="id" title="var">d</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHds</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
der(s)rec_fc(s) - trees without conclusion as part of the type 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">derrec_fc</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> (<span class="id" title="var">prems</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> := <br/>
&nbsp;&nbsp;| <span class="id" title="var">fcI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">concl</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">derrec_fc</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">dersrec_fcs</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> (<span class="id" title="var">prems</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> := <br/>
&nbsp;&nbsp;| <span class="id" title="var">fcsI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">concls</span>, <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concls</span> -&gt; <span class="id" title="var">dersrec_fcs</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">in_nextup_fc</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">rlsT</span> <span class="id" title="var">X</span>) <span class="id" title="var">prems</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">relationT</span> (<span class="id" title="var">derrec_fc</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">in_nextup_fcI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">concln</span> <span class="id" title="var">concl</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">dn</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concln</span>) (<span class="id" title="var">d</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">in_nextup</span> <span class="id" title="var">dn</span> <span class="id" title="var">d</span> -&gt; <span class="id" title="var">in_nextup_fc</span> (<span class="id" title="var">fcI</span> <span class="id" title="var">dn</span>) (<span class="id" title="var">fcI</span> <span class="id" title="var">d</span>)<br/>
&nbsp;&nbsp;.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">AccT_in_nextup_fc</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">dt</span>: <span class="id" title="var">AccT</span> (@<span class="id" title="var">in_nextup_fc</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) <span class="id" title="var">dt</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">dt</span>. <span class="id" title="var">revert</span> <span class="id" title="var">d</span>. <span class="id" title="var">revert</span> <span class="id" title="var">concl</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">derrec_rect_mut_all</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">AccT_intro</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">y</span> <span class="id" title="var">iny</span>.<br/>
<span class="id" title="tactic">dependent</span> <span class="id" title="tactic">destruction</span> <span class="id" title="var">iny</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>.<br/>
- <span class="id" title="tactic">intros</span> * <span class="id" title="var">apd</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">AccT_intro</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">y</span> <span class="id" title="var">iny</span>.<br/>
<span class="id" title="tactic">dependent</span> <span class="id" title="tactic">destruction</span> <span class="id" title="var">iny</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">destruction</span> <span class="id" title="var">X0</span>.<br/>
<span class="id" title="tactic">exact</span> (<span class="id" title="var">allP_all_in_d</span> <span class="id" title="var">apd</span> <span class="id" title="var">X1</span>). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">dersrec_trees</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concls</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">ders</span> : @<span class="id" title="var">dersrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concls</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">ders</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dlNil</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">dlCons</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span> =&gt; <span class="id" title="var">fcI</span> <span class="id" title="var">d</span> :: <span class="id" title="var">dersrec_trees</span> <span class="id" title="var">ds</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nextup</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">dt</span> : @<span class="id" title="var">derrec_fc</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">dt</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">fcI</span> (<span class="id" title="var">dpI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt; []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">fcI</span> (<span class="id" title="var">derI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ds</span>) =&gt; <span class="id" title="var">dersrec_trees</span> <span class="id" title="var">ds</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">derrec_fc_concl</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">der</span> : @<span class="id" title="var">derrec_fc</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">der</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">fcI</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">derrec_concl</span> <span class="id" title="var">d</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">dersrec_fc_concls</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">ders</span> : @<span class="id" title="var">dersrec_fcs</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">ders</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">fcsI</span> <span class="id" title="var">ds</span> =&gt; <span class="id" title="var">dersrec_concls</span> <span class="id" title="var">ds</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">botRule_fc</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">der</span> : @<span class="id" title="var">derrec_fc</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) : <span class="id" title="var">rlsT</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">botRule_fcI</span> : <span class="id" title="var">botRule_fc</span> <span class="id" title="var">der</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">map</span> (@<span class="id" title="var">derrec_fc_concl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) (<span class="id" title="var">nextup</span> <span class="id" title="var">der</span>)) (<span class="id" title="var">derrec_fc_concl</span> <span class="id" title="var">der</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">derrec_fc_size</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">der</span> : @<span class="id" title="var">derrec_fc</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">der</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">fcI</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">derrec_size</span> <span class="id" title="var">d</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">dersrec_fc_size</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">ders</span> : @<span class="id" title="var">dersrec_fcs</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">ders</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">fcsI</span> <span class="id" title="var">ds</span> =&gt; <span class="id" title="var">dersrec_size</span> <span class="id" title="var">ds</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">derrec_fc_height</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">der</span> : @<span class="id" title="var">derrec_fc</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">der</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">fcI</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">derrec_height</span> <span class="id" title="var">d</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">dersrec_fc_height</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">ders</span> : @<span class="id" title="var">dersrec_fcs</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">ders</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">fcsI</span> <span class="id" title="var">ds</span> =&gt; <span class="id" title="var">dersrec_height</span> <span class="id" title="var">ds</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">der_fc_concl_eq</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">rlsT</span> <span class="id" title="var">X</span>) <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">d</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>), <span class="id" title="var">derrec_fc_concl</span> (<span class="id" title="var">fcI</span> <span class="id" title="var">d</span>) = <span class="id" title="var">concl</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">der_concl_eq</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrec_trees_concls_eq</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span> (<span class="id" title="var">ds</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">map</span> (@<span class="id" title="var">derrec_fc_concl</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) (<span class="id" title="var">dersrec_trees</span> <span class="id" title="var">ds</span>) = <span class="id" title="var">ps</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">ds</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">der_concl_eq</span> <span class="id" title="var">d</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHds</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">der_botr_ps_eq</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span> (<span class="id" title="var">dt</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">map</span> (@<span class="id" title="var">derrec_fc_concl</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) (<span class="id" title="var">nextup</span> (<span class="id" title="var">fcI</span> <span class="id" title="var">dt</span>)) = <span class="id" title="var">der_botr_ps</span> <span class="id" title="var">dt</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">dt</span> ; <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dersrec_trees_concls_eq</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">der_der_fc</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">der</span> : @<span class="id" title="var">derrec_fc</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">derrec_fc_concl</span> <span class="id" title="var">der</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">der</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">der_concl_eq</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">d</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ders_ders_fcs</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">ders</span> : @<span class="id" title="var">dersrec_fcs</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">dersrec_fc_concls</span> <span class="id" title="var">ders</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">ders</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">ders_concls_eq</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">d</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">in_drs_trees</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> <span class="id" title="var">ds</span> <span class="id" title="var">c</span> (<span class="id" title="var">d</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">in_dersrec</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span> -&gt; <span class="id" title="var">InT</span> (<span class="id" title="var">fcI</span> <span class="id" title="var">d</span>) (@<span class="id" title="var">dersrec_trees</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> <span class="id" title="var">ds</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">X0</span> ; <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">InT_eq</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_cons</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">in_trees_drs</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> <span class="id" title="var">ds</span> <span class="id" title="var">c</span> (<span class="id" title="var">d</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">InT</span> (<span class="id" title="var">fcI</span> <span class="id" title="var">d</span>) (@<span class="id" title="var">dersrec_trees</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">cs</span> <span class="id" title="var">ds</span>) -&gt; <span class="id" title="var">in_dersrec</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">cs</span> ; <span class="id" title="tactic">intro</span> ; <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">ds</span> ; <span class="id" title="tactic">simpl</span> ; <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>.<br/>
<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">destruction</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">in_dersrec_hd</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">in_dersrec_tl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHcs</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">der_botRule</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> (<span class="id" title="var">dt</span> : <span class="id" title="var">derrec_fc</span> <span class="id" title="var">rules</span> <span class="id" title="var">emptyT</span>) :<br/>
&nbsp;&nbsp;{<span class="id" title="var">ps</span> : <span class="id" title="var">list</span> <span class="id" title="var">W</span> &amp; {<span class="id" title="var">c</span> : <span class="id" title="var">W</span> &amp; <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> &amp; <span class="id" title="var">botRule_fc</span> <span class="id" title="var">dt</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>}}.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">dt</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>.<br/>
<span class="id" title="tactic">exists</span> <span class="id" title="var">ps</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">concl</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">r</span>.<br/>
<span class="id" title="tactic">pose</span> <span class="id" title="var">botRule_fcI</span>.<br/>
<span class="id" title="tactic">specialize</span> (<span class="id" title="var">b</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">emptyT</span> (<span class="id" title="var">fcI</span> (<span class="id" title="var">derI</span> <span class="id" title="var">concl</span> <span class="id" title="var">r</span> <span class="id" title="var">d</span>))).<br/>
<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">b</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">dersrec_trees_concls_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">b</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">b</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">botRule_fc_concl</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span> (<span class="id" title="var">c</span> : <span class="id" title="var">W</span>) (<span class="id" title="var">dt</span> : <span class="id" title="var">derrec_fc</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">botRule_fc</span> <span class="id" title="var">dt</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">derrec_fc_concl</span> <span class="id" title="var">dt</span> = <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">br</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">br</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">botRule_fc_rules</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> (<span class="id" title="var">c</span> : <span class="id" title="var">W</span>) (<span class="id" title="var">dt</span> : <span class="id" title="var">derrec_fc</span> <span class="id" title="var">rules</span> <span class="id" title="var">emptyT</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">botRule_fc</span> <span class="id" title="var">dt</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">br</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">br</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">dt</span>.<br/>
<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">der_fc_concl_eq</span> <span class="id" title="var">d</span>).<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">dersrec_trees_concls_eq</span> <span class="id" title="var">d</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">r</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">botRule_fc_drs</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span> (<span class="id" title="var">c</span> : <span class="id" title="var">W</span>) (<span class="id" title="var">dt</span> : <span class="id" title="var">derrec_fc</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">botRule_fc</span> <span class="id" title="var">dt</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">br</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">br</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">dt</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dlNil</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">dersrec_trees_concls_eq</span> <span class="id" title="var">d</span>). <span class="id" title="tactic">exact</span> <span class="id" title="var">d</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">botRule_fc_ps</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span> (<span class="id" title="var">c</span> : <span class="id" title="var">W</span>) (<span class="id" title="var">dt</span> : <span class="id" title="var">derrec_fc</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">botRule_fc</span> <span class="id" title="var">dt</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">map</span> (@<span class="id" title="var">derrec_fc_concl</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) (<span class="id" title="var">nextup</span> <span class="id" title="var">dt</span>) = <span class="id" title="var">ps</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">br</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">br</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">dt</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">get_botrule</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">c</span> : <span class="id" title="var">W</span>) (<span class="id" title="var">dt</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">botRule_fc</span> (<span class="id" title="var">fcI</span> <span class="id" title="var">dt</span>) (<span class="id" title="var">der_botr_ps</span> <span class="id" title="var">dt</span>) <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">der_botr_ps_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">eq_rect</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">botRule_fcI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">der_fc_concl_eq</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">bot_is_rule</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> (<span class="id" title="var">c</span> : <span class="id" title="var">W</span>) (<span class="id" title="var">dt</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">emptyT</span> <span class="id" title="var">c</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">botRule_fc_rules</span> (<span class="id" title="var">get_botrule</span> <span class="id" title="var">dt</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">botRule_fc_prems</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">c</span> : <span class="id" title="var">W</span>) (<span class="id" title="var">dt</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span>) <span class="id" title="var">ps</span> <span class="id" title="var">c'</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">botRule_fc</span> (<span class="id" title="var">fcI</span> <span class="id" title="var">dt</span>) <span class="id" title="var">ps</span> <span class="id" title="var">c'</span> -&gt; (<span class="id" title="var">c</span> = <span class="id" title="var">c'</span>) * (<span class="id" title="var">der_botr_ps</span> <span class="id" title="var">dt</span> = <span class="id" title="var">ps</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">br</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">der_botr_ps_eq</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">botRule_fc_ps</span> <span class="id" title="var">br</span>).<br/>
<span class="id" title="tactic">split</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">br</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">der_fc_concl_eq</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">in_nextup_eqv</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">concln</span> <span class="id" title="var">concl</span> : <span class="id" title="var">W</span>) <br/>
&nbsp;&nbsp;(<span class="id" title="var">dtn</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concln</span>) (<span class="id" title="var">dt</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">in_nextup</span> <span class="id" title="var">dtn</span> <span class="id" title="var">dt</span>) (<span class="id" title="var">InT</span> (<span class="id" title="var">fcI</span> <span class="id" title="var">dtn</span>) (<span class="id" title="var">nextup</span> (<span class="id" title="var">fcI</span> <span class="id" title="var">dt</span>))).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pair</span> ; <span class="id" title="tactic">intros</span>.<br/>
- <span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">in_drs_trees</span> <span class="id" title="var">i0</span>).<br/>
- <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">dt</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">in_trees_drs</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">in_nextupI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">is_nextupI</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">in_nextup_nu</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concln</span> <span class="id" title="var">concl</span> <span class="id" title="var">dtn</span> <span class="id" title="var">dt</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">iffT_D1</span> (@<span class="id" title="var">in_nextup_eqv</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concln</span> <span class="id" title="var">concl</span> <span class="id" title="var">dtn</span> <span class="id" title="var">dt</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nextup_in_nu</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concln</span> <span class="id" title="var">concl</span> <span class="id" title="var">dtn</span> <span class="id" title="var">dt</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">iffT_D2</span> (@<span class="id" title="var">in_nextup_eqv</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concln</span> <span class="id" title="var">concl</span> <span class="id" title="var">dtn</span> <span class="id" title="var">dt</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">in_nextup_fc_eqv</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">dtn</span> <span class="id" title="var">dt</span> : @<span class="id" title="var">derrec_fc</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">in_nextup_fc</span> <span class="id" title="var">dtn</span> <span class="id" title="var">dt</span>) (<span class="id" title="var">InT</span> <span class="id" title="var">dtn</span> (<span class="id" title="var">nextup</span> <span class="id" title="var">dt</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pair</span> ; <span class="id" title="tactic">intros</span>.<br/>
- <span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">in_nextup_nu</span> <span class="id" title="var">i</span>).<br/>
- <span class="id" title="tactic">destruct</span> <span class="id" title="var">dtn</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">dt</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">in_nextup_fcI</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">nextup_in_nu</span> <span class="id" title="var">_</span> <span class="id" title="var">X</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">in_nextup_fc_nu</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">dtn</span> <span class="id" title="var">dt</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">iffT_D1</span> (@<span class="id" title="var">in_nextup_fc_eqv</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">dtn</span> <span class="id" title="var">dt</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nextup_in_nu_fc</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">dtn</span> <span class="id" title="var">dt</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">iffT_D2</span> (@<span class="id" title="var">in_nextup_fc_eqv</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">dtn</span> <span class="id" title="var">dt</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">is_nextup_ndt</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concls</span> (<span class="id" title="var">concl</span> : <span class="id" title="var">W</span>) <br/>
&nbsp;&nbsp;(<span class="id" title="var">dts</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concls</span>) <br/>
&nbsp;&nbsp;(<span class="id" title="var">dt</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">is_nextup</span> <span class="id" title="var">dts</span> <span class="id" title="var">dt</span> -&gt; <span class="id" title="var">nextup</span> (<span class="id" title="var">fcI</span> <span class="id" title="var">dt</span>) = <span class="id" title="var">dersrec_trees</span> <span class="id" title="var">dts</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">nextup</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">drs_trees_height</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span> (<span class="id" title="var">ds</span> : @<span class="id" title="var">dersrec</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span>) <span class="id" title="var">dn</span>: <br/>
&nbsp;&nbsp;<span class="id" title="var">InT</span> <span class="id" title="var">dn</span> (<span class="id" title="var">dersrec_trees</span> <span class="id" title="var">ds</span>) -&gt; <span class="id" title="var">derrec_fc_height</span> <span class="id" title="var">dn</span> &lt;= <span class="id" title="var">dersrec_height</span> <span class="id" title="var">ds</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">ds</span> ; <span class="id" title="tactic">simpl</span> ; <span class="id" title="tactic">intro</span> <span class="id" title="var">inn</span> ; <span class="id" title="tactic">inversion</span> <span class="id" title="var">inn</span>.<br/>
<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">PeanoNat.Nat.le_max_l</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">Le.le_trans</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">IHds</span> <span class="id" title="var">X</span>)). <span class="id" title="tactic">apply</span> <span class="id" title="var">PeanoNat.Nat.le_max_r</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nextup_height</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">dt</span> <span class="id" title="var">dn</span>: <span class="id" title="var">InT</span> <span class="id" title="var">dn</span> (<span class="id" title="var">nextup</span> <span class="id" title="var">dt</span>) -&gt;<br/>
&nbsp;&nbsp;(@<span class="id" title="var">derrec_fc_height</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">dn</span>) &lt; <span class="id" title="var">derrec_fc_height</span> <span class="id" title="var">dt</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">inn</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">dt</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span> ; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">inn</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">inn</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">Lt.le_lt_n_Sm</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">drs_trees_height</span> <span class="id" title="var">_</span> <span class="id" title="var">inn</span>)). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcI_inj</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> (<span class="id" title="var">d1</span> : @<span class="id" title="var">derrec</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>) <span class="id" title="var">d2</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">fcI</span> <span class="id" title="var">d1</span> = <span class="id" title="var">fcI</span> <span class="id" title="var">d2</span> -&gt; <span class="id" title="var">d1</span> = <span class="id" title="var">d2</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. &nbsp;&nbsp;<span class="id" title="tactic">dependent</span> <span class="id" title="tactic">destruction</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">type_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrecD_forall_in_dersrec</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">rs</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">ps</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">cs</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>) (<span class="id" title="var">ds</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">cs</span>) (<span class="id" title="var">c</span> : <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">InT</span> <span class="id" title="var">c</span> <span class="id" title="var">cs</span> -&gt; (<span class="id" title="var">existsT2</span> <span class="id" title="var">d</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rs</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">in_dersrec</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">ds</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">c</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">d</span>. <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHds</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X0</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">d2</span> <span class="id" title="var">Hin2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">d2</span>. <span class="id" title="tactic">constructor</span> 2. <span class="id" title="tactic">eapply</span> <span class="id" title="var">Hin2</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrec_double_verb</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span> (<span class="id" title="var">d</span> : (<span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> [<span class="id" title="var">c1</span>;<span class="id" title="var">c2</span>])),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">existsT2</span> (<span class="id" title="var">d1</span> : (<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">c1</span> : <span class="id" title="var">X</span>))) (<span class="id" title="var">d2</span> : (<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">c2</span> : <span class="id" title="var">X</span>))),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">in_dersrec</span> <span class="id" title="var">d1</span> <span class="id" title="var">d</span>) * (<span class="id" title="var">in_dersrec</span> <span class="id" title="var">d2</span> <span class="id" title="var">d</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">InT</span> <span class="id" title="var">c1</span> [<span class="id" title="var">c1</span>;<span class="id" title="var">c2</span>]) <span class="id" title="keyword">as</span> <span class="id" title="var">Hin1</span>. <span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">InT</span> <span class="id" title="var">c2</span> [<span class="id" title="var">c1</span>;<span class="id" title="var">c2</span>]) <span class="id" title="keyword">as</span> <span class="id" title="var">Hin2</span>. <span class="id" title="tactic">constructor</span> 2. <span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">dersrecD_forall_in_dersrec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hin1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hin1</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">d1</span> <span class="id" title="var">Hin1</span>]. <span class="id" title="tactic">exists</span> <span class="id" title="var">d1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">dersrecD_forall_in_dersrec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hin2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hin2</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">d2</span> <span class="id" title="var">Hin2</span>]. <span class="id" title="tactic">exists</span> <span class="id" title="var">d2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Hin1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Hin2</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dp</span> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>} {<span class="id" title="var">prems</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;{<span class="id" title="var">concl</span> : <span class="id" title="var">X</span>} (<span class="id" title="var">der</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span>) := @<span class="id" title="var">derrec_height</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">concl</span> <span class="id" title="var">der</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrec_derrec_height</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">D2</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> [<span class="id" title="var">G</span>]),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dersrec_height</span> <span class="id" title="var">D2</span> = <span class="id" title="var">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">existsT2</span> (<span class="id" title="var">D1</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id" title="var">derrec_height</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">D1</span> = <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <span class="id" title="var">D2</span> <span class="id" title="keyword">as</span> <span class="id" title="var">D2'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> [<span class="id" title="var">G</span>] <span class="id" title="keyword">as</span> <span class="id" title="var">GG</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">D2</span>. <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">HeqGG</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">d</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> [] <span class="id" title="keyword">as</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">D2</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">PeanoNat.Nat.max_0_r</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">discriminate</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrec_derrec2_height</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G1</span> <span class="id" title="var">G2</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">D2</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> [<span class="id" title="var">G1</span>;<span class="id" title="var">G2</span>]),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dersrec_height</span> <span class="id" title="var">D2</span> = <span class="id" title="var">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">existsT2</span> (<span class="id" title="var">D1a</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G1</span>) (<span class="id" title="var">D1b</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">n</span> = <span class="id" title="var">max</span> (@<span class="id" title="var">derrec_height</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">D1a</span>) (@<span class="id" title="var">derrec_height</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">D1b</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <span class="id" title="var">D2</span> <span class="id" title="keyword">as</span> <span class="id" title="var">D2'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> [<span class="id" title="var">G1</span>;<span class="id" title="var">G2</span>] <span class="id" title="keyword">as</span> <span class="id" title="var">GG</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">D2</span>. <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">seqs</span>. <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">seqs</span>. 2 : <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">edestruct</span> (@<span class="id" title="var">dersrec_derrec_height</span> (@<span class="id" title="var">dersrec_height</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">D2</span>)<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">D2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">HeqGG</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">d</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrec_derrec_dp</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">D2</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> [<span class="id" title="var">G</span>]),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dersrec_height</span> <span class="id" title="var">D2</span> = <span class="id" title="var">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">existsT2</span> (<span class="id" title="var">D1</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id" title="var">dp</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">D1</span> = <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">dersrec_derrec_height</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrec_derrec2_dp</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G1</span> <span class="id" title="var">G2</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">D2</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> [<span class="id" title="var">G1</span>;<span class="id" title="var">G2</span>]),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dersrec_height</span> <span class="id" title="var">D2</span> = <span class="id" title="var">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">existsT2</span> (<span class="id" title="var">D1a</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G1</span>) (<span class="id" title="var">D1b</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">n</span> = <span class="id" title="var">max</span> (@<span class="id" title="var">dp</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">D1a</span>) (@<span class="id" title="var">dp</span> <span class="id" title="var">X</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">D1b</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">dersrec_derrec2_height</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dersrec_derrec_height_le</span> : <span class="id" title="keyword">forall</span> {<span class="id" title="var">T</span> : <span class="id" title="keyword">Type</span>} <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span> <span class="id" title="var">p</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ds</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">d</span>  : <span class="id" title="var">derrec</span>  <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">p</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">in_dersrec</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">derrec_height</span> <span class="id" title="var">d</span> &lt;= @<span class="id" title="var">dersrec_height</span> <span class="id" title="var">T</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">ds</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">T</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">ps</span> <span class="id" title="var">p</span> <span class="id" title="var">ds</span> <span class="id" title="var">d</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">le_dersrec_height</span>.<br/>
&nbsp;&nbsp;2 : <span class="id" title="tactic">eapply</span> <span class="id" title="var">le_n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dp_same</span> : <span class="id" title="keyword">forall</span> {<span class="id" title="var">T</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">rules</span> <span class="id" title="var">prems</span>} (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <span class="id" title="var">list</span> <span class="id" title="var">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">D1</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">l1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Heq</span> : <span class="id" title="var">l1</span> = <span class="id" title="var">l2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dp</span> (<span class="id" title="var">eq_rect</span> <span class="id" title="var">_</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">l</span>) <span class="id" title="var">D1</span> <span class="id" title="var">l2</span> <span class="id" title="var">Heq</span>) = <span class="id" title="var">dp</span> <span class="id" title="var">D1</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">D1</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dp_same_fun</span> : <span class="id" title="keyword">forall</span> {<span class="id" title="var">T</span> <span class="id" title="var">T2</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">rules</span> <span class="id" title="var">prems</span>} (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <span class="id" title="var">list</span> <span class="id" title="var">T</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">list</span> <span class="id" title="var">T</span> -&gt; <span class="id" title="var">T2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">D1</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">f</span> <span class="id" title="var">l1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Heq</span> : <span class="id" title="var">l1</span> = <span class="id" title="var">l2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dp</span> (<span class="id" title="var">eq_rect</span> <span class="id" title="var">_</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> (<span class="id" title="var">f</span> <span class="id" title="var">l</span>)) <span class="id" title="var">D1</span> <span class="id" title="var">l2</span> <span class="id" title="var">Heq</span>) = <span class="id" title="var">dp</span> <span class="id" title="var">D1</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">D1</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derrec_dp_same</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} <span class="id" title="var">rules</span> (<span class="id" title="var">prems</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) <span class="id" title="var">G</span> <span class="id" title="var">H</span> (<span class="id" title="var">D1</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">G</span> = <span class="id" title="var">H</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">existsT2</span> (<span class="id" title="var">D2</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">H</span>), <span class="id" title="var">dp</span> <span class="id" title="var">D1</span> = <span class="id" title="var">dp</span> <span class="id" title="var">D2</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">D1</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derrec_dp_same2</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} <span class="id" title="var">rules</span> (<span class="id" title="var">prems</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) <span class="id" title="var">G</span> (<span class="id" title="var">D1</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G</span>) <span class="id" title="var">H</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">G</span> = <span class="id" title="var">H</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">existsT2</span> (<span class="id" title="var">D2</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">H</span>), <span class="id" title="var">dp</span> <span class="id" title="var">D1</span> = <span class="id" title="var">dp</span> <span class="id" title="var">D2</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">D1</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">get_D</span> {<span class="id" title="var">X</span>} <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span> <span class="id" title="var">D</span> <span class="id" title="var">pf</span> :=<br/>
(<span class="id" title="keyword">let</span> (<span class="id" title="var">D'</span>, <span class="id" title="var">HD'</span>) := (<span class="id" title="keyword">fun</span> (<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">prems</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) <br/>
&nbsp;&nbsp;(<span class="id" title="var">G</span> <span class="id" title="var">H</span> : <span class="id" title="var">X</span>) (<span class="id" title="var">D1</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G</span>) (<span class="id" title="var">H0</span> : <span class="id" title="var">G</span> = <span class="id" title="var">H</span>) =&gt;<br/>
<span class="id" title="var">eq_rect_r</span><br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">G0</span> : <span class="id" title="var">X</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">D2</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G0</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">existsT2</span> <span class="id" title="var">D3</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">H</span>, <span class="id" title="var">dp</span> <span class="id" title="var">D2</span> = <span class="id" title="var">dp</span> <span class="id" title="var">D3</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">D2</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">H</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">existT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">D3</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="var">dp</span> <span class="id" title="var">D2</span> = <span class="id" title="var">dp</span> <span class="id" title="var">D3</span>) <span class="id" title="var">D2</span> <span class="id" title="var">eq_refl</span>) <span class="id" title="var">H0</span> <span class="id" title="var">D1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span><br/>
<span class="id" title="var">G</span> <span class="id" title="var">H</span> <span class="id" title="var">D</span> <span class="id" title="var">pf</span> <span class="id" title="tactic">in</span> <span class="id" title="var">D'</span>).<br/>
<span class="id" title="keyword">Check</span> <span class="id" title="var">get_D</span>.<br/>
<span class="id" title="keyword">Print</span> <span class="id" title="var">get_D</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dp_get_D</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">prems</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">G</span> <span class="id" title="var">H</span> : <span class="id" title="var">X</span>) (<span class="id" title="var">D</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G</span>) (<span class="id" title="var">pf</span> : <span class="id" title="var">G</span> = <span class="id" title="var">H</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dp</span> <span class="id" title="var">D</span> = <span class="id" title="var">dp</span> (<span class="id" title="var">get_D</span> <span class="id" title="var">D</span> <span class="id" title="var">pf</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">get_dpD</span> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">rules</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">prems</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">G</span> <span class="id" title="var">H</span> : <span class="id" title="var">X</span>) <br/>
&nbsp;&nbsp;(<span class="id" title="var">D</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G</span>) (<span class="id" title="var">pf</span> : <span class="id" title="var">G</span> = <span class="id" title="var">H</span>) :=<br/>
&nbsp;<span class="id" title="var">EqdepFacts.internal_eq_rew_r_dep</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> (<span class="id" title="var">G0</span> : <span class="id" title="var">X</span>) (<span class="id" title="var">pf0</span> : <span class="id" title="var">G0</span> = <span class="id" title="var">H</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">D0</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">G0</span>, <span class="id" title="var">dp</span> <span class="id" title="var">D0</span> = <span class="id" title="var">dp</span> (<span class="id" title="var">get_D</span> <span class="id" title="var">D0</span> <span class="id" title="var">pf0</span>))<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">D0</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="var">eq_refl</span>) <span class="id" title="var">pf</span> <span class="id" title="var">D</span>.<br/>

<br/>
<span class="id" title="keyword">Check</span> <span class="id" title="var">get_dpD</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">tfm_dersrec_derrec_dp</span> <span class="id" title="var">D2s</span> <span class="id" title="var">D2</span> <span class="id" title="var">Hdp</span> <span class="id" title="var">HdpD2</span> <span class="id" title="var">Hdp''</span> <span class="id" title="var">Hdp'</span> :=  <br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">dersrec_derrec_dp</span> <span class="id" title="var">D2s</span> <span class="id" title="var">eq_refl</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">D2</span> <span class="id" title="var">HdpD2</span>];<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">dp</span> ?<span class="id" title="var">D1</span> + <span class="id" title="var">S</span> (<span class="id" title="var">dersrec_height</span> <span class="id" title="var">D2s</span>) &lt;= ?<span class="id" title="var">m</span> |- <span class="id" title="var">_</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">dp</span> <span class="id" title="var">D1</span> + (<span class="id" title="var">S</span> (<span class="id" title="var">dp</span> <span class="id" title="var">D2</span>)) &lt;= <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hdp''</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">rewrite</span> <span class="id" title="var">HdpD2</span>; <span class="id" title="tactic">assumption</span> | ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">dp</span> <span class="id" title="var">D1</span> + <span class="id" title="var">dp</span> <span class="id" title="var">D2</span> &lt;= <span class="id" title="var">m</span> - 1) <span class="id" title="keyword">as</span> <span class="id" title="var">Hdp'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">lia</span> | ]; <span class="id" title="tactic">clear</span> <span class="id" title="var">HdpD2</span> <span class="id" title="var">D2s</span> <span class="id" title="var">Hdp</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">tfm_dersrec_derrec2_dp</span> <span class="id" title="var">D2s</span> <span class="id" title="var">D2</span> <span class="id" title="var">Hdp</span> <span class="id" title="var">HdpD2</span> <span class="id" title="var">Hdpa''</span> <span class="id" title="var">Hdpb''</span> <span class="id" title="var">Hdpa'</span> <span class="id" title="var">Hdpb'</span> <span class="id" title="var">HeqD2s</span> <span class="id" title="var">Hmax1</span> <span class="id" title="var">Hmax2</span> :=  <br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">dersrec_height</span> <span class="id" title="var">D2s</span> = <span class="id" title="var">dersrec_height</span> <span class="id" title="var">D2s</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">HeqD2s</span>;<br/>
&nbsp;&nbsp;[<span class="id" title="tactic">reflexivity</span> |];<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">dersrec_derrec2_dp</span> <span class="id" title="var">D2s</span> <span class="id" title="var">HeqD2s</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">D2a</span> [<span class="id" title="var">D2b</span> <span class="id" title="var">HdpD2</span>]];<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">HeqD2s</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">Max.le_max_r</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hmax1</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">epose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">Max.le_max_l</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hmax2</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">HdpD2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hmax1</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">HdpD2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hmax2</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">dp</span> ?<span class="id" title="var">D1</span> + <span class="id" title="var">S</span> (<span class="id" title="var">dersrec_height</span> <span class="id" title="var">D2s</span>) &lt;= ?<span class="id" title="var">m</span> |- <span class="id" title="var">_</span> ] =&gt;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">dp</span> <span class="id" title="var">D1</span> + (<span class="id" title="var">S</span> (<span class="id" title="var">dp</span> <span class="id" title="var">D2a</span>)) &lt;= <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hdpa''</span>;<br/>
&nbsp;&nbsp;[<span class="id" title="var">lia</span> | ];<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">dp</span> <span class="id" title="var">D1</span> + (<span class="id" title="var">S</span> (<span class="id" title="var">dp</span> <span class="id" title="var">D2b</span>)) &lt;= <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hdpb''</span>;<br/>
&nbsp;&nbsp;[<span class="id" title="var">lia</span> | ];<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">dp</span> <span class="id" title="var">D1</span> + (<span class="id" title="var">dp</span> <span class="id" title="var">D2a</span>) &lt;= <span class="id" title="var">m</span> - 1) <span class="id" title="keyword">as</span> <span class="id" title="var">Hdpa'</span>;<br/>
&nbsp;&nbsp;[<span class="id" title="var">lia</span> | ];<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">dp</span> <span class="id" title="var">D1</span> + (<span class="id" title="var">dp</span> <span class="id" title="var">D2b</span>) &lt;= <span class="id" title="var">m</span> - 1) <span class="id" title="keyword">as</span> <span class="id" title="var">Hdpb'</span>;<br/>
&nbsp;&nbsp;[<span class="id" title="var">lia</span> | ];<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">HdpD2</span> <span class="id" title="var">D2s</span> <span class="id" title="var">Hdp</span> <span class="id" title="var">Hmax1</span> <span class="id" title="var">Hmax2</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>