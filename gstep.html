<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>gstep</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library gstep</h1>

<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Init.Wf</span>. 
<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Coq.Program.Equality</span>. <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">PeanoNat</span>. 
<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">gen</span> <span class="id" title="var">genT</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">ddT</span> <span class="id" title="var">dd_fc</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">rtcT</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gen_step</span> (<span class="id" title="var">seq</span> <span class="id" title="var">fml</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">P</span> <span class="id" title="var">A</span> (<span class="id" title="var">sub</span> : <span class="id" title="var">fml</span> -&gt; <span class="id" title="var">fml</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;<span class="id" title="var">derivs</span> <span class="id" title="var">ps</span> (<span class="id" title="var">concl</span> : <span class="id" title="var">seq</span>) := <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">A'</span>, <span class="id" title="var">sub</span> <span class="id" title="var">A'</span> <span class="id" title="var">A</span> -&gt; (<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">derivs</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">A'</span> <span class="id" title="var">x</span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">ForallT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">prod</span> (<span class="id" title="var">derivs</span> <span class="id" title="var">p</span>) (<span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">p</span>)) <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">derivs</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">concl</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gen_step_sub_mono</span> <span class="id" title="var">seq</span> <span class="id" title="var">fml</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub1</span> <span class="id" title="var">sub2</span> <span class="id" title="var">derivs</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">rsub</span> <span class="id" title="var">sub1</span> <span class="id" title="var">sub2</span> -&gt; <span class="id" title="var">gen_step</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub1</span> <span class="id" title="var">derivs</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt;<br/>
&nbsp;&nbsp;@<span class="id" title="var">gen_step</span> <span class="id" title="var">seq</span> <span class="id" title="var">fml</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub2</span> <span class="id" title="var">derivs</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">gen_step</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">rs</span> <span class="id" title="var">gs</span> <span class="id" title="var">saa</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">gs</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">A'</span> <span class="id" title="var">s1aa</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">saa</span> <span class="id" title="var">A'</span> (<span class="id" title="var">rsubD</span> <span class="id" title="var">rs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">s1aa</span>)). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gen_step_def</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">seq</span> <span class="id" title="var">fml</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub</span> <span class="id" title="var">derivs</span> <span class="id" title="var">ps</span> (<span class="id" title="var">concl</span> : <span class="id" title="var">seq</span>), <br/>
&nbsp;&nbsp;@<span class="id" title="var">gen_step</span> <span class="id" title="var">seq</span> <span class="id" title="var">fml</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub</span> <span class="id" title="var">derivs</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> =<br/>
&nbsp;&nbsp;((<span class="id" title="keyword">forall</span> <span class="id" title="var">A'</span>, <span class="id" title="var">sub</span> <span class="id" title="var">A'</span> <span class="id" title="var">A</span> -&gt; (<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">derivs</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">A'</span> <span class="id" title="var">x</span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">ForallT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">prod</span> (<span class="id" title="var">derivs</span> <span class="id" title="var">p</span>) (<span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">p</span>)) <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">derivs</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">concl</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">gen_step</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">gen_step'</span> (<span class="id" title="var">seq</span> <span class="id" title="var">fml</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">P</span> <span class="id" title="var">A</span> (<span class="id" title="var">sub</span> : <span class="id" title="var">fml</span> -&gt; <span class="id" title="var">fml</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;<span class="id" title="var">derivs</span> <span class="id" title="var">ps</span> (<span class="id" title="var">concl</span> : <span class="id" title="var">seq</span>) := <br/>
&nbsp;&nbsp;| <span class="id" title="var">gsI</span> : ((<span class="id" title="keyword">forall</span> <span class="id" title="var">A'</span>, <span class="id" title="var">sub</span> <span class="id" title="var">A'</span> <span class="id" title="var">A</span> -&gt; (<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">derivs</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">A'</span> <span class="id" title="var">x</span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">ForallT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">prod</span> (<span class="id" title="var">derivs</span> <span class="id" title="var">p</span>) (<span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">p</span>)) <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">derivs</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">concl</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">gen_step'</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> (<span class="id" title="var">sub</span> : <span class="id" title="var">fml</span> -&gt; <span class="id" title="var">fml</span> -&gt; <span class="id" title="keyword">Type</span>) <span class="id" title="var">derivs</span> <span class="id" title="var">ps</span> (<span class="id" title="var">concl</span> : <span class="id" title="var">seq</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gs_gs'</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">seq</span> <span class="id" title="var">fml</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">P</span> <span class="id" title="var">A</span> (<span class="id" title="var">sub</span> : <span class="id" title="var">fml</span> -&gt; <span class="id" title="var">fml</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;<span class="id" title="var">derivs</span> <span class="id" title="var">ps</span> (<span class="id" title="var">concl</span> : <span class="id" title="var">seq</span>), <br/>
&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">gen_step</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub</span> <span class="id" title="var">derivs</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span>) (<span class="id" title="var">gen_step'</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub</span> <span class="id" title="var">derivs</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">gen_step</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iffT</span>. <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">gsI</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">p</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gen_step2</span> (<span class="id" title="var">seql</span> <span class="id" title="var">seqr</span> <span class="id" title="var">fml</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">fml</span> -&gt; <span class="id" title="var">seql</span> -&gt; <span class="id" title="var">seqr</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;<span class="id" title="var">A</span> (<span class="id" title="var">sub</span> : <span class="id" title="var">fml</span> -&gt; <span class="id" title="var">fml</span> -&gt; <span class="id" title="keyword">Type</span>) <span class="id" title="var">dls</span> <span class="id" title="var">drs</span> <span class="id" title="var">psl</span> <span class="id" title="var">cl</span> <span class="id" title="var">psr</span> <span class="id" title="var">cr</span> :=<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">A'</span>, <span class="id" title="var">sub</span> <span class="id" title="var">A'</span> <span class="id" title="var">A</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">dl</span>, <span class="id" title="var">dls</span> <span class="id" title="var">dl</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">dr</span>, <span class="id" title="var">drs</span> <span class="id" title="var">dr</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">A'</span> <span class="id" title="var">dl</span> <span class="id" title="var">dr</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">ForallT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">pl</span> =&gt; <span class="id" title="var">prod</span> (<span class="id" title="var">dls</span> <span class="id" title="var">pl</span>) (<span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">pl</span> <span class="id" title="var">cr</span>)) <span class="id" title="var">psl</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" title="var">ForallT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">pr</span> =&gt; <span class="id" title="var">prod</span> (<span class="id" title="var">drs</span> <span class="id" title="var">pr</span>) (<span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">cl</span> <span class="id" title="var">pr</span>)) <span class="id" title="var">psr</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" title="var">dls</span> <span class="id" title="var">cl</span> -&gt; <span class="id" title="var">drs</span> <span class="id" title="var">cr</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">cl</span> <span class="id" title="var">cr</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gen_step2_sub_mono</span> <span class="id" title="var">seql</span> <span class="id" title="var">seqr</span> <span class="id" title="var">fml</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub1</span> <span class="id" title="var">sub2</span> <span class="id" title="var">dls</span> <span class="id" title="var">drs</span> <span class="id" title="var">psl</span> <span class="id" title="var">cl</span> <span class="id" title="var">psr</span> <span class="id" title="var">cr</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">rsub</span> <span class="id" title="var">sub1</span> <span class="id" title="var">sub2</span> -&gt; <span class="id" title="var">gen_step2</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub1</span> <span class="id" title="var">dls</span> <span class="id" title="var">drs</span> <span class="id" title="var">psl</span> <span class="id" title="var">cl</span> <span class="id" title="var">psr</span> <span class="id" title="var">cr</span> -&gt;<br/>
&nbsp;&nbsp;@<span class="id" title="var">gen_step2</span> <span class="id" title="var">seql</span> <span class="id" title="var">seqr</span> <span class="id" title="var">fml</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub2</span> <span class="id" title="var">dls</span> <span class="id" title="var">drs</span> <span class="id" title="var">psl</span> <span class="id" title="var">cl</span> <span class="id" title="var">psr</span> <span class="id" title="var">cr</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">gen_step2</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">rs</span> <span class="id" title="var">gs</span> <span class="id" title="var">saa</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">gs</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">A'</span> <span class="id" title="var">s1aa</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">saa</span> <span class="id" title="var">A'</span> (<span class="id" title="var">rsubD</span> <span class="id" title="var">rs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">s1aa</span>)). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gen_step2_empty</span> <span class="id" title="var">seql</span> <span class="id" title="var">seqr</span> <span class="id" title="var">fml</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub</span> <span class="id" title="var">dls</span> <span class="id" title="var">drs</span> <span class="id" title="var">psl</span> <span class="id" title="var">cl</span> <span class="id" title="var">psr</span> <span class="id" title="var">cr</span> :=<br/>
&nbsp;&nbsp;(@<span class="id" title="var">gen_step2_sub_mono</span> <span class="id" title="var">seql</span> <span class="id" title="var">seqr</span> <span class="id" title="var">fml</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">_</span> <span class="id" title="var">sub</span> <span class="id" title="var">dls</span> <span class="id" title="var">drs</span> <span class="id" title="var">psl</span> <span class="id" title="var">cl</span> <span class="id" title="var">psr</span> <span class="id" title="var">cr</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">rsub_emptyT</span> <span class="id" title="var">sub</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gen_step_lem_psT</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">sty</span> <span class="id" title="var">fty</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">fty</span> -&gt; <span class="id" title="var">sty</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;<span class="id" title="var">A</span> <span class="id" title="var">sub</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>, <span class="id" title="var">AccT</span> <span class="id" title="var">sub</span> <span class="id" title="var">A</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">gen_step</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub</span> (<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) <span class="id" title="var">ps</span> <span class="id" title="var">concl</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">prem</span>, <span class="id" title="var">prems</span> <span class="id" title="var">prem</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">prem</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">seq</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">seq</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">seq</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intros</span> <span class="id" title="var">acc</span> <span class="id" title="var">gs</span> <span class="id" title="var">prs</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">acc</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">derrec_all_rect</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">prs</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">gen_step</span> <span class="id" title="tactic">in</span> <span class="id" title="var">gs</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">gs</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">dersrecD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X2</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X2</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X4</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X3</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X3</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X4</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">derI</span> ; <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X0</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gen_step_lem_ps</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">sty</span> <span class="id" title="var">fty</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">fty</span> -&gt; <span class="id" title="var">sty</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;<span class="id" title="var">A</span> <span class="id" title="var">sub</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>, <span class="id" title="var">Acc</span> <span class="id" title="var">sub</span> <span class="id" title="var">A</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">gen_step</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub</span> (<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) <span class="id" title="var">ps</span> <span class="id" title="var">concl</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">prem</span>, <span class="id" title="var">prems</span> <span class="id" title="var">prem</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">prem</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">seq</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">seq</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">seq</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intros</span> <span class="id" title="var">acc</span> <span class="id" title="var">gs</span> <span class="id" title="var">prs</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">acc</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">derrec_all_rect</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">prs</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">gen_step</span> <span class="id" title="tactic">in</span> <span class="id" title="var">gs</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">gs</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">dersrecD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X2</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X2</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X4</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X3</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X3</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X4</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">derI</span> ; <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X0</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Check</span> <span class="id" title="var">gen_step_lem_ps</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gen_step_lem</span> <span class="id" title="var">sty</span> <span class="id" title="var">fty</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub</span> <span class="id" title="var">rules</span> <span class="id" title="var">acc</span> <span class="id" title="var">gs</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">gen_step_lem_ps</span> <span class="id" title="var">sty</span> <span class="id" title="var">fty</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">sty</span>) <span class="id" title="var">acc</span> <span class="id" title="var">gs</span> <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">A0</span> =&gt; @<span class="id" title="var">emptyT_any'</span> <span class="id" title="var">sty</span> (<span class="id" title="var">P</span> <span class="id" title="var">A0</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gen_step_lemT</span> <span class="id" title="var">sty</span> <span class="id" title="var">fty</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub</span> <span class="id" title="var">rules</span> <span class="id" title="var">acc</span> <span class="id" title="var">gs</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">gen_step_lem_psT</span> <span class="id" title="var">sty</span> <span class="id" title="var">fty</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">sty</span>) <span class="id" title="var">acc</span> <span class="id" title="var">gs</span> <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">A0</span> =&gt; @<span class="id" title="var">emptyT_any'</span> <span class="id" title="var">sty</span> (<span class="id" title="var">P</span> <span class="id" title="var">A0</span>)).<br/>

<br/>
<span class="id" title="keyword">Check</span> <span class="id" title="var">gen_step_lem</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gen_step2_lem_ps</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">stya</span> <span class="id" title="var">styb</span> <span class="id" title="var">fty</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">P</span> (<span class="id" title="var">A</span> : <span class="id" title="var">fty</span>) <span class="id" title="var">sub</span><br/>
&nbsp;&nbsp;<span class="id" title="var">rlsa</span> <span class="id" title="var">rlsb</span> (<span class="id" title="var">premsa</span> : <span class="id" title="var">stya</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">premsb</span> : <span class="id" title="var">styb</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">Acc</span> <span class="id" title="var">sub</span> <span class="id" title="var">A</span> -&gt; (<span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">psa</span> <span class="id" title="var">psb</span> <span class="id" title="var">ca</span> <span class="id" title="var">cb</span>, <span class="id" title="var">rlsa</span> <span class="id" title="var">psa</span> <span class="id" title="var">ca</span> -&gt; <span class="id" title="var">rlsb</span> <span class="id" title="var">psb</span> <span class="id" title="var">cb</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" title="var">gen_step2</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub</span> (<span class="id" title="var">derrec</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">premsa</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">derrec</span> <span class="id" title="var">rlsb</span> <span class="id" title="var">premsb</span>) <span class="id" title="var">psa</span> <span class="id" title="var">ca</span> <span class="id" title="var">psb</span> <span class="id" title="var">cb</span>) -&gt; <br/>
&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">pa</span>, <span class="id" title="var">premsa</span> <span class="id" title="var">pa</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">cb</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rlsb</span> <span class="id" title="var">premsb</span> <span class="id" title="var">cb</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">pa</span> <span class="id" title="var">cb</span>) -&gt; <br/>
&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">pb</span>, <span class="id" title="var">premsb</span> <span class="id" title="var">pb</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">ca</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">premsa</span> <span class="id" title="var">ca</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">ca</span> <span class="id" title="var">pb</span>) -&gt; <br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">seqa</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">premsa</span> <span class="id" title="var">seqa</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">seqb</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rlsb</span> <span class="id" title="var">premsb</span> <span class="id" title="var">seqb</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">seqa</span> <span class="id" title="var">seqb</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intros</span> <span class="id" title="var">acc</span> <span class="id" title="var">gs</span> <span class="id" title="var">prsa</span> <span class="id" title="var">prsb</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">acc</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">derrec_all_rect2</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">prsa</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">prsb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">gen_step2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">gs</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">gs</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">dersrecD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X2</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X2</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X6</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X4</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X4</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X6</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">dersrecD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X3</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X3</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X6</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X5</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X5</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X6</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">derI</span> ; <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">derI</span> ; <span class="id" title="var">eassumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gen_step2_lem_psT</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">stya</span> <span class="id" title="var">styb</span> <span class="id" title="var">fty</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">P</span> (<span class="id" title="var">A</span> : <span class="id" title="var">fty</span>) <span class="id" title="var">sub</span><br/>
&nbsp;&nbsp;<span class="id" title="var">rlsa</span> <span class="id" title="var">rlsb</span> (<span class="id" title="var">premsa</span> : <span class="id" title="var">stya</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">premsb</span> : <span class="id" title="var">styb</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">AccT</span> <span class="id" title="var">sub</span> <span class="id" title="var">A</span> -&gt; (<span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">psa</span> <span class="id" title="var">psb</span> <span class="id" title="var">ca</span> <span class="id" title="var">cb</span>, <span class="id" title="var">rlsa</span> <span class="id" title="var">psa</span> <span class="id" title="var">ca</span> -&gt; <span class="id" title="var">rlsb</span> <span class="id" title="var">psb</span> <span class="id" title="var">cb</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" title="var">gen_step2</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub</span> (<span class="id" title="var">derrec</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">premsa</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">derrec</span> <span class="id" title="var">rlsb</span> <span class="id" title="var">premsb</span>) <span class="id" title="var">psa</span> <span class="id" title="var">ca</span> <span class="id" title="var">psb</span> <span class="id" title="var">cb</span>) -&gt; <br/>
&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">pa</span>, <span class="id" title="var">premsa</span> <span class="id" title="var">pa</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">cb</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rlsb</span> <span class="id" title="var">premsb</span> <span class="id" title="var">cb</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">pa</span> <span class="id" title="var">cb</span>) -&gt; <br/>
&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">pb</span>, <span class="id" title="var">premsb</span> <span class="id" title="var">pb</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">ca</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">premsa</span> <span class="id" title="var">ca</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">ca</span> <span class="id" title="var">pb</span>) -&gt; <br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">seqa</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">premsa</span> <span class="id" title="var">seqa</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">seqb</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rlsb</span> <span class="id" title="var">premsb</span> <span class="id" title="var">seqb</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">seqa</span> <span class="id" title="var">seqb</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intros</span> <span class="id" title="var">acc</span> <span class="id" title="var">gs</span> <span class="id" title="var">prsa</span> <span class="id" title="var">prsb</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">acc</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">derrec_all_rect2</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">prsa</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">prsb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">gen_step2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">gs</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">gs</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">dersrecD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X2</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X2</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X6</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X4</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X4</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X6</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">dersrecD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X3</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X3</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X6</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X5</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X5</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X6</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">derI</span> ; <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">derI</span> ; <span class="id" title="var">eassumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Check</span> <span class="id" title="var">gen_step2_lem_ps</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gen_step2_lem</span> <span class="id" title="var">stya</span> <span class="id" title="var">styb</span> <span class="id" title="var">fty</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">rlsb</span> <span class="id" title="var">acc</span> <span class="id" title="var">gs</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">gen_step2_lem_ps</span> <span class="id" title="var">stya</span> <span class="id" title="var">styb</span> <span class="id" title="var">fty</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">rlsb</span> <br/>
&nbsp;&nbsp;(@<span class="id" title="var">emptyT</span> <span class="id" title="var">stya</span>) (@<span class="id" title="var">emptyT</span> <span class="id" title="var">styb</span>) <span class="id" title="var">acc</span> <span class="id" title="var">gs</span><br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; @<span class="id" title="var">emptyT_any'</span> <span class="id" title="var">stya</span> <span class="id" title="var">_</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; @<span class="id" title="var">emptyT_any'</span> <span class="id" title="var">styb</span> <span class="id" title="var">_</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gen_step2_lemT</span> <span class="id" title="var">stya</span> <span class="id" title="var">styb</span> <span class="id" title="var">fty</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">rlsb</span> <span class="id" title="var">acc</span> <span class="id" title="var">gs</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">gen_step2_lem_psT</span> <span class="id" title="var">stya</span> <span class="id" title="var">styb</span> <span class="id" title="var">fty</span> <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">sub</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">rlsb</span> <br/>
&nbsp;&nbsp;(@<span class="id" title="var">emptyT</span> <span class="id" title="var">stya</span>) (@<span class="id" title="var">emptyT</span> <span class="id" title="var">styb</span>) <span class="id" title="var">acc</span> <span class="id" title="var">gs</span><br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; @<span class="id" title="var">emptyT_any'</span> <span class="id" title="var">stya</span> <span class="id" title="var">_</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; @<span class="id" title="var">emptyT_any'</span> <span class="id" title="var">styb</span> <span class="id" title="var">_</span>).<br/>

<br/>
<span class="id" title="keyword">Check</span> <span class="id" title="var">gen_step2_lem</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gen_steps</span> (<span class="id" title="var">seq</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">P</span> <span class="id" title="var">derivs</span> <span class="id" title="var">ps</span> (<span class="id" title="var">concl</span> : <span class="id" title="var">seq</span>) := <br/>
&nbsp;&nbsp;<span class="id" title="var">ForallT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">prod</span> (<span class="id" title="var">derivs</span> <span class="id" title="var">p</span>) (<span class="id" title="var">P</span> <span class="id" title="var">p</span>)) <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">derivs</span> <span class="id" title="var">concl</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">concl</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gen_step2s</span> (<span class="id" title="var">seql</span> <span class="id" title="var">seqr</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">seql</span> -&gt; <span class="id" title="var">seqr</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;<span class="id" title="var">dls</span> <span class="id" title="var">drs</span> <span class="id" title="var">psl</span> <span class="id" title="var">cl</span> <span class="id" title="var">psr</span> <span class="id" title="var">cr</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">ForallT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">pl</span> =&gt; <span class="id" title="var">prod</span> (<span class="id" title="var">dls</span> <span class="id" title="var">pl</span>) (<span class="id" title="var">P</span> <span class="id" title="var">pl</span> <span class="id" title="var">cr</span>)) <span class="id" title="var">psl</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" title="var">ForallT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">pr</span> =&gt; <span class="id" title="var">prod</span> (<span class="id" title="var">drs</span> <span class="id" title="var">pr</span>) (<span class="id" title="var">P</span> <span class="id" title="var">cl</span> <span class="id" title="var">pr</span>)) <span class="id" title="var">psr</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" title="var">dls</span> <span class="id" title="var">cl</span> -&gt; <span class="id" title="var">drs</span> <span class="id" title="var">cr</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">cl</span> <span class="id" title="var">cr</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gen_steps_lem_ps</span> (<span class="id" title="var">sty</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">sty</span> -&gt; <span class="id" title="keyword">Type</span>) <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">gen_steps</span> <span class="id" title="var">P</span> (<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span>) <span class="id" title="var">ps</span> <span class="id" title="var">concl</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">prem</span>, <span class="id" title="var">prems</span> <span class="id" title="var">prem</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">prem</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">seq</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">seq</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">seq</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intros</span> <span class="id" title="var">gs</span> <span class="id" title="var">prs</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">derrec_all_rect</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">prs</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">gen_steps</span> <span class="id" title="tactic">in</span> <span class="id" title="var">gs</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">gs</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X0</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">dersrecD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span> ; <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X2</span> ; <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">derI</span> ; <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gen_steps_lem</span> <span class="id" title="var">sty</span> <span class="id" title="var">P</span> <span class="id" title="var">rules</span> <span class="id" title="var">gs</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">gen_steps_lem_ps</span> <span class="id" title="var">sty</span> <span class="id" title="var">P</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">sty</span>) <span class="id" title="var">gs</span> (@<span class="id" title="var">emptyT_any'</span> <span class="id" title="var">sty</span> <span class="id" title="var">P</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gen_step2s_lem_ps</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">stya</span> <span class="id" title="var">styb</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">P</span><br/>
&nbsp;&nbsp;<span class="id" title="var">rlsa</span> <span class="id" title="var">rlsb</span> (<span class="id" title="var">premsa</span> : <span class="id" title="var">stya</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">premsb</span> : <span class="id" title="var">styb</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">psa</span> <span class="id" title="var">psb</span> <span class="id" title="var">ca</span> <span class="id" title="var">cb</span>, <span class="id" title="var">rlsa</span> <span class="id" title="var">psa</span> <span class="id" title="var">ca</span> -&gt; <span class="id" title="var">rlsb</span> <span class="id" title="var">psb</span> <span class="id" title="var">cb</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" title="var">gen_step2s</span> <span class="id" title="var">P</span> (<span class="id" title="var">derrec</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">premsa</span>) (<span class="id" title="var">derrec</span> <span class="id" title="var">rlsb</span> <span class="id" title="var">premsb</span>) <span class="id" title="var">psa</span> <span class="id" title="var">ca</span> <span class="id" title="var">psb</span> <span class="id" title="var">cb</span>) -&gt; <br/>
&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">pa</span>, <span class="id" title="var">premsa</span> <span class="id" title="var">pa</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">cb</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rlsb</span> <span class="id" title="var">premsb</span> <span class="id" title="var">cb</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">pa</span> <span class="id" title="var">cb</span>) -&gt; <br/>
&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">pb</span>, <span class="id" title="var">premsb</span> <span class="id" title="var">pb</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">ca</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">premsa</span> <span class="id" title="var">ca</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">ca</span> <span class="id" title="var">pb</span>) -&gt; <br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">seqa</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">premsa</span> <span class="id" title="var">seqa</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">seqb</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rlsb</span> <span class="id" title="var">premsb</span> <span class="id" title="var">seqb</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">seqa</span> <span class="id" title="var">seqb</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intros</span> <span class="id" title="var">gs</span> <span class="id" title="var">prsa</span> <span class="id" title="var">prsb</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">derrec_all_rect2</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">px</span> <span class="id" title="var">ppx</span> <span class="id" title="var">cy</span> <span class="id" title="var">db</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">prsa</span> <span class="id" title="tactic">in</span> <span class="id" title="var">db</span> ; <span class="id" title="var">eassumption</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">py</span> <span class="id" title="var">ppy</span> <span class="id" title="var">cx</span> <span class="id" title="var">da</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">prsb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">da</span> ; <span class="id" title="var">eassumption</span>.<br/>
- <span class="id" title="tactic">intros</span> *. <span class="id" title="tactic">intros</span> <span class="id" title="var">ra</span> <span class="id" title="var">rb</span> <span class="id" title="var">da</span> <span class="id" title="var">db</span> <span class="id" title="var">fx</span> <span class="id" title="var">fy</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">gen_step2s</span> <span class="id" title="tactic">in</span> <span class="id" title="var">gs</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">gs</span>.<br/>
+ <span class="id" title="tactic">exact</span> <span class="id" title="var">ra</span>. + <span class="id" title="tactic">exact</span> <span class="id" title="var">rb</span>.<br/>
+ <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">inx</span>. <span class="id" title="tactic">split</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">dersrecD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">da</span> ; <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">fx</span> ; <span class="id" title="var">eassumption</span>.<br/>
+ <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">y</span> <span class="id" title="var">iny</span>. <span class="id" title="tactic">split</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">dersrecD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">db</span> ; <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">fy</span> ; <span class="id" title="var">eassumption</span>.<br/>
+ <span class="id" title="tactic">eapply</span> <span class="id" title="var">derI</span> ; <span class="id" title="var">eassumption</span>.<br/>
+ <span class="id" title="tactic">eapply</span> <span class="id" title="var">derI</span> ; <span class="id" title="var">eassumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gen_step2s_lem</span> <span class="id" title="var">stya</span> <span class="id" title="var">styb</span> <span class="id" title="var">P</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">rlsb</span> <span class="id" title="var">gs</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">gen_step2s_lem_ps</span> <span class="id" title="var">stya</span> <span class="id" title="var">styb</span> <span class="id" title="var">P</span> <span class="id" title="var">rlsa</span> <span class="id" title="var">rlsb</span> <br/>
&nbsp;&nbsp;(@<span class="id" title="var">emptyT</span> <span class="id" title="var">stya</span>) (@<span class="id" title="var">emptyT</span> <span class="id" title="var">styb</span>) <span class="id" title="var">gs</span><br/>
&nbsp;&nbsp;(@<span class="id" title="var">emptyT_any'</span> <span class="id" title="var">stya</span> <span class="id" title="var">_</span>) (@<span class="id" title="var">emptyT_any'</span> <span class="id" title="var">styb</span> <span class="id" title="var">_</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gen_step_lem'</span> <span class="id" title="var">sty</span> <span class="id" title="var">fty</span> <span class="id" title="var">P</span> (<span class="id" title="var">A</span> : <span class="id" title="var">fty</span>) <span class="id" title="var">sub</span> <span class="id" title="var">rules</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">AccT</span> <span class="id" title="var">sub</span> <span class="id" title="var">A</span> -&gt; (<span class="id" title="keyword">forall</span> <span class="id" title="var">A0</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">gen_step</span> <span class="id" title="var">P</span> <span class="id" title="var">A0</span> <span class="id" title="var">sub</span> (<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (<span class="id" title="var">emptyT</span> (<span class="id" title="var">X</span>:=<span class="id" title="var">sty</span>))) <span class="id" title="var">ps</span> <span class="id" title="var">concl</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">seq</span> : <span class="id" title="var">sty</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (<span class="id" title="var">emptyT</span> (<span class="id" title="var">X</span>:=<span class="id" title="var">sty</span>)) <span class="id" title="var">seq</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">A</span> <span class="id" title="var">seq</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">acc</span> <span class="id" title="var">gs</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">acc</span>.<br/>
<span class="id" title="var">remember</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">s</span> =&gt; (<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>, <span class="id" title="var">sub</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">seq</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (<span class="id" title="var">emptyT</span> (<span class="id" title="var">X</span>:=<span class="id" title="var">sty</span>)) <span class="id" title="var">seq</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">y</span> <span class="id" title="var">seq</span>) -&gt; <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Q</span>.<br/>
<span class="id" title="tactic">pose</span> (@<span class="id" title="var">gen_steps_lem</span> <span class="id" title="var">sty</span> <span class="id" title="var">Q</span>).<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">HeqQ</span> <span class="id" title="tactic">in</span> <span class="id" title="var">q</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">seq</span> <span class="id" title="var">ds</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">q</span>. 2: <span class="id" title="tactic">apply</span> <span class="id" title="var">ds</span>.<br/>
<span class="id" title="var">all</span>: <span class="id" title="var">cycle</span> 1. <span class="id" title="tactic">intros</span> <span class="id" title="var">y</span> <span class="id" title="var">syx</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">syx</span>.<br/>
<span class="id" title="tactic">clear</span> <span class="id" title="var">q</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> <span class="id" title="var">rpc</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">gs</span> <span class="id" title="tactic">in</span> <span class="id" title="var">rpc</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">gen_step</span> <span class="id" title="tactic">in</span> <span class="id" title="var">rpc</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">gen_steps</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">ft</span> <span class="id" title="var">drc</span> <span class="id" title="var">sp</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">rpc</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">sp</span>. 2: <span class="id" title="tactic">exact</span> <span class="id" title="var">drc</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x0</span> <span class="id" title="var">inxp</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ft</span>. 2: <span class="id" title="tactic">apply</span> <span class="id" title="var">inxp</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">split</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">ft</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ft0</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">sp</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>

<br/>
<span class="id" title="keyword">Unset</span> <span class="id" title="var">Universe</span> <span class="id" title="var">Polymorphism</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">can_trf_rules</span> (<span class="id" title="var">sty</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">R</span> <span class="id" title="var">rules</span> (<span class="id" title="var">ps</span> : <span class="id" title="var">list</span> <span class="id" title="var">sty</span>) (<span class="id" title="var">c</span> : <span class="id" title="var">sty</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">c'</span> : <span class="id" title="var">sty</span>, <span class="id" title="var">R</span> <span class="id" title="var">c</span> <span class="id" title="var">c'</span> -&gt; <br/>
&nbsp;&nbsp;(<span class="id" title="var">sigT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ps'</span> : <span class="id" title="var">list</span> <span class="id" title="var">sty</span> =&gt; <span class="id" title="var">prod</span> (<span class="id" title="var">rules</span> <span class="id" title="var">ps'</span> <span class="id" title="var">c'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ForallT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">p'</span> =&gt; <span class="id" title="var">sigT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">prod</span> (<span class="id" title="var">InT</span> <span class="id" title="var">p</span> <span class="id" title="var">ps</span>) (<span class="id" title="var">R</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span>))) <span class="id" title="var">ps'</span>))).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">can_trf_rules_rc</span> (<span class="id" title="var">sty</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">R</span> <span class="id" title="var">rules</span> (<span class="id" title="var">ps</span> : <span class="id" title="var">list</span> <span class="id" title="var">sty</span>) (<span class="id" title="var">c</span> : <span class="id" title="var">sty</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">c'</span> : <span class="id" title="var">sty</span>, <span class="id" title="var">R</span> <span class="id" title="var">c</span> <span class="id" title="var">c'</span> -&gt; <br/>
&nbsp;&nbsp;(<span class="id" title="var">sigT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ps'</span> : <span class="id" title="var">list</span> <span class="id" title="var">sty</span> =&gt; <span class="id" title="var">prod</span> (<span class="id" title="var">rules</span> <span class="id" title="var">ps'</span> <span class="id" title="var">c'</span>) (<span class="id" title="var">ForallT</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">p'</span> =&gt; <span class="id" title="var">sigT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">prod</span> (<span class="id" title="var">InT</span> <span class="id" title="var">p</span> <span class="id" title="var">ps</span>) (<span class="id" title="var">clos_reflT</span> <span class="id" title="var">R</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span>))) <span class="id" title="var">ps'</span>))).<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">can_trf_rules_imp_rc</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>:<br/>
&nbsp;&nbsp;@<span class="id" title="var">can_trf_rules</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; @<span class="id" title="var">can_trf_rules_rc</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules_rc</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X0</span>. <span class="id" title="var">cD</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X2</span>. 2: <span class="id" title="var">eassumption</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">exists</span> <span class="id" title="var">X2</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">rT_step</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">can_trf_rules_mono'</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">rsub</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> (<span class="id" title="var">c</span> : <span class="id" title="var">sty</span>), <br/>
&nbsp;&nbsp;<span class="id" title="var">can_trf_rules</span> <span class="id" title="var">R</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">can_trf_rules</span> <span class="id" title="var">R</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">X0</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">rsub</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X2</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">can_trf_rules_rc_mono'</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">rsub</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> (<span class="id" title="var">c</span> : <span class="id" title="var">sty</span>), <br/>
&nbsp;&nbsp;<span class="id" title="var">can_trf_rules_rc</span> <span class="id" title="var">R</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">can_trf_rules_rc</span> <span class="id" title="var">R</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules_rc</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">X0</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">rsub</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X2</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">can_trf_rules_mono</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">r</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">rsubI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (@<span class="id" title="var">can_trf_rules_mono'</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">r</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">can_trf_rules_rc_mono</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">r</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">rsubI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (@<span class="id" title="var">can_trf_rules_rc_mono'</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">r</span>).<br/>

<br/>
<span class="id" title="var">Polymorphic</span> <span class="id" title="keyword">Inductive</span> <span class="id" title="var">runion</span> <span class="id" title="var">U</span> <span class="id" title="var">V</span> <span class="id" title="var">ra</span> <span class="id" title="var">rb</span> (<span class="id" title="var">ps</span> : <span class="id" title="var">U</span>) (<span class="id" title="var">c</span> : <span class="id" title="var">V</span>) : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">run_l</span> : <span class="id" title="var">ra</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; @<span class="id" title="var">runion</span> <span class="id" title="var">U</span> <span class="id" title="var">V</span> <span class="id" title="var">ra</span> <span class="id" title="var">rb</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">run_r</span> : <span class="id" title="var">rb</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; @<span class="id" title="var">runion</span> <span class="id" title="var">U</span> <span class="id" title="var">V</span> <span class="id" title="var">ra</span> <span class="id" title="var">rb</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>

<br/>
<span class="id" title="var">Polymorphic</span> <span class="id" title="keyword">Inductive</span> <span class="id" title="var">rUnion</span> <span class="id" title="var">U</span> <span class="id" title="var">V</span> <span class="id" title="var">rr</span> (<span class="id" title="var">ps</span> : <span class="id" title="var">U</span>) (<span class="id" title="var">c</span> : <span class="id" title="var">V</span>) : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">rUnI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">r</span>, <span class="id" title="var">rr</span> <span class="id" title="var">r</span> -&gt; <span class="id" title="var">r</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; @<span class="id" title="var">rUnion</span> <span class="id" title="var">U</span> <span class="id" title="var">V</span> <span class="id" title="var">rr</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">can_trf_rules_un</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">R'</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> (<span class="id" title="var">c</span> : <span class="id" title="var">sty</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">can_trf_rules</span> <span class="id" title="var">R</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">can_trf_rules</span> <span class="id" title="var">R'</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">can_trf_rules</span> (<span class="id" title="var">runion</span> <span class="id" title="var">R</span> <span class="id" title="var">R'</span>) <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>. <span class="id" title="var">cD</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">r1</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">exists</span> <span class="id" title="var">r1</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">run_l</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">X0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>. <span class="id" title="var">cD</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">r1</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">exists</span> <span class="id" title="var">r1</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">run_r</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">can_trf_rules_Un</span> <span class="id" title="var">sty</span> <span class="id" title="var">rr</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> (<span class="id" title="var">c</span> : <span class="id" title="var">sty</span>):<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">r</span>, <span class="id" title="var">rr</span> <span class="id" title="var">r</span> -&gt; <span class="id" title="var">can_trf_rules</span> <span class="id" title="var">r</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">can_trf_rules</span> (<span class="id" title="var">rUnion</span> <span class="id" title="var">rr</span>) <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X0</span>.<br/>
<span class="id" title="tactic">pose</span> (<span class="id" title="var">X</span> <span class="id" title="var">r</span> <span class="id" title="var">r0</span> <span class="id" title="var">c'</span> <span class="id" title="var">r1</span>). <span class="id" title="var">cD</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">s1</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">exists</span> <span class="id" title="var">s1</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">rUnI</span> ; <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">can_trf_rules_req</span> <span class="id" title="var">V</span> <span class="id" title="var">R</span> <span class="id" title="var">R'</span> <span class="id" title="var">rules</span> : <span class="id" title="var">req</span> <span class="id" title="var">R</span> <span class="id" title="var">R'</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>,<br/>
&nbsp;&nbsp;@<span class="id" title="var">can_trf_rules</span> <span class="id" title="var">V</span> <span class="id" title="var">R</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; @<span class="id" title="var">can_trf_rules</span> <span class="id" title="var">V</span> <span class="id" title="var">R'</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">req</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">rsub</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">ss</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">fri</span> <span class="id" title="var">c'</span> <span class="id" title="var">rcc</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ss0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">rcc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">fri</span> <span class="id" title="tactic">in</span> <span class="id" title="var">rcc</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">exists</span> <span class="id" title="var">rcc</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">rcc1</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">exists</span> <span class="id" title="var">rcc1</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ss</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">der_trf_rc_adm</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">sty</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">R</span> <span class="id" title="var">rules</span>, <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">can_trf_rules_rc</span> <span class="id" title="var">R</span> (<span class="id" title="var">adm</span> <span class="id" title="var">rules</span>) <span class="id" title="var">ps</span> <span class="id" title="var">c</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">concl</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">sty</span>) <span class="id" title="var">concl</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">concl'</span>, <span class="id" title="var">R</span> <span class="id" title="var">concl</span> <span class="id" title="var">concl'</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">sty</span>) <span class="id" title="var">concl'</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intro</span>.<br/>
<span class="id" title="tactic">eapply</span> (<span class="id" title="var">derrec_all_rect</span> (<span class="id" title="var">Q</span> := (<span class="id" title="keyword">fun</span> <span class="id" title="var">concl</span> =&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">concl'</span> : <span class="id" title="var">sty</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">concl</span> <span class="id" title="var">concl'</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (<span class="id" title="var">emptyT</span> (<span class="id" title="var">X</span>:=<span class="id" title="var">sty</span>)) <span class="id" title="var">concl'</span>))).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> <span class="id" title="var">rpc</span> <span class="id" title="var">dpss</span> <span class="id" title="var">fall</span> <span class="id" title="var">concl'</span> <span class="id" title="var">Rcc</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">rpc</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules_rc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">rpc</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">rpc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Rcc</span>. <span class="id" title="var">cD</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">rpc</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">adm_derrec_trans</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">Rcc0</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">dersrecI_forall</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Rcc1</span>. 2: <span class="id" title="var">eassumption</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">Rcc3</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">fall</span>. 2: <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">fall</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">dersrecD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">dpss</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">dpss</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Check</span> <span class="id" title="var">der_trf_rc_adm</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">der_trf_rc_derl</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">sty</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">R</span> <span class="id" title="var">rules</span>, <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">can_trf_rules_rc</span> <span class="id" title="var">R</span> (<span class="id" title="var">derl</span> <span class="id" title="var">rules</span>) <span class="id" title="var">ps</span> <span class="id" title="var">c</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">concl</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">sty</span>) <span class="id" title="var">concl</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">concl'</span>, <span class="id" title="var">R</span> <span class="id" title="var">concl</span> <span class="id" title="var">concl'</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">sty</span>) <span class="id" title="var">concl'</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rules</span> <span class="id" title="var">rtc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">der_trf_rc_adm</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">rpc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rtc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">rpc</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">can_trf_rules_rc_mono'</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">rsub_derl_adm</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rpc</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Check</span> <span class="id" title="var">der_trf_rc_derl</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">der_trf_rc</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">sty</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">R</span> <span class="id" title="var">rules</span>, <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">can_trf_rules_rc</span> <span class="id" title="var">R</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">concl</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">sty</span>) <span class="id" title="var">concl</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">concl'</span>, <span class="id" title="var">R</span> <span class="id" title="var">concl</span> <span class="id" title="var">concl'</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">sty</span>) <span class="id" title="var">concl'</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rules</span> <span class="id" title="var">rtc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">der_trf_rc_adm</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">rpc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rtc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">rpc</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">can_trf_rules_rc_mono'</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">rsub_adm</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rpc</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Check</span> <span class="id" title="var">der_trf_rc</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">der_trf_derl</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">sty</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">R</span> <span class="id" title="var">rules</span>, <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">can_trf_rules</span> <span class="id" title="var">R</span> (<span class="id" title="var">derl</span> <span class="id" title="var">rules</span>) <span class="id" title="var">ps</span> <span class="id" title="var">c</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">concl</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">sty</span>) <span class="id" title="var">concl</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">concl'</span>, <span class="id" title="var">R</span> <span class="id" title="var">concl</span> <span class="id" title="var">concl'</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">sty</span>) <span class="id" title="var">concl'</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intro</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">der_trf_rc_derl</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">can_trf_rules_imp_rc</span>.<br/>
<span class="id" title="tactic">exact</span> (<span class="id" title="var">X</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">X0</span>). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">der_trf_derl'</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rules</span> <span class="id" title="var">ct</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">der_trf_rc_derl</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rules</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">rpc</span> =&gt; <span class="id" title="var">can_trf_rules_imp_rc</span> (<span class="id" title="var">ct</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> <span class="id" title="var">rpc</span>)).<br/>

<br/>
<span class="id" title="keyword">Check</span> <span class="id" title="var">der_trf_derl</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">can_trf_derl</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">R</span> <span class="id" title="var">ps</span> (<span class="id" title="var">c</span> : <span class="id" title="var">X</span>): <span class="id" title="var">can_trf_rules</span> <span class="id" title="var">R</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">can_trf_rules</span> <span class="id" title="var">R</span> (<span class="id" title="var">derl</span> <span class="id" title="var">rules</span>) <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">X0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>. <span class="id" title="var">cD</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">in_derl</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">der_trf</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">sty</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">R</span> <span class="id" title="var">rules</span>, <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">can_trf_rules</span> <span class="id" title="var">R</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">concl</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">sty</span>) <span class="id" title="var">concl</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">concl'</span>, <span class="id" title="var">R</span> <span class="id" title="var">concl</span> <span class="id" title="var">concl'</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">sty</span>) <span class="id" title="var">concl'</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intro</span> <span class="id" title="var">rct</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">der_trf_derl</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">can_trf_derl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rct</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Check</span> <span class="id" title="var">der_trf</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">can_trf_rules_rtc</span> (<span class="id" title="var">sty</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">R</span> <span class="id" title="var">rules</span> (<span class="id" title="var">ps</span> : <span class="id" title="var">list</span> <span class="id" title="var">sty</span>) (<span class="id" title="var">c</span> : <span class="id" title="var">sty</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">c'</span> : <span class="id" title="var">sty</span>, <span class="id" title="var">R</span> <span class="id" title="var">c</span> <span class="id" title="var">c'</span> -&gt; <br/>
&nbsp;&nbsp;(<span class="id" title="var">sigT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ps'</span> : <span class="id" title="var">list</span> <span class="id" title="var">sty</span> =&gt; <span class="id" title="var">prod</span> (<span class="id" title="var">rules</span> <span class="id" title="var">ps'</span> <span class="id" title="var">c'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ForallT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">p'</span> =&gt; <span class="id" title="var">sigT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">prod</span> (<span class="id" title="var">InT</span> <span class="id" title="var">p</span> <span class="id" title="var">ps</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">clos_refl_transT_n1</span> <span class="id" title="var">R</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span>))) <span class="id" title="var">ps'</span>))).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">can_trf_rules_imp_rtc</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>:<br/>
&nbsp;&nbsp;@<span class="id" title="var">can_trf_rules</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; @<span class="id" title="var">can_trf_rules_rtc</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules_rtc</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X0</span>. <span class="id" title="var">cD</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X2</span>. 2: <span class="id" title="var">eassumption</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">exists</span> <span class="id" title="var">X2</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">rtn1T_trans</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rtn1T_refl</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">can_trf_rules_rtc_mono'</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">rsub</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> -&gt; @<span class="id" title="var">can_trf_rules_rtc</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt;<br/>
&nbsp;&nbsp;@<span class="id" title="var">can_trf_rules_rtc</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">rsub</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules_rtc</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">X0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">X0</span>. <span class="id" title="var">cD</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">firstorder</span>.<br/>
<span class="id" title="tactic">exact</span> <span class="id" title="var">X2</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">can_trf_rules_rtc_mono</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">r</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">rsubI</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (@<span class="id" title="var">can_trf_rules_rtc_mono'</span> <span class="id" title="var">sty</span> <span class="id" title="var">R</span> <span class="id" title="var">rulesa</span> <span class="id" title="var">rulesb</span> <span class="id" title="var">r</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">trf_rules_rtc</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">sty</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">R</span> <span class="id" title="var">rules</span> (<span class="id" title="var">c</span> : <span class="id" title="var">sty</span>), <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">ps'</span> <span class="id" title="var">c'</span>, <span class="id" title="var">clos_refl_transT_n1</span> <span class="id" title="var">R</span> <span class="id" title="var">c</span> <span class="id" title="var">c'</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rules</span> <span class="id" title="var">ps'</span> <span class="id" title="var">c'</span> -&gt; <span class="id" title="var">can_trf_rules_rtc</span> <span class="id" title="var">R</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps'</span> <span class="id" title="var">c'</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">can_trf_rules</span> (<span class="id" title="var">clos_refl_transT_n1</span> <span class="id" title="var">R</span>) <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">rtc</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">rtc</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">ps</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">rtn1T_refl</span>.<br/>
<span class="id" title="var">cD</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">rtc</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules_rtc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">rtc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rtc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">rtc</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>. <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">r1</span>. 2: <span class="id" title="var">eassumption</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHrtc1</span>. 2: <span class="id" title="var">eassumption</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>. <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">clos_rtn1_rtT</span> <span class="id" title="tactic">in</span> <span class="id" title="var">r3</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">clos_rtn1_rtT</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHrtc3</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">clos_rt_rtn1T</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">rtT_trans</span> ; <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Check</span> <span class="id" title="var">trf_rules_rtc</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">trf_rules_derl</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">sty</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">R</span> (<span class="id" title="var">rules</span> : <span class="id" title="var">rlsT</span> <span class="id" title="var">sty</span>), <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">can_trf_rules</span> <span class="id" title="var">R</span> (<span class="id" title="var">derl</span> <span class="id" title="var">rules</span>) <span class="id" title="var">ps</span> <span class="id" title="var">c</span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">derl</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">can_trf_rules</span> <span class="id" title="var">R</span> (<span class="id" title="var">derl</span> <span class="id" title="var">rules</span>) <span class="id" title="var">ps</span> <span class="id" title="var">c</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intro</span> <span class="id" title="var">rctd</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">derl_all_rect</span>.<br/>
{ <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exists</span> [<span class="id" title="var">c'</span>].<br/>
<span class="id" title="tactic">split</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">asmI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">exists</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_eq</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span> ; <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">InT_nilE</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>. <span class="id" title="var">eassumption</span>. }<br/>
<br/>
{ <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intros</span> <span class="id" title="var">rpc</span> <span class="id" title="var">drsl</span> <span class="id" title="var">fcd</span> <span class="id" title="var">qcp</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">rctd</span> <span class="id" title="tactic">in</span> <span class="id" title="var">rpc</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">rctd</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">c'</span> <span class="id" title="var">Rcc</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules</span> <span class="id" title="tactic">in</span> <span class="id" title="var">rpc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rpc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Rcc</span>. <span class="id" title="var">cD</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">rpc</span>.<br/>

<br/>
<span class="id" title="tactic">assert</span> {<span class="id" title="var">cqss</span> : <span class="id" title="var">list</span> <span class="id" title="var">sty</span> &amp;<br/>
&nbsp;&nbsp;(<span class="id" title="var">dersl</span> <span class="id" title="var">rules</span> <span class="id" title="var">cqss</span> <span class="id" title="var">Rcc</span> * <span class="id" title="var">ForallT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">p'</span> : <span class="id" title="var">sty</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">p</span> : <span class="id" title="var">sty</span> &amp; <span class="id" title="var">InT</span> <span class="id" title="var">p</span> (<span class="id" title="var">concat</span> <span class="id" title="var">pss</span>) * <span class="id" title="var">R</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span>}) <span class="id" title="var">cqss</span>)%<span class="id" title="keyword">type</span>}.<br/>

<br/>
{ <span class="id" title="tactic">clear</span> <span class="id" title="var">Rcc0</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">Rcc1</span>.<br/>
<span class="id" title="tactic">exists</span> []. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">dtNil</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_nil</span>.<br/>
<span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">Forall2T_ex_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">fcd</span>. 2: <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">fcd</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules</span> <span class="id" title="tactic">in</span> <span class="id" title="var">c</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">c</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p1</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">p1</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">dtCons</span> ; <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallTI_forall</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">InT_appE</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>. <span class="id" title="var">sD</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p2</span>. 2: <span class="id" title="var">eassumption</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>. 2: <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">InT_concat</span> ; <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHRcc2</span>. 2: <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">assumption</span>. }<br/>
<br/>
{ <span class="id" title="var">cD</span>. <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>. 2: <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">derl_trans</span> ; <span class="id" title="var">eassumption</span>. } } <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Check</span> <span class="id" title="var">trf_rules_derl</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">der_trf_rtc</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">sty</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">R</span> <span class="id" title="var">rules</span>, <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">can_trf_rules_rtc</span> <span class="id" title="var">R</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">concl</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">sty</span>) <span class="id" title="var">concl</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">concl'</span>, <span class="id" title="var">clos_refl_transT_n1</span> <span class="id" title="var">R</span> <span class="id" title="var">concl</span> <span class="id" title="var">concl'</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">sty</span>) <span class="id" title="var">concl'</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 1. <span class="id" title="tactic">apply</span> <span class="id" title="var">der_trf</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">apply</span> <span class="id" title="var">trf_rules_rtc</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 1. <span class="id" title="tactic">apply</span> <span class="id" title="var">X</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Check</span> <span class="id" title="var">der_trf_rtc</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">der_trf_ht</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">sty</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">R</span> <span class="id" title="var">rules</span>, <br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">can_trf_rules</span> <span class="id" title="var">R</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">concl</span> (<span class="id" title="var">D</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">sty</span>) <span class="id" title="var">concl</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">concl'</span>, <span class="id" title="var">R</span> <span class="id" title="var">concl</span> <span class="id" title="var">concl'</span> -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sigT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">D'</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">sty</span>) <span class="id" title="var">concl'</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">derrec_height</span> <span class="id" title="var">D'</span> &lt;= <span class="id" title="var">derrec_height</span> <span class="id" title="var">D</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intros</span> <span class="id" title="var">ctr</span>.<br/>
<span class="id" title="tactic">eapply</span> (<span class="id" title="var">derrec_rect_mut_all</span> (<span class="id" title="var">Q</span> := (<span class="id" title="keyword">fun</span> <span class="id" title="var">concl</span> <span class="id" title="var">D</span> =&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">concl'</span> : <span class="id" title="var">sty</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">concl</span> <span class="id" title="var">concl'</span> -&gt; {<span class="id" title="var">D'</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (<span class="id" title="var">emptyT</span> (<span class="id" title="var">X</span>:=<span class="id" title="var">sty</span>)) <span class="id" title="var">concl'</span> &amp;<br/>
&nbsp;&nbsp;<span class="id" title="var">derrec_height</span> <span class="id" title="var">D'</span> &lt;= <span class="id" title="var">derrec_height</span> <span class="id" title="var">D</span>}))).<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">c</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> <span class="id" title="var">rpc</span> <span class="id" title="var">dpss</span> <span class="id" title="var">apd</span> <span class="id" title="var">concl'</span> <span class="id" title="var">Rcc</span>.<br/>
<span class="id" title="tactic">pose</span> (<span class="id" title="var">ctr</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> <span class="id" title="var">rpc</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ctrr</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">can_trf_rules</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ctrr</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ctrr</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Rcc</span>. <span class="id" title="var">cD</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">ctrr</span> <span class="id" title="var">ctr</span>.<br/>

<br/>
<span class="id" title="tactic">assert</span> { <span class="id" title="var">Ds'</span> : <span class="id" title="var">dersrec</span> <span class="id" title="var">rules</span> (<span class="id" title="var">emptyT</span> (<span class="id" title="var">X</span>:=<span class="id" title="var">sty</span>)) <span class="id" title="var">Rcc</span> &amp;<br/>
&nbsp;&nbsp;<span class="id" title="var">dersrec_height</span> <span class="id" title="var">Ds'</span> &lt;= <span class="id" title="var">dersrec_height</span> <span class="id" title="var">dpss</span> }.<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="keyword">forall</span> <span class="id" title="var">p</span>, <span class="id" title="var">InT</span> <span class="id" title="var">p</span> <span class="id" title="var">Rcc</span> -&gt; { <span class="id" title="var">D'</span> : <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (<span class="id" title="var">emptyT</span> (<span class="id" title="var">X</span>:=<span class="id" title="var">sty</span>)) <span class="id" title="var">p</span> &amp;<br/>
&nbsp;&nbsp;<span class="id" title="var">derrec_height</span> <span class="id" title="var">D'</span> &lt;= <span class="id" title="var">dersrec_height</span> <span class="id" title="var">dpss</span> }).<br/>

<br/>
{ <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Rcc1</span>. 2: <span class="id" title="var">eassumption</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">allPderD_in</span> <span class="id" title="tactic">in</span> <span class="id" title="var">apd</span>. 2: <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">apd</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">s</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Rcc3</span>. <span class="id" title="var">cD</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">s</span>.<br/>
<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">le_dersrec_height</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="var">eassumption</span>. }<br/>
<br/>
{ <span class="id" title="tactic">clear</span> <span class="id" title="var">apd</span> <span class="id" title="var">concl'</span> <span class="id" title="var">Rcc0</span> <span class="id" title="var">Rcc1</span> <span class="id" title="var">R</span> <span class="id" title="var">rpc</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">Rcc</span>. <span class="id" title="tactic">eexists</span>. <span class="id" title="var">Unshelve</span>. 3: <span class="id" title="tactic">apply</span> <span class="id" title="var">dlNil</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">le_0_n</span>.<br/>
<span class="id" title="var">require</span> <span class="id" title="var">IHRcc</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_cons</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">pose</span> (<span class="id" title="var">X</span> <span class="id" title="var">a</span> (<span class="id" title="var">InT_eq</span> <span class="id" title="var">a</span> <span class="id" title="var">Rcc</span>)). <span class="id" title="var">cD</span>.<br/>
<span class="id" title="tactic">exists</span> (<span class="id" title="var">dlCons</span> <span class="id" title="var">s</span> <span class="id" title="var">IHRcc</span>). <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Nat.max_lub</span> ; <span class="id" title="tactic">assumption</span>. }<br/>
<br/>
<span class="id" title="var">cD</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">derI</span> <span class="id" title="var">concl'</span> <span class="id" title="var">Rcc0</span> <span class="id" title="var">X</span>). <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">le_n_S</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Check</span> <span class="id" title="var">der_trf_ht</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dlCons_inj</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">seq</span> <span class="id" title="var">seqs</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span> <span class="id" title="var">d'</span> <span class="id" title="var">ds'</span>,<br/>
&nbsp;&nbsp;@<span class="id" title="var">dlCons</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">seq</span> <span class="id" title="var">seqs</span> <span class="id" title="var">d</span> <span class="id" title="var">ds</span> = <span class="id" title="var">dlCons</span> <span class="id" title="var">d'</span> <span class="id" title="var">ds'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">prod</span> (<span class="id" title="var">d</span> = <span class="id" title="var">d'</span>) (<span class="id" title="var">ds</span> = <span class="id" title="var">ds'</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">destruction</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Check</span> <span class="id" title="var">dlCons_inj</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">existT_inj</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) <span class="id" title="var">px</span> <span class="id" title="var">px'</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">existT</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">px</span> = <span class="id" title="var">existT</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">px'</span> -&gt; (<span class="id" title="var">px</span> = <span class="id" title="var">px'</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">destruction</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">existT_inj'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> (<span class="id" title="var">x</span> <span class="id" title="var">x'</span> : <span class="id" title="var">A</span>) <span class="id" title="var">px</span> <span class="id" title="var">px'</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">existT</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">px</span> = <span class="id" title="var">existT</span> <span class="id" title="var">P</span> <span class="id" title="var">x'</span> <span class="id" title="var">px'</span> -&gt; (<span class="id" title="var">x</span> = <span class="id" title="var">x'</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">dependent</span> <span class="id" title="tactic">destruction</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Defined</span>.<br/>

<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dercl_soundness</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">valid</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">rules_sound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span>, <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">ForallT</span> <span class="id" title="var">valid</span> <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">valid</span> <span class="id" title="var">c</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> (<span class="id" title="var">c</span> : <span class="id" title="var">W</span>), <span class="id" title="var">dercl</span> <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">ForallT</span> <span class="id" title="var">valid</span> <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">valid</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">apply</span> (@<span class="id" title="var">dercl_all_rect</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="var">ForallT</span> <span class="id" title="var">valid</span> <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">valid</span> <span class="id" title="var">c</span>)).<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">fvps</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">ForallT_singleD</span> <span class="id" title="var">fvps</span>).<br/>
- <span class="id" title="tactic">intros</span> * <span class="id" title="var">rpsc</span> <span class="id" title="var">dcsl</span> <span class="id" title="var">fvv</span> <span class="id" title="var">qseq</span> <span class="id" title="var">fvqs</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">rules_sound</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">rpsc</span>.<br/>
<span class="id" title="tactic">clear</span> <span class="id" title="var">rpsc</span> <span class="id" title="var">dcsl</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">fvv</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_nil</span>.<br/>
<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">fvqs</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_appendD</span> <span class="id" title="tactic">in</span> <span class="id" title="var">fvqs</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">fvqs</span>.<br/>
<span class="id" title="tactic">exact</span> (<span class="id" title="var">ForallT_cons</span> <span class="id" title="var">y</span> (<span class="id" title="var">r</span> <span class="id" title="var">f</span>) (<span class="id" title="var">IHfvv</span> <span class="id" title="var">f0</span>)).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">derrec_soundness</span> <span class="id" title="var">W</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">valid</span> <br/>
&nbsp;&nbsp;(<span class="id" title="var">rules_sound</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">ps</span> (<span class="id" title="var">c</span> : <span class="id" title="var">W</span>), <span class="id" title="var">rules</span> <span class="id" title="var">ps</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">ForallT</span> <span class="id" title="var">valid</span> <span class="id" title="var">ps</span> -&gt; <span class="id" title="var">valid</span> <span class="id" title="var">c</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">p</span>, <span class="id" title="var">prems</span> <span class="id" title="var">p</span> -&gt; <span class="id" title="var">valid</span> <span class="id" title="var">p</span>) -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">c</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">prems</span> <span class="id" title="var">c</span> -&gt; <span class="id" title="var">valid</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">pv</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">derrec_all_rect</span> <span class="id" title="var">pv</span>).<br/>
<span class="id" title="tactic">intros</span> * <span class="id" title="var">rps</span> <span class="id" title="var">drs</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">rules_sound</span> <span class="id" title="var">ps</span> <span class="id" title="var">concl</span> <span class="id" title="var">rps</span>). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Unset</span> <span class="id" title="var">Universe</span> <span class="id" title="var">Polymorphism</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">radm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">p</span> <span class="id" title="var">c</span> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">radmI</span> : (<span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">X</span>) <span class="id" title="var">p</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> (@<span class="id" title="var">emptyT</span> <span class="id" title="var">X</span>) <span class="id" title="var">c</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">radm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">p</span> <span class="id" title="var">c</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">radmD</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">p</span> <span class="id" title="var">c</span> (<span class="id" title="var">r</span> : @<span class="id" title="var">radm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">p</span> <span class="id" title="var">c</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">r</span> <span class="id" title="keyword">with</span> | <span class="id" title="var">radmI</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">d</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">rel_adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">R</span> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">rel_admI</span> : (<span class="id" title="keyword">forall</span> <span class="id" title="var">p</span> <span class="id" title="var">c</span>, <span class="id" title="var">R</span> <span class="id" title="var">p</span> <span class="id" title="var">c</span> -&gt; @<span class="id" title="var">radm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">p</span> <span class="id" title="var">c</span>) -&gt; <span class="id" title="var">rel_adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">rel_admD</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">R</span> (<span class="id" title="var">r</span> : @<span class="id" title="var">rel_adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">R</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">r</span> <span class="id" title="keyword">with</span> | <span class="id" title="var">rel_admI</span> <span class="id" title="var">_</span> <span class="id" title="var">r0</span> =&gt; <span class="id" title="var">r0</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">can_rel</span> <span class="id" title="var">sty</span> <span class="id" title="var">fty</span> <span class="id" title="var">rules</span> (<span class="id" title="var">R</span> : <span class="id" title="var">fty</span> -&gt; <span class="id" title="var">sty</span> -&gt; <span class="id" title="var">sty</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">fml</span> : <span class="id" title="var">fty</span>) (<span class="id" title="var">seq</span> : <span class="id" title="var">sty</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">seq'</span>, <span class="id" title="var">R</span> <span class="id" title="var">fml</span> <span class="id" title="var">seq</span> <span class="id" title="var">seq'</span> -&gt; <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">emptyT</span> <span class="id" title="var">seq'</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">rel_adm_rtc</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">R</span> :<br/>
&nbsp;&nbsp;@<span class="id" title="var">rel_adm</span> <span class="id" title="var">X</span> <span class="id" title="var">rules</span> <span class="id" title="var">R</span> -&gt; <span class="id" title="var">rel_adm</span> <span class="id" title="var">rules</span> (<span class="id" title="var">clos_refl_transT</span> <span class="id" title="var">R</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X0</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">radmD</span> (<span class="id" title="var">r</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">r0</span>)). <span class="id" title="tactic">tauto</span>. <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">crd_ra</span> <span class="id" title="var">sty</span> <span class="id" title="var">fty</span> <span class="id" title="var">rules</span> (<span class="id" title="var">R</span> : <span class="id" title="var">fty</span> -&gt; <span class="id" title="var">sty</span> -&gt; <span class="id" title="var">sty</span> -&gt; <span class="id" title="keyword">Type</span>) <span class="id" title="var">fml</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">rel_adm</span> <span class="id" title="var">rules</span> (<span class="id" title="var">R</span> <span class="id" title="var">fml</span>))<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">seq</span>, <span class="id" title="var">derrec</span> <span class="id" title="var">rules</span> <span class="id" title="var">emptyT</span> <span class="id" title="var">seq</span> -&gt; <span class="id" title="var">can_rel</span> <span class="id" title="var">rules</span> <span class="id" title="var">R</span> <span class="id" title="var">fml</span> <span class="id" title="var">seq</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">ra</span> <span class="id" title="var">seq</span> <span class="id" title="var">ds</span> <span class="id" title="var">seq'</span> <span class="id" title="var">rf</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">ra</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">X</span> <span class="id" title="var">seq</span> <span class="id" title="var">seq'</span> <span class="id" title="var">rf</span>).<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">d</span> <span class="id" title="var">ds</span>).<br/>
- <span class="id" title="tactic">intro</span> <span class="id" title="var">dc</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">dp</span>.<br/>
<span class="id" title="tactic">exact</span> (<span class="id" title="var">dc</span> <span class="id" title="var">p</span> <span class="id" title="var">dp</span> <span class="id" title="var">c</span> <span class="id" title="var">X</span>). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>