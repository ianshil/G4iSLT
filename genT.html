<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>genT</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library genT</h1>

<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">List</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ListNotations</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">existsT</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Coq.Classes.CRelationClasses</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">gen</span>.<br/>

<br/>
<span class="id" title="var">Polymorphic</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">rlsT</span> <span class="id" title="var">W</span> := <span class="id" title="var">list</span> <span class="id" title="var">W</span> -&gt; <span class="id" title="var">W</span> -&gt; <span class="id" title="keyword">Type</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">emptyT</span> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span> := .<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">emptyT_any'</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">sty</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">Q</span> (<span class="id" title="var">prem</span> : <span class="id" title="var">sty</span>), <span class="id" title="var">emptyT</span> <span class="id" title="var">prem</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">prem</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">emptyT_any</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">sty</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">Q</span> (<span class="id" title="var">prem</span> : <span class="id" title="var">sty</span>), <span class="id" title="var">emptyT</span> <span class="id" title="var">prem</span> -&gt; <span class="id" title="var">Q</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="var">Polymorphic</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">relationT</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) := <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>.<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">empty_relT</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Type</span> := .<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">rsub_emptyT</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} <span class="id" title="var">r</span> : @<span class="id" title="var">rsub</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">empty_relT</span> <span class="id" title="var">r</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">transitiveT</span> <span class="id" title="var">W</span> (<span class="id" title="var">R</span> : <span class="id" title="var">relationT</span> <span class="id" title="var">W</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">W</span>), <span class="id" title="var">R</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">R</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> -&gt; <span class="id" title="var">R</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iffT_trans</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>, <span class="id" title="var">iffT</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> -&gt; <span class="id" title="var">iffT</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> -&gt; <span class="id" title="var">iffT</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iffT</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iffT_sym'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>, <span class="id" title="var">iffT</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> -&gt; <span class="id" title="var">iffT</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iffT</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iffT_refl</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span>, <span class="id" title="var">iffT</span> <span class="id" title="var">A</span> <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iffT</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iffT_D1'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>, <span class="id" title="var">iffT</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iffT</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iffT_D2'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>, <span class="id" title="var">iffT</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iffT</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">iffT_sym</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">X</span> : <span class="id" title="var">iffT</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) := <span class="id" title="keyword">let</span> (<span class="id" title="var">f</span>, <span class="id" title="var">g</span>) := <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">g</span>, <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">iffT_D1</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">X</span> : <span class="id" title="var">iffT</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) <span class="id" title="var">a</span> := <span class="id" title="keyword">let</span> (<span class="id" title="var">f</span>, <span class="id" title="var">_</span>) := <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">iffT_D2</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">X</span> : <span class="id" title="var">iffT</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) <span class="id" title="var">b</span> := <span class="id" title="keyword">let</span> (<span class="id" title="var">_</span>, <span class="id" title="var">g</span>) := <span class="id" title="var">X</span> <span class="id" title="tactic">in</span> <span class="id" title="var">g</span> <span class="id" title="var">b</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prod_mono</span> <span class="id" title="var">A</span> <span class="id" title="var">A'</span> <span class="id" title="var">B</span> <span class="id" title="var">B'</span> : (<span class="id" title="var">A</span> -&gt; <span class="id" title="var">A'</span>) -&gt; (<span class="id" title="var">B</span> -&gt; <span class="id" title="var">B'</span>) -&gt; (<span class="id" title="var">A</span> * <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A'</span> * <span class="id" title="var">B'</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iffT_prod</span> <span class="id" title="var">A</span> <span class="id" title="var">A'</span> <span class="id" title="var">B</span> <span class="id" title="var">B'</span> : <span class="id" title="var">iffT</span> <span class="id" title="var">A</span> <span class="id" title="var">A'</span> -&gt; <span class="id" title="var">iffT</span> <span class="id" title="var">B</span> <span class="id" title="var">B'</span> -&gt; <span class="id" title="var">iffT</span> (<span class="id" title="var">A</span> * <span class="id" title="var">B</span>) ( <span class="id" title="var">A'</span> * <span class="id" title="var">B'</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iffT</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X0</span>.<br/>
<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">apply</span> <span class="id" title="var">prod_mono</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">AccT</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">R</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">AccT_intro</span> : (<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>, <span class="id" title="var">R</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">AccT</span> <span class="id" title="var">R</span> <span class="id" title="var">y</span>) -&gt; <span class="id" title="var">AccT</span> <span class="id" title="var">R</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">well_foundedT</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">R</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> : <span class="id" title="var">A</span>, <span class="id" title="var">AccT</span> <span class="id" title="var">R</span> <span class="id" title="var">a</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">ForallT</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) : <span class="id" title="var">list</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ForallT_nil</span> : <span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> []<br/>
&nbsp;&nbsp;| <span class="id" title="var">ForallT_cons</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> (<span class="id" title="var">x</span> :: <span class="id" title="var">l</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ForallT_inv</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> (<span class="id" title="var">a</span> :: <span class="id" title="var">l</span>) -&gt; <span class="id" title="var">P</span> <span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X0</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ForallT_cons_inv</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> (<span class="id" title="var">x</span> :: <span class="id" title="var">l</span>) -&gt; <span class="id" title="var">P</span> <span class="id" title="var">x</span> * <span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X1</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ForallT_single</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>), <span class="id" title="var">iffT</span> (<span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> [<span class="id" title="var">x</span>]) (<span class="id" title="var">P</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iffT</span>. <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_cons</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_nil</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ForallT_singleD</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span> := <span class="id" title="var">iffT_D1</span> (@<span class="id" title="var">ForallT_single</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ForallT_singleI</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span> := <span class="id" title="var">iffT_D2</span> (@<span class="id" title="var">ForallT_single</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ForallT_cons_iff</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> (<span class="id" title="var">x</span> :: <span class="id" title="var">l</span>)) (<span class="id" title="var">P</span> <span class="id" title="var">x</span> * <span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iffT</span>. <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_cons_inv</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_cons</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">f</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ForallT_append</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">xs</span> <span class="id" title="var">ys</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> (<span class="id" title="var">xs</span> ++ <span class="id" title="var">ys</span>)) (<span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> <span class="id" title="var">xs</span> * <span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> <span class="id" title="var">ys</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iffT</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">xs</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_nil</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">f0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHxs</span>. <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">p</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_cons</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">f0</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_cons</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">f</span>. <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ForallT_appendD</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">xs</span> <span class="id" title="var">ys</span> := <span class="id" title="var">iffT_D1</span> (@<span class="id" title="var">ForallT_append</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">xs</span> <span class="id" title="var">ys</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ForallT_appendD1</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">xs</span> <span class="id" title="var">ys</span> <span class="id" title="var">aa</span> := <span class="id" title="var">fst</span> (@<span class="id" title="var">ForallT_appendD</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">xs</span> <span class="id" title="var">ys</span> <span class="id" title="var">aa</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ForallT_appendD2</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">xs</span> <span class="id" title="var">ys</span> <span class="id" title="var">aa</span> := <span class="id" title="var">snd</span> (@<span class="id" title="var">ForallT_appendD</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">xs</span> <span class="id" title="var">ys</span> <span class="id" title="var">aa</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ForallT_appendI'</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">xs</span> <span class="id" title="var">ys</span> := <span class="id" title="var">iffT_D2</span> (@<span class="id" title="var">ForallT_append</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">xs</span> <span class="id" title="var">ys</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ForallT_appendI</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">xs</span> <span class="id" title="var">ys</span> <span class="id" title="var">ax</span> <span class="id" title="var">ay</span> := <br/>
&nbsp;&nbsp;@<span class="id" title="var">ForallT_appendI'</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">xs</span> <span class="id" title="var">ys</span> (<span class="id" title="var">pair</span> <span class="id" title="var">ax</span> <span class="id" title="var">ay</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ForallT_2</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> [<span class="id" title="var">x</span>; <span class="id" title="var">y</span>]) (<span class="id" title="var">P</span> <span class="id" title="var">x</span> * <span class="id" title="var">P</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iffT</span>. <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">tauto</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_cons</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">p</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_cons</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">p0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_nil</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ForallT_map_2</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> (<span class="id" title="var">map</span> <span class="id" title="var">f</span> [<span class="id" title="var">x</span>; <span class="id" title="var">y</span>])) (<span class="id" title="var">P</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) * <span class="id" title="var">P</span> (<span class="id" title="var">f</span> <span class="id" title="var">y</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_2</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ForallT_map</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> (<span class="id" title="var">map</span> <span class="id" title="var">f</span> [<span class="id" title="var">x</span>])) (<span class="id" title="var">P</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_single</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ForallT_map_rev</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">P</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)) (<span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> (<span class="id" title="var">map</span> <span class="id" title="var">f</span> [<span class="id" title="var">x</span>])).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">HH</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_single</span>; <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ForallT_2D</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> := <span class="id" title="var">iffT_D1</span> (@<span class="id" title="var">ForallT_2</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ForallT_D1</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">aa</span> := <span class="id" title="var">fst</span> (@<span class="id" title="var">ForallT_2D</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">aa</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ForallT_D2</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">aa</span> := <span class="id" title="var">snd</span> (@<span class="id" title="var">ForallT_2D</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">aa</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ForallT_2I'</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> := <span class="id" title="var">iffT_D2</span> (@<span class="id" title="var">ForallT_2</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ForallT_2I</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">ax</span> <span class="id" title="var">ay</span> := @<span class="id" title="var">ForallT_2I'</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> (<span class="id" title="var">pair</span> <span class="id" title="var">ax</span> <span class="id" title="var">ay</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ForallT_impl</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> : <span class="id" title="var">A</span>, <span class="id" title="var">P</span> <span class="id" title="var">a</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">a</span>) -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>, <span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">ForallT</span> <span class="id" title="var">Q</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_nil</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_cons</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">Forall2T</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">R</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">list</span> <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Forall2T_nil</span> : <span class="id" title="var">Forall2T</span> <span class="id" title="var">R</span> [] []<br/>
&nbsp;&nbsp;| <span class="id" title="var">Forall2T_cons</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">y</span> : <span class="id" title="var">B</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">l'</span> : <span class="id" title="var">list</span> <span class="id" title="var">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">Forall2T</span> <span class="id" title="var">R</span> <span class="id" title="var">l</span> <span class="id" title="var">l'</span> -&gt; <span class="id" title="var">Forall2T</span> <span class="id" title="var">R</span> (<span class="id" title="var">x</span> :: <span class="id" title="var">l</span>) (<span class="id" title="var">y</span> :: <span class="id" title="var">l'</span>)<br/>
&nbsp;&nbsp;.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">Forall2T_app_inv_l</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">R</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Type</span>) <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">l'</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">Forall2T</span> <span class="id" title="var">R</span> (<span class="id" title="var">l1</span> ++ <span class="id" title="var">l2</span>) <span class="id" title="var">l'</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" title="var">sigT2</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">l1'</span> =&gt; <span class="id" title="var">Forall2T</span> <span class="id" title="var">R</span> <span class="id" title="var">l1</span> <span class="id" title="var">l1'</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">l1'</span> =&gt; <span class="id" title="var">sigT2</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">l2'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Forall2T</span> <span class="id" title="var">R</span> <span class="id" title="var">l2</span> <span class="id" title="var">l2'</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">l2'</span> =&gt; <span class="id" title="var">l'</span> = <span class="id" title="var">l1'</span> ++ <span class="id" title="var">l2'</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> <span class="id" title="var">l1</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">l1</span>. <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exists</span> []. <span class="id" title="tactic">apply</span> <span class="id" title="var">Forall2T_nil</span>.<br/>
<span class="id" title="tactic">exists</span> <span class="id" title="var">l'</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">IHl1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="tactic">exists</span> (<span class="id" title="var">y</span> :: <span class="id" title="var">x</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">Forall2T_cons</span> ; <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">eexists</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">Forall2T_app_inv_r</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">R</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Type</span>) <span class="id" title="var">l1'</span> <span class="id" title="var">l2'</span> <span class="id" title="var">l</span>, <br/>
&nbsp;&nbsp;<span class="id" title="var">Forall2T</span> <span class="id" title="var">R</span> <span class="id" title="var">l</span> (<span class="id" title="var">l1'</span> ++ <span class="id" title="var">l2'</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">sigT2</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">l1</span> =&gt; <span class="id" title="var">Forall2T</span> <span class="id" title="var">R</span> <span class="id" title="var">l1</span> <span class="id" title="var">l1'</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">l1</span> =&gt; <span class="id" title="var">sigT2</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">l2</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Forall2T</span> <span class="id" title="var">R</span> <span class="id" title="var">l2</span> <span class="id" title="var">l2'</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">l2</span> =&gt; <span class="id" title="var">l</span> = <span class="id" title="var">l1</span> ++ <span class="id" title="var">l2</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> <span class="id" title="var">l1'</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">l1'</span>. <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">exists</span> []. <span class="id" title="tactic">apply</span> <span class="id" title="var">Forall2T_nil</span>.<br/>
<span class="id" title="tactic">exists</span> <span class="id" title="var">l</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">IHl1'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X1</span>.<br/>
<span class="id" title="tactic">exists</span> (<span class="id" title="var">x</span> :: <span class="id" title="var">x0</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">Forall2T_cons</span> ; <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">eexists</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">Forall2T_app</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">R</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Type</span>) <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">l1'</span> <span class="id" title="var">l2'</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">Forall2T</span> <span class="id" title="var">R</span> <span class="id" title="var">l1</span> <span class="id" title="var">l1'</span> -&gt; <span class="id" title="var">Forall2T</span> <span class="id" title="var">R</span> <span class="id" title="var">l2</span> <span class="id" title="var">l2'</span> -&gt; <span class="id" title="var">Forall2T</span> <span class="id" title="var">R</span> (<span class="id" title="var">l1</span> ++ <span class="id" title="var">l2</span>) (<span class="id" title="var">l1'</span> ++ <span class="id" title="var">l2'</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> <span class="id" title="var">l1</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">l1</span>. <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Forall2T_cons</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">IHl1</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">cET</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">_</span> /\ <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">ex</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">False</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="var">contradiction</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">sig</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">sigT</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">False</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="var">contradiction</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">_</span> * <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">cET_nr</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">_</span> /\ <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">ex</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">False</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="var">contradiction</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">sig</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">sigT</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">False</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="var">contradiction</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">_</span> * <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">InT</span> <span class="id" title="var">A</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) : <span class="id" title="var">list</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">InT_eq'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> <span class="id" title="var">l</span>, <span class="id" title="var">b</span> = <span class="id" title="var">a</span> -&gt; @<span class="id" title="var">InT</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span> (<span class="id" title="var">b</span> :: <span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">InT_cons</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> <span class="id" title="var">l</span>, @<span class="id" title="var">InT</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> -&gt; @<span class="id" title="var">InT</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span> (<span class="id" title="var">b</span> :: <span class="id" title="var">l</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_eq</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span>, @<span class="id" title="var">InT</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span> (<span class="id" title="var">a</span> :: <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_eq'</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">InT_2nd</span> <span class="id" title="var">A</span> (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">A</span>) <span class="id" title="var">l</span> := <span class="id" title="var">InT_cons</span> <span class="id" title="var">a</span> (<span class="id" title="var">InT_eq</span> <span class="id" title="var">b</span> <span class="id" title="var">l</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_appL</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>, <span class="id" title="var">InT</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) <span class="id" title="var">X</span> -&gt; <span class="id" title="var">InT</span> <span class="id" title="var">a</span> (<span class="id" title="var">X</span> ++ <span class="id" title="var">Y</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">X0</span> ; <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">InT_eq</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_cons</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_appR</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>, <span class="id" title="var">InT</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">InT</span> <span class="id" title="var">a</span> (<span class="id" title="var">X</span> ++ <span class="id" title="var">Y</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> ; <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">InT_cons</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">solve_InT</span> := <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_eq</span> || <br/>
&nbsp;&nbsp;((<span class="id" title="tactic">apply</span> <span class="id" title="var">InT_cons</span> || (<span class="id" title="tactic">apply</span> <span class="id" title="var">InT_appL</span> + <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_appR</span>)) ; <span class="id" title="var">solve_InT</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_appE'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span> <span class="id" title="var">Z</span>, <span class="id" title="var">InT</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) <span class="id" title="var">Z</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>, <span class="id" title="var">Z</span> = <span class="id" title="var">X</span> ++ <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">InT</span> <span class="id" title="var">a</span> <span class="id" title="var">X</span> + <span class="id" title="var">InT</span> <span class="id" title="var">a</span> <span class="id" title="var">Y</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> ; <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span> ; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_eq</span>.<br/>
<span class="id" title="tactic">injection</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_eq</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">X0</span> ; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_cons</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">injection</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">pose</span> (@<span class="id" title="var">eq_refl</span> (<span class="id" title="var">list</span> <span class="id" title="var">A</span>)). <span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_cons</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_appE</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>, <span class="id" title="var">InT</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">X</span> ++ <span class="id" title="var">Y</span>) -&gt; <span class="id" title="var">InT</span> <span class="id" title="var">a</span> <span class="id" title="var">X</span> + <span class="id" title="var">InT</span> <span class="id" title="var">a</span> <span class="id" title="var">Y</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">InT_appE'</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_nilE'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span> <span class="id" title="var">Z</span> <span class="id" title="var">any</span>, <span class="id" title="var">InT</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) <span class="id" title="var">Z</span> -&gt; <span class="id" title="var">Z</span> = [] -&gt; <span class="id" title="var">any</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span> ; <span class="id" title="tactic">discriminate</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_nilE</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span> <span class="id" title="var">any</span>, <span class="id" title="var">InT</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) [] -&gt; <span class="id" title="var">any</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">InT_nilE'</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_split</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">InT</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">sigT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">l1</span> =&gt; <span class="id" title="var">sigT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">l2</span> =&gt; <span class="id" title="var">l</span> = <span class="id" title="var">l1</span> ++ <span class="id" title="var">x</span> :: <span class="id" title="var">l2</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="tactic">exists</span> []. <span class="id" title="tactic">exists</span> <span class="id" title="var">l</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHX</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">subst</span>.<br/>
<span class="id" title="tactic">exists</span> (<span class="id" title="var">b</span> :: <span class="id" title="var">x0</span>). <span class="id" title="tactic">exists</span> <span class="id" title="var">x1</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_inv</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">Y</span>, <span class="id" title="var">InT</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">b</span> :: <span class="id" title="var">Y</span>) -&gt; (<span class="id" title="var">b</span> = <span class="id" title="var">a</span>) + <span class="id" title="var">InT</span> <span class="id" title="var">a</span> <span class="id" title="var">Y</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X</span> ; <span class="id" title="tactic">subst</span> ; <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_map</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">InT</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">InT</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) (<span class="id" title="var">map</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_eq</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_cons</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_mapE</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">y</span> : <span class="id" title="var">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="var">map</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span>)) -&gt; (<span class="id" title="var">sigT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">prod</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) (<span class="id" title="var">InT</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span>))).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">InT_nilE</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>.<br/>
<span class="id" title="tactic">split</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_eq</span>.<br/>
<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X0</span>. <span class="id" title="var">cD</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">InT_cons</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X2</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_map_iffT</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">y</span> : <span class="id" title="var">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="var">map</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span>)) (<span class="id" title="var">sigT</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">prod</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) (<span class="id" title="var">InT</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span>))).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pair</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_mapE</span>.<br/>
<span class="id" title="tactic">intro</span>. <span class="id" title="var">cD</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_map</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X1</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">InT_mapI</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span> <span class="id" title="var">y</span> := <span class="id" title="var">iffT_D2</span> (@<span class="id" title="var">InT_map_iffT</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span> <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_concat</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">a</span> (<span class="id" title="var">xs</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) <span class="id" title="var">pss</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">InT</span> <span class="id" title="var">a</span> <span class="id" title="var">xs</span> -&gt; <span class="id" title="var">InT</span> <span class="id" title="var">xs</span> <span class="id" title="var">pss</span> -&gt; <span class="id" title="var">InT</span> <span class="id" title="var">a</span> (<span class="id" title="var">concat</span> <span class="id" title="var">pss</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_appL</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_appR</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Forall2T_ex_l</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">R</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Type</span>) <span class="id" title="var">xs</span> <span class="id" title="var">ys</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">Forall2T</span> <span class="id" title="var">R</span> <span class="id" title="var">xs</span> <span class="id" title="var">ys</span> -&gt; <span class="id" title="var">InT</span> <span class="id" title="var">x</span> <span class="id" title="var">xs</span> -&gt; <span class="id" title="var">sigT2</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">ys</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">R</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">InT_nilE</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>. <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span> ; <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_eq</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">InT_cons</span>. <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Forall2T_ex_r</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">R</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Type</span>) <span class="id" title="var">xs</span> <span class="id" title="var">ys</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">Forall2T</span> <span class="id" title="var">R</span> <span class="id" title="var">ys</span> <span class="id" title="var">xs</span> -&gt; <span class="id" title="var">InT</span> <span class="id" title="var">x</span> <span class="id" title="var">xs</span> -&gt; <span class="id" title="var">sigT2</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">ys</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">R</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="tactic">until</span> 0. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">InT_nilE</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X</span>. <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span> ; <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_eq</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">IHX</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X1</span>. <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">InT_cons</span>. <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ForallT_forall</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">iffT</span> (<span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> <span class="id" title="var">l</span>) (<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">A</span>, <span class="id" title="var">InT</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> ; <span class="id" title="tactic">unfold</span> <span class="id" title="var">iffT</span> ; <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">InT_nilE</span> <span class="id" title="tactic">in</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_nil</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">iffT</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">IHl</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">X0</span> ; <span class="id" title="tactic">subst</span> ; <span class="id" title="tactic">firstorder</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">iffT</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_cons</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">f</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_cons</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">X0</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ForallTD_forall</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span> := <span class="id" title="var">iffT_D1</span> (@<span class="id" title="var">ForallT_forall</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ForallTI_forall</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span> := <span class="id" title="var">iffT_D2</span> (@<span class="id" title="var">ForallT_forall</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_In</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span> <span class="id" title="var">Y</span>, <span class="id" title="var">InT</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">In</span> <span class="id" title="var">a</span> <span class="id" title="var">Y</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">in_eq</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">in_cons</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">In_InT</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span> <span class="id" title="var">Y</span>, <span class="id" title="var">In</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">ex</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> : <span class="id" title="var">InT</span> <span class="id" title="var">a</span> <span class="id" title="var">Y</span> =&gt; <span class="id" title="var">True</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">Y</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">in_nil</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="var">contradiction</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">in_inv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">exists</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_eq</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">I</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">IHY</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">exists</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_cons</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">I</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">anon</span> (<span class="id" title="var">p</span> : <span class="id" title="keyword">Type</span>) := <span class="id" title="var">ex</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> : <span class="id" title="var">p</span> =&gt; <span class="id" title="var">True</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">anonI</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">p</span>, <span class="id" title="var">p</span> -&gt; <span class="id" title="var">anon</span> <span class="id" title="var">p</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">anon</span>. <span class="id" title="tactic">exists</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">I</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_In'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span> <span class="id" title="var">Y</span>, <span class="id" title="var">ex</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> : <span class="id" title="var">InT</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) <span class="id" title="var">Y</span> =&gt; <span class="id" title="var">True</span>) -&gt; <span class="id" title="var">In</span> <span class="id" title="var">a</span> <span class="id" title="var">Y</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_In</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">anonD</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">p</span> (<span class="id" title="var">q</span> : <span class="id" title="keyword">Prop</span>), (<span class="id" title="var">p</span> -&gt; <span class="id" title="var">q</span>) -&gt; (<span class="id" title="var">anon</span> <span class="id" title="var">p</span> -&gt; <span class="id" title="var">q</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">anon</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">anon_eq</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">P</span> : <span class="id" title="keyword">Prop</span>, <span class="id" title="var">anon</span> <span class="id" title="var">P</span> &lt;-&gt; <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iff</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">anonD</span>. <span class="id" title="tactic">tauto</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">anonI</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_In_eq</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span> <span class="id" title="var">Y</span>, <span class="id" title="var">anon</span> (<span class="id" title="var">InT</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) <span class="id" title="var">Y</span>) &lt;-&gt; <span class="id" title="var">In</span> <span class="id" title="var">a</span> <span class="id" title="var">Y</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">anon</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iff</span>. <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">InT_In'</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">In_InT</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InT_In_eq'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span> <span class="id" title="var">Y</span>, <span class="id" title="var">anon</span> (<span class="id" title="var">InT</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) <span class="id" title="var">Y</span>) &lt;-&gt; <span class="id" title="var">In</span> <span class="id" title="var">a</span> <span class="id" title="var">Y</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iff</span>. <span class="id" title="tactic">split</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">anonD</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">InT_In</span>.<br/>
<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">anon</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">In_InT</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">anon_prod</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">u</span>, <span class="id" title="var">anon</span> (<span class="id" title="var">prod</span> <span class="id" title="var">t</span> <span class="id" title="var">u</span>) &lt;-&gt; <span class="id" title="var">anon</span> <span class="id" title="var">t</span> /\ <span class="id" title="var">anon</span> <span class="id" title="var">u</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iff</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">anon</span>. <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span> ; <br/>
&nbsp;&nbsp;<span class="id" title="var">cD</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">exists</span> ; <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">anon_sum</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">u</span>, <span class="id" title="var">anon</span> (<span class="id" title="var">sum</span> <span class="id" title="var">t</span> <span class="id" title="var">u</span>) &lt;-&gt; <span class="id" title="var">anon</span> <span class="id" title="var">t</span> \/ <span class="id" title="var">anon</span> <span class="id" title="var">u</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iff</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">anon</span>. <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span> ; <span class="id" title="var">sD</span> ;<br/>
&nbsp;&nbsp;[&gt; <span class="id" title="tactic">left</span> | <span class="id" title="tactic">right</span> | | ] ; <span class="id" title="tactic">exists</span> ; <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">anon_imp</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">u</span>, <span class="id" title="var">anon</span> (<span class="id" title="var">t</span> -&gt; <span class="id" title="var">u</span>) -&gt; (<span class="id" title="var">anon</span> <span class="id" title="var">t</span> -&gt; <span class="id" title="var">anon</span> <span class="id" title="var">u</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">anon</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">cD</span>. <span class="id" title="tactic">exists</span> ; <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">anon_iffT</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">t</span> <span class="id" title="var">u</span>, <span class="id" title="var">anon</span> (<span class="id" title="var">iffT</span> <span class="id" title="var">t</span> <span class="id" title="var">u</span>) -&gt; (<span class="id" title="var">anon</span> <span class="id" title="var">t</span> &lt;-&gt; <span class="id" title="var">anon</span> <span class="id" title="var">u</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iff</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iffT</span>. <span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">rewrite</span> -&gt; <span class="id" title="var">anon_prod</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span> ; <span class="id" title="tactic">eapply</span> <span class="id" title="var">anon_imp</span> ; <span class="id" title="var">eassumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">anon_sigT</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span>, <span class="id" title="var">anon</span> (@<span class="id" title="var">sigT</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span>) -&gt; @<span class="id" title="var">ex</span> <span class="id" title="var">A</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">anon</span> (<span class="id" title="var">P</span> <span class="id" title="var">x</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">anon</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">cD</span>. <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">eexists</span>. <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">I</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">anon_forall</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">T</span> <span class="id" title="var">P</span>, <br/>
&nbsp;&nbsp;<span class="id" title="var">anon</span> (<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">T</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span>) -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">T</span>, <span class="id" title="var">anon</span> (<span class="id" title="var">P</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">anon</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">exists</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">x0</span> <span class="id" title="var">x</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">I</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ForallT_Forall'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Prop</span>) (<span class="id" title="var">xs</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> <span class="id" title="var">xs</span> -&gt; <span class="id" title="var">Forall</span> <span class="id" title="var">P</span> <span class="id" title="var">xs</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Forall_nil</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Forall_cons</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ForallT_Forall</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> (<span class="id" title="var">xs</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> <span class="id" title="var">xs</span> -&gt; <span class="id" title="var">Forall</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">anon</span> (<span class="id" title="var">P</span> <span class="id" title="var">x</span>)) <span class="id" title="var">xs</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Forall_nil</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Forall_cons</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">anonI</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Forall_ForallT</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> (<span class="id" title="var">xs</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">Forall</span> <span class="id" title="var">P</span> <span class="id" title="var">xs</span> -&gt; <span class="id" title="var">anon</span> (<span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> <span class="id" title="var">xs</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">anonI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_nil</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">anon</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHForall</span>. <span class="id" title="var">cD</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">anonI</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_cons</span> ; <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Forall_ForallT'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> (<span class="id" title="var">xs</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>), <span class="id" title="var">Forall</span> <span class="id" title="var">P</span> <span class="id" title="var">xs</span> -&gt; <span class="id" title="var">ForallT</span> <span class="id" title="var">P</span> <span class="id" title="var">xs</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">xs</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_nil</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">ForallT_cons</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">IHxs</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inhabited_anon</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span>, <span class="id" title="var">inhabited</span> <span class="id" title="var">A</span> &lt;-&gt; <span class="id" title="var">anon</span> <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">iff</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">anon</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span> ; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">exists</span> ; <span class="id" title="tactic">tauto</span>.<br/>
&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">inhabits</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">want_left_prod_under_universal</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">T</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">T</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">Q1</span> : <span class="id" title="var">T</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">S</span> : <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> : <span class="id" title="var">T</span>, <span class="id" title="var">P</span> <span class="id" title="var">y</span> -&gt; ((<span class="id" title="var">Q1</span> <span class="id" title="var">y</span>) * <span class="id" title="var">S</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> : <span class="id" title="var">T</span>, <span class="id" title="var">P</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">Q1</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">firstorder</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">want_right_prod_under_universal</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">T</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">T</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">Q1</span> : <span class="id" title="var">T</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">S</span> : <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> : <span class="id" title="var">T</span>, <span class="id" title="var">P</span> <span class="id" title="var">y</span> -&gt; (<span class="id" title="var">S</span> * (<span class="id" title="var">Q1</span> <span class="id" title="var">y</span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> : <span class="id" title="var">T</span>, <span class="id" title="var">P</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">Q1</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">firstorder</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">want_right_prod_under_universal'</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">T</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">T</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">Q1</span> <span class="id" title="var">S</span> : <span class="id" title="var">T</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> : <span class="id" title="var">T</span>, <span class="id" title="var">P</span> <span class="id" title="var">y</span> -&gt; ((<span class="id" title="var">S</span> <span class="id" title="var">y</span>) * (<span class="id" title="var">Q1</span> <span class="id" title="var">y</span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> : <span class="id" title="var">T</span>, <span class="id" title="var">P</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">Q1</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">firstorder</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">want_prod_under_universal4</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">T</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">T</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">Q1</span> <span class="id" title="var">Q2</span> <span class="id" title="var">Q3</span> <span class="id" title="var">Q4</span> : <span class="id" title="var">T</span> -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> : <span class="id" title="var">T</span>, <span class="id" title="var">P</span> <span class="id" title="var">y</span> -&gt; ((<span class="id" title="var">Q1</span> <span class="id" title="var">y</span>) * (<span class="id" title="var">Q2</span> <span class="id" title="var">y</span>) * (<span class="id" title="var">Q3</span> <span class="id" title="var">y</span>) * (<span class="id" title="var">Q4</span> <span class="id" title="var">y</span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> : <span class="id" title="var">T</span>, <span class="id" title="var">P</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">Q1</span> <span class="id" title="var">y</span>) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> : <span class="id" title="var">T</span>, <span class="id" title="var">P</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">Q2</span> <span class="id" title="var">y</span>) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> : <span class="id" title="var">T</span>, <span class="id" title="var">P</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">Q3</span> <span class="id" title="var">y</span>) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> : <span class="id" title="var">T</span>, <span class="id" title="var">P</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">Q4</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">firstorder</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prod_nat_split</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">P</span> : (<span class="id" title="var">nat</span> * <span class="id" title="var">nat</span>) -&gt; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> : <span class="id" title="var">nat</span> * <span class="id" title="var">nat</span>, <span class="id" title="var">P</span> <span class="id" title="var">y</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">P</span> (<span class="id" title="var">n</span>,<span class="id" title="var">m</span>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">firstorder</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">empty</span> : <span class="id" title="keyword">Type</span> := .<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">empty_explosion</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>), <span class="id" title="var">empty</span> -&gt; <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;T~ A" := (<span class="id" title="var">A</span> -&gt; <span class="id" title="var">empty</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 60).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">False_empty</span> : <span class="id" title="var">False</span> -&gt; <span class="id" title="var">empty</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">empty_False</span> : <span class="id" title="var">empty</span> -&gt; <span class="id" title="var">False</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">leT</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">nat</span> -&gt; <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">leT_n</span> : <span class="id" title="var">leT</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span> | <span class="id" title="var">leT_S</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">leT</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">leT</span> <span class="id" title="var">n</span> (<span class="id" title="var">S</span> <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">leT_n_S</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>, <span class="id" title="var">leT</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">leT</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) (<span class="id" title="var">S</span> <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">leT_n</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">leT_S</span> <span class="id" title="var">IHleT</span>). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">leT_S_n'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">sn</span> <span class="id" title="var">sm</span>, <span class="id" title="var">leT</span> <span class="id" title="var">sn</span> <span class="id" title="var">sm</span> -&gt; <br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>, <span class="id" title="var">sn</span> = <span class="id" title="var">S</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">sm</span> = <span class="id" title="var">S</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">leT</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> * <span class="id" title="var">ss</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">ss</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">leT_n</span>.<br/>
- <span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>.<br/>
+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">ss</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>.<br/>
+ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHss</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">eq_refl</span> <span class="id" title="var">eq_refl</span>).<br/>
<span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">leT_S</span> <span class="id" title="var">IHss</span>). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">leT_S_n</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">l</span> := @<span class="id" title="var">leT_S_n'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">eq_refl</span> <span class="id" title="var">eq_refl</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">leT_trans'</span> <span class="id" title="var">l</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>: <span class="id" title="var">leT</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">leT</span> <span class="id" title="var">l</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">leT</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span> ; <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">leT_S</span> (<span class="id" title="var">IHleT</span> <span class="id" title="var">H0</span>)). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">leT_trans</span> <span class="id" title="var">l</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">llm</span> <span class="id" title="var">lmn</span> := @<span class="id" title="var">leT_trans'</span> <span class="id" title="var">l</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">lmn</span> <span class="id" title="var">llm</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">leT_0_n</span> <span class="id" title="var">n</span>: <span class="id" title="var">leT</span> 0 <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">leT_n</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">leT_S</span> <span class="id" title="var">IHn</span>). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">leT_plus_r</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">leT</span> <span class="id" title="var">m</span> (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> ; <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">leT_n</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">leT_S</span> <span class="id" title="var">IHn</span>). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">leT_plus_l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">leT</span> <span class="id" title="var">n</span> (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> ; <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">leT_0_n</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">leT_n_S</span> <span class="id" title="var">IHn</span>). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">eq_S_F</span> <span class="id" title="var">n</span> : <span class="id" title="var">S</span> <span class="id" title="var">n</span> = <span class="id" title="var">n</span> -&gt; <span class="id" title="var">False</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> ; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">leT_S_F</span> <span class="id" title="var">n</span> : <span class="id" title="var">leT</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">n</span> -&gt; <span class="id" title="var">False</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> ; <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">leT_S_n</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">tauto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">leT_S_or_eq</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">leT</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">leT</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">m</span> + (<span class="id" title="var">n</span> = <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">tauto</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">leT_n_S</span> <span class="id" title="var">H</span>). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">leT_or_gt</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">leT</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> + <span class="id" title="var">leT</span> (<span class="id" title="var">S</span> <span class="id" title="var">m</span>) <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">leT_0_n</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHn</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">leT_S_or_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">l</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">inl</span> <span class="id" title="var">l</span>).<br/>
<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">inr</span> (<span class="id" title="var">leT_n</span> <span class="id" title="var">_</span>)). <span class="id" title="tactic">exact</span> (<span class="id" title="var">inr</span> (<span class="id" title="var">leT_S</span> <span class="id" title="var">l</span>)). <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">leT_ex_plus</span> <span class="id" title="var">k</span> <span class="id" title="var">n</span> : <span class="id" title="var">leT</span> <span class="id" title="var">k</span> <span class="id" title="var">n</span> -&gt; { <span class="id" title="var">m</span> : <span class="id" title="var">nat</span> &amp; <span class="id" title="var">Nat.add</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span> = <span class="id" title="var">n</span> }.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">lkn</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">lkn</span>. <span class="id" title="tactic">exists</span> 0. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="var">cD</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">S</span> <span class="id" title="var">IHlkn</span>). <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>